Entering demest_assm.py
Setting tag: 10000_5_4q_mnl
Capacity: 10000
Max rank: 5
Number of HPI quantiles: 4
MNL: True
Flexible consideration: False
HPI level: zip
Distance bins: False
Only constant: False
No distance heterogeneity: False
Cap coefs to 0: False
np.random.seed: 1234
Coef save path: /mnt/phd/jihu/Demo/Result/Demand/coefs/10000_5_4q_mnl_coefs
Strict capacity: False
Dummy location: False
Total population: 380908
agent_data_full.shape: (13215, 16)
Start creating economy at time: 0.87 seconds
Done creating economy at time: 17.59 seconds
Entering fixed point loop...
Time: 17.59 seconds
Dampener: 0.5
df:
       X      Y  market_ids  firm_ids    shares  prices  RC  hpi_quantile  hpi_quantile1  hpi_quantile4  hpi_quantile2  hpi_quantile3
0  0.107  0.076       90059         1  0.633817       0   1             1              1              0              0              0
1  0.076  0.064       90201         1  0.711075       0   1             1              1              0              0              0
2  0.039  0.625       90277         1  0.850892       0   4             4              0              1              0              0
3  0.065  0.709       90290         1  0.824042       0   4             4              0              1              0              0
4  0.106  0.294       90302         1  0.672451       0   2             2              0              0              1              0
5  0.039  0.546       90503         1  0.870397       0   4             4              0              1              0              0
6  0.055  0.186       90605         1  0.767276       0   2             2              0              0              1              0
7  0.049  0.151       90606         1  0.737901       0   2             2              0              0              1              0
8  0.060  0.527       90703         1  0.883437       0   3             3              0              0              0              1
9  0.067  0.407       90732         1  0.694354       0   3             3              0              0              0              1
Number of agents: 2643

Iteration 0:

agent_loc_data:
      blkid  locid   logdist      dist  market_ids  hpi_quantile  hpi_quantile1  hpi_quantile2  hpi_quantile3  hpi_quantile4  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4  nodes  population   weights
0    132759      0  0.737546  2.090799     90059.0             1              1              0              0              0               0.737546                    0.0                    0.0                    0.0      0       40488  0.000395
5    132760      0  0.817771  2.265445     90059.0             1              1              0              0              0               0.817771                    0.0                    0.0                    0.0      0       40488  0.002099
10   132761      0  0.835924  2.306944     90059.0             1              1              0              0              0               0.835924                    0.0                    0.0                    0.0      0       40488  0.000198
15   132763      0  0.685177  1.984123     90059.0             1              1              0              0              0               0.685177                    0.0                    0.0                    0.0      0       40488  0.000296
20   132772      0  0.959576  2.610589     90059.0             1              1              0              0              0               0.959576                    0.0                    0.0                    0.0      0       40488  0.003334
25   132774      0  1.021268  2.776713     90059.0             1              1              0              0              0               1.021268                    0.0                    0.0                    0.0      0       40488  0.002495
30   132775      0  0.943832  2.569810     90059.0             1              1              0              0              0               0.943832                    0.0                    0.0                    0.0      0       40488  0.004470
35   132776      0  0.887535  2.429133     90059.0             1              1              0              0              0               0.887535                    0.0                    0.0                    0.0      0       40488  0.002766
40   132792      0  0.788905  2.200984     90059.0             1              1              0              0              0               0.788905                    0.0                    0.0                    0.0      0       40488  0.007731
45   132793      0  0.782841  2.187679     90059.0             1              1              0              0              0               0.782841                    0.0                    0.0                    0.0      0       40488  0.006422
50   132794      0  0.887200  2.428321     90059.0             1              1              0              0              0               0.887200                    0.0                    0.0                    0.0      0       40488  0.002322
55   132795      0  0.939920  2.559777     90059.0             1              1              0              0              0               0.939920                    0.0                    0.0                    0.0      0       40488  0.000617
60   132796      0  0.770565  2.160988     90059.0             1              1              0              0              0               0.770565                    0.0                    0.0                    0.0      0       40488  0.007385
65   132797      0  0.898773  2.456588     90059.0             1              1              0              0              0               0.898773                    0.0                    0.0                    0.0      0       40488  0.003902
70   132800      0  0.537663  1.712002     90059.0             1              1              0              0              0               0.537663                    0.0                    0.0                    0.0      0       40488  0.001309
75   132802      0  0.572333  1.772398     90059.0             1              1              0              0              0               0.572333                    0.0                    0.0                    0.0      0       40488  0.003087
80   132803      0  0.683665  1.981126     90059.0             1              1              0              0              0               0.683665                    0.0                    0.0                    0.0      0       40488  0.007558
85   132804      0  0.658754  1.932382     90059.0             1              1              0              0              0               0.658754                    0.0                    0.0                    0.0      0       40488  0.006496
90   132805      0  0.640444  1.897323     90059.0             1              1              0              0              0               0.640444                    0.0                    0.0                    0.0      0       40488  0.008175
95   132806      0  0.624369  1.867068     90059.0             1              1              0              0              0               0.624369                    0.0                    0.0                    0.0      0       40488  0.005854
100  132808      0  0.861170  2.365927     90059.0             1              1              0              0              0               0.861170                    0.0                    0.0                    0.0      0       40488  0.002248
105  132809      0  0.802728  2.231621     90059.0             1              1              0              0              0               0.802728                    0.0                    0.0                    0.0      0       40488  0.002420
110  132810      0  0.846201  2.330775     90059.0             1              1              0              0              0               0.846201                    0.0                    0.0                    0.0      0       40488  0.004001
115  132811      0  0.892600  2.441470     90059.0             1              1              0              0              0               0.892600                    0.0                    0.0                    0.0      0       40488  0.004322
120  132812      0  0.830826  2.295213     90059.0             1              1              0              0              0               0.830826                    0.0                    0.0                    0.0      0       40488  0.004495
125  132813      0  0.778839  2.178942     90059.0             1              1              0              0              0               0.778839                    0.0                    0.0                    0.0      0       40488  0.000840
130  132815      0  0.945684  2.574574     90059.0             1              1              0              0              0               0.945684                    0.0                    0.0                    0.0      0       40488  0.002470
135  132831      0  0.979955  2.664335     90059.0             1              1              0              0              0               0.979955                    0.0                    0.0                    0.0      0       40488  0.003483
140  132832      0  0.992628  2.698315     90059.0             1              1              0              0              0               0.992628                    0.0                    0.0                    0.0      0       40488  0.001926
145  132833      0  0.931708  2.538841     90059.0             1              1              0              0              0               0.931708                    0.0                    0.0                    0.0      0       40488  0.001951
150  132835      0  0.902977  2.466937     90059.0             1              1              0              0              0               0.902977                    0.0                    0.0                    0.0      0       40488  0.004372
155  132836      0  0.966086  2.627640     90059.0             1              1              0              0              0               0.966086                    0.0                    0.0                    0.0      0       40488  0.002766
160  132839      0  0.952506  2.592198     90059.0             1              1              0              0              0               0.952506                    0.0                    0.0                    0.0      0       40488  0.002519
165  132864      0  0.475158  1.608268     90059.0             1              1              0              0              0               0.475158                    0.0                    0.0                    0.0      0       40488  0.000445
170  132865      0  0.533492  1.704876     90059.0             1              1              0              0              0               0.533492                    0.0                    0.0                    0.0      0       40488  0.003087
175  132866      0  0.608395  1.837481     90059.0             1              1              0              0              0               0.608395                    0.0                    0.0                    0.0      0       40488  0.001531
180  132868      0  0.636466  1.889790     90059.0             1              1              0              0              0               0.636466                    0.0                    0.0                    0.0      0       40488  0.003655
185  132869      0  0.760304  2.138927     90059.0             1              1              0              0              0               0.760304                    0.0                    0.0                    0.0      0       40488  0.004026
190  132870      0  0.890776  2.437020     90059.0             1              1              0              0              0               0.890776                    0.0                    0.0                    0.0      0       40488  0.005088
195  132871      0  0.884013  2.420593     90059.0             1              1              0              0              0               0.884013                    0.0                    0.0                    0.0      0       40488  0.004989
200  132872      0  0.751706  2.120615     90059.0             1              1              0              0              0               0.751706                    0.0                    0.0                    0.0      0       40488  0.004051
205  132873      0  0.745560  2.107622     90059.0             1              1              0              0              0               0.745560                    0.0                    0.0                    0.0      0       40488  0.002025
210  132874      0  0.734289  2.083999     90059.0             1              1              0              0              0               0.734289                    0.0                    0.0                    0.0      0       40488  0.003754
215  132875      0  0.616423  1.852291     90059.0             1              1              0              0              0               0.616423                    0.0                    0.0                    0.0      0       40488  0.001877
220  132876      0  0.425751  1.530740     90059.0             1              1              0              0              0               0.425751                    0.0                    0.0                    0.0      0       40488  0.000099
225  132881      0  0.879359  2.409355     90059.0             1              1              0              0              0               0.879359                    0.0                    0.0                    0.0      0       40488  0.004421
230  132887      0  0.874058  2.396617     90059.0             1              1              0              0              0               0.874058                    0.0                    0.0                    0.0      0       40488  0.002766
235  132888      0  0.872058  2.391829     90059.0             1              1              0              0              0               0.872058                    0.0                    0.0                    0.0      0       40488  0.003236
240  132890      0  0.408319  1.504287     90059.0             1              1              0              0              0               0.408319                    0.0                    0.0                    0.0      0       40488  0.001210
245  132891      0  0.549847  1.732988     90059.0             1              1              0              0              0               0.549847                    0.0                    0.0                    0.0      0       40488  0.002420
pi_init:
None
Weight distribution by market:
count    10.0
mean      1.0
std       0.0
min       1.0
25%       1.0
50%       1.0
75%       1.0
max       1.0
Name: weights, dtype: float64
Estimating demand...
agent_vars: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
iv_df:
             demand_instruments0  demand_instruments1  demand_instruments2  demand_instruments3
market_ids                                                                                    
90059.0                0.231013             0.000000                  0.0             0.000000
90201.0                0.408205             0.000000                  0.0             0.000000
90277.0                0.000000             0.000000                  0.0             1.118289
90290.0                0.000000             0.000000                  0.0             2.826694
90302.0                0.000000             1.397525                  0.0             0.000000
Initializing the problem ...
Initialized the problem after 00:00:00.

Dimensions:
==========================================
 T    N    F    I     K1    K2    D    MD 
---  ---  ---  ----  ----  ----  ---  ----
10   10    1   2643   7     1     4    10 
==========================================

Formulations:
==================================================================================================================================================
       Column Indices:                   0                      1                      2                      3                  4         5    6 
-----------------------------  ---------------------  ---------------------  ---------------------  ---------------------  -------------  ---  ---
 X1: Linear Characteristics              1                   prices              hpi_quantile1          hpi_quantile2      hpi_quantile3   X    Y 
X2: Nonlinear Characteristics            1                                                                                                        
       d: Demographics         logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4                         
==================================================================================================================================================
pi_init: [[-0.001 -0.001 -0.001 -0.001]]
pi_lb: [[-inf -inf -inf -inf]]
pi_ub: [[inf inf inf inf]]
Solving with one core...
Solving the problem ...

Nonlinear Coefficient Initial Values:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         -1.00E-03              -1.00E-03              -1.00E-03              -1.00E-03      
=====================================================================================================================

Nonlinear Coefficient Lower Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           -INF                   -INF                   -INF                   -INF         
=====================================================================================================================

Nonlinear Coefficient Upper Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           +INF                   +INF                   +INF                   +INF         
=====================================================================================================================

The model may be under-identified. The total number of unfixed parameters is 11, which is more than the total number of moments, 10. Consider checking whether instruments were properly specified when initializing the problem, and whether parameters were properly configured when solving the problem.
Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 1     00:00:00         0             1           90           90          0     +3.76E-01               +1.15E+00  -1.00E-03, -1.00E-03, -1.00E-03, -1.00E-03
 1     00:00:00         1             2           117          117         0     +9.98E-01               +2.35E+00  -3.07E-02, +1.24E-01, +1.20E-01, -9.85E-01
 1     00:00:00         2             3           110          110         0     +1.88E-01   +1.88E-01   +7.10E-02  -1.08E-02, +4.00E-02, +3.90E-02, -3.25E-01
 1     00:00:00         3             4           108          108         0     +1.86E-01   +2.71E-03   +7.07E-02  -2.04E-02, +2.32E-02, +5.79E-02, -3.19E-01
 1     00:00:00         4             5           116          116         0     +1.68E-01   +1.81E-02   +1.11E-01  -1.29E-01, -1.48E-01, +2.78E-01, -3.05E-01
 1     00:00:00         5             6           122          122         0     +1.61E-01   +6.56E-03   +7.41E-02  -2.02E-01, -2.41E-01, +4.25E-01, -3.24E-01
 1     00:00:00         6             7           123          123         0     +1.59E-01   +1.78E-03   +4.06E-02  -2.06E-01, -2.28E-01, +4.35E-01, -3.42E-01
 1     00:00:00         7             8           123          123         0     +1.56E-01   +3.17E-03   +5.29E-02  -2.66E-01, -2.65E-01, +5.57E-01, -3.59E-01
 1     00:00:00         8             9           124          124         0     +1.54E-01   +2.12E-03   +7.67E-02  -2.78E-01, -2.33E-01, +5.81E-01, -3.60E-01
 1     00:00:00         9            10           119          119         0     +1.45E-01   +8.67E-03   +1.09E-01  -3.46E-01, -2.54E-02, +7.19E-01, -3.31E-01
 1     00:00:00         10           11           118          118         0     +1.44E-01   +1.59E-03   +4.62E-02  -3.49E-01, -2.95E-02, +7.23E-01, -3.14E-01
 1     00:00:00         11           12           121          121         0     +1.31E-01   +1.23E-02   +2.30E-02  -5.94E-01, +2.49E-02, +1.21E+00, -2.76E-01
 1     00:00:00         12           13           124          124         0     +1.29E-01   +2.24E-03   +1.95E-02  -7.28E-01, +2.42E-02, +1.47E+00, -2.77E-01
 1     00:00:00         13           14           125          125         0     +1.29E-01   +8.63E-05   +1.06E-02  -7.30E-01, +2.44E-02, +1.47E+00, -2.82E-01
 1     00:00:00         14           15           121          121         0     +1.29E-01   +9.28E-05   +9.67E-03  -7.45E-01, +9.21E-03, +1.48E+00, -2.87E-01
 1     00:00:00         15           16           121          121         0     +1.29E-01   +6.26E-05   +9.57E-03  -7.51E-01, +1.14E-02, +1.48E+00, -2.87E-01
 1     00:00:00         16           17           126          126         0     +1.28E-01   +9.19E-04   +3.86E-02  -8.80E-01, +5.05E-02, +1.45E+00, -2.89E-01
 1     00:00:00         17           18           126          126         0     +1.28E-01   +1.67E-04   +2.05E-02  -8.81E-01, +4.90E-02, +1.45E+00, -2.84E-01
 1     00:00:00         18           19           125          125         0     +1.27E-01   +9.00E-04   +2.18E-03  -1.06E+00, +6.64E-02, +1.41E+00, -2.75E-01
 1     00:00:00         19           20           126          126         0     +1.27E-01   +7.69E-05   +5.30E-04  -1.13E+00, +6.83E-02, +1.39E+00, -2.75E-01
 1     00:00:00         20           21           127          127         0     +1.27E-01   +4.01E-08   +4.82E-05  -1.13E+00, +6.83E-02, +1.39E+00, -2.75E-01
 1     00:00:00         21           22           127          127         0     +1.27E-01   +5.62E-08   +1.66E-06  -1.13E+00, +6.79E-02, +1.39E+00, -2.75E-01
 1     00:00:00         22           23           127          127         0     +1.27E-01   +4.71E-11   +2.00E-07  -1.13E+00, +6.79E-02, +1.39E+00, -2.75E-01
 1     00:00:00         23           24           127          127         0     +1.27E-01   +5.67E-13   +2.74E-09  -1.13E+00, +6.79E-02, +1.39E+00, -2.75E-01
 1     00:00:00         24           25           127          127         0     +1.27E-01   +2.11E-15   +3.88E-11  -1.13E+00, +6.79E-02, +1.39E+00, -2.75E-01

Optimization completed after 00:00:01.
Computing the Hessian and and updating the weighting matrix ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +6.62E+21. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
=====================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number
----  ---------  ---------  --------------  --------------  -------  ----------------
 1    +1.27E-01  +3.88E-11    +2.67E-02       +3.60E+00        0        +8.06E+04    
=====================================================================================

Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 2     00:00:00         0             1           48           48          0     +7.18E-01               +1.60E+01  -1.13E+00, +6.79E-02, +1.39E+00, -2.75E-01
 2     00:00:00         1             2           111          111         0     +8.54E+01               +1.88E+02  -1.28E+00, -8.77E-01, +1.39E+00, -5.70E-01
 2     00:00:00         2             3           93           93          0     +5.63E-02   +6.62E-01   +3.99E+00  -1.15E+00, -2.46E-02, +1.39E+00, -3.42E-01
 2     00:00:00         3             4           93           93          0     +5.42E-03   +5.09E-02   +1.06E+00  -1.14E+00, +1.03E-03, +1.39E+00, -3.20E-01
 2     00:00:00         4             5           94           94          0     +5.00E-06   +5.42E-03   +5.26E-02  -1.14E+00, -4.70E-03, +1.39E+00, -3.26E-01
 2     00:00:00         5             6           93           93          0     +6.52E-07   +4.34E-06   +1.99E-02  -1.14E+00, -4.81E-03, +1.39E+00, -3.26E-01
 2     00:00:00         6             7           94           94          0     +4.19E-08   +6.10E-07   +3.38E-03  -1.14E+00, -4.76E-03, +1.39E+00, -3.26E-01
 2     00:00:00         7             8           93           93          0     +3.67E-15   +4.19E-08   +1.56E-06  -1.14E+00, -4.75E-03, +1.39E+00, -3.26E-01
 2     00:00:00         8             9           93           93          0     +7.20E-16   +2.95E-15   +1.48E-06  -1.14E+00, -4.75E-03, +1.39E+00, -3.26E-01
 2     00:00:00         9            10           93           93          0     +1.17E-14               +2.91E-06  -1.14E+00, -4.75E-03, +1.39E+00, -3.26E-01
 2     00:00:00         10           11           94           94          0     +8.20E-14               +6.58E-06  -1.14E+00, -4.75E-03, +1.39E+00, -3.26E-01
 2     00:00:00         11           12           93           93          0     +3.45E-13               +1.32E-05  -1.14E+00, -4.75E-03, +1.39E+00, -3.26E-01
 2     00:00:00         12           13           95           95          0     +1.30E-12               +2.53E-05  -1.14E+00, -4.75E-03, +1.39E+00, -3.26E-01
 2     00:00:00         13           14           97           97          0     +6.23E-12               +5.51E-05  -1.14E+00, -4.75E-03, +1.39E+00, -3.26E-01
 2     00:00:00         14           15           97           97          0     +2.42E-13               +6.05E-06  -1.14E+00, -4.75E-03, +1.39E+00, -3.26E-01
 2     00:00:00         15           16           95           95          0     +6.36E-14               +3.00E-06  -1.14E+00, -4.75E-03, +1.39E+00, -3.26E-01
 2     00:00:00         16           17           95           95          0     +1.78E-14               +1.76E-06  -1.14E+00, -4.75E-03, +1.39E+00, -3.26E-01
 2     00:00:00         17           18           94           94          0     +5.63E-15               +1.62E-06  -1.14E+00, -4.75E-03, +1.39E+00, -3.26E-01
 2     00:00:00         18           19           93           93          0     +2.27E-15               +1.55E-06  -1.14E+00, -4.75E-03, +1.39E+00, -3.26E-01
 2     00:00:00         19           20           93           93          0     +1.27E-15               +1.52E-06  -1.14E+00, -4.75E-03, +1.39E+00, -3.26E-01
 2     00:00:00         20           21           94           94          0     +9.39E-16               +1.50E-06  -1.14E+00, -4.75E-03, +1.39E+00, -3.26E-01
 2     00:00:00         21           22           93           93          0     +8.16E-16               +1.49E-06  -1.14E+00, -4.75E-03, +1.39E+00, -3.26E-01
 2     00:00:00         22           23           94           94          0     +7.64E-16               +1.48E-06  -1.14E+00, -4.75E-03, +1.39E+00, -3.26E-01
 2     00:00:00         23           24           93           93          0     +7.42E-16               +1.49E-06  -1.14E+00, -4.75E-03, +1.39E+00, -3.26E-01

Optimization completed after 00:00:00.
Computing the Hessian and estimating standard errors ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +1.02E+19. To disable singularity checks, set options.singular_tol = numpy.inf.
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +8.65E+18. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
========================================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix  Covariance Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number  Condition Number 
----  ---------  ---------  --------------  --------------  -------  ----------------  -----------------
 2    +7.20E-16  +1.48E-06    -2.25E-01       +4.42E+02        0        +3.51E+24          +1.89E+20    
========================================================================================================

Cumulative Statistics:
===========================================================================
Computation  Optimizer  Optimization   Objective   Fixed Point  Contraction
   Time      Converged   Iterations   Evaluations  Iterations   Evaluations
-----------  ---------  ------------  -----------  -----------  -----------
 00:00:02       Yes          49           51          5465         5465    
===========================================================================

Nonlinear Coefficient Estimates (Robust SEs in Parentheses):
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         -1.14E+00              -4.75E-03              +1.39E+00              -3.26E-01      
                   |            (+3.42E-01)            (+3.52E-02)            (+1.21E-01)            (+9.51E-02)     
=====================================================================================================================

Beta Estimates (Robust SEs in Parentheses):
===============================================================================================
     1         prices     hpi_quantile1  hpi_quantile2  hpi_quantile3       X            Y     
-----------  -----------  -------------  -------------  -------------  -----------  -----------
 -1.20E+00    -6.25E-11     +3.99E+00      +2.30E+00      -3.87E-01     -2.33E+01    +7.20E+00 
(+2.58E-01)  (+1.43E-15)   (+2.89E-01)    (+2.59E-01)    (+1.68E-01)   (+1.92E-01)  (+1.12E-02)
===============================================================================================
Table variables: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4', '1', 'hpi_quantile1', 'hpi_quantile2', 'hpi_quantile3', 'X', 'Y']
Saved table at: /mnt/phd/jihu/Demo/Result/Demand/coeftables/coeftable_10000_5_4q_mnl_iter0.tex
Computing delta ...
Finished after 00:00:00.

Mean delta: 1.2508516530680038
pi labels: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
ii=0, vv=logdistXhpi_quantile1
logdistXhpi_quantile1 is a distance term, omitting from ABD and adding to coefficients instead
ii=1, vv=logdistXhpi_quantile2
logdistXhpi_quantile2 is a distance term, omitting from ABD and adding to coefficients instead
ii=2, vv=logdistXhpi_quantile3
logdistXhpi_quantile3 is a distance term, omitting from ABD and adding to coefficients instead
ii=3, vv=logdistXhpi_quantile4
logdistXhpi_quantile4 is a distance term, omitting from ABD and adding to coefficients instead

Distance coefficients: [-1.14268, -0.00475, 1.39369, -0.32596]

Saved (agent_)results to /mnt/phd/jihu/Demo/Result/Demand/(agent_)results_10000_5_4q_mnl_iter0.pkl
Computed abepsilon in: 0.011 seconds.
Assigning individuals...
time3 - time2: 0.339
time4 - time3: 2.163
Number of full locations: 15  out of  18
Offers:
% Rank 0 offers: 45.99142
% Rank 1 offers: 8.23532
% Rank 2 offers: 3.00020
% Rank 3 offers: 1.48829
% Rank 4 offers: 41.28477
% Offered any: 100.0
Mean offer distance: 1.62710
Quantiles of offered distances:
0.0 quantile: -2.65569
0.1 quantile: 0.43038
0.2 quantile: 0.82191
0.3 quantile: 1.12713
0.4 quantile: 1.40445
0.5 quantile: 1.82880
0.6 quantile: 2.12756
0.7 quantile: 2.23199
0.8 quantile: 2.36308
0.9 quantile: 2.60348
1.0 quantile: 3.19221
Assignments:
% Rank 0 assignments: 35.27125
% Rank 1 assignments: 5.27398
% Rank 2 assignments: 1.90413
% Rank 3 assignments: 0.92516
% Rank 4 assignments: 23.39909
% Assigned: 66.77360
Mean assignment distance: 1.56744
Quantiles of assignment distances:
0.0 quantile: -2.65569
0.1 quantile: 0.36730
0.2 quantile: 0.73612
0.3 quantile: 1.03509
0.4 quantile: 1.27172
0.5 quantile: 1.53924
0.6 quantile: 2.07074
0.7 quantile: 2.24994
0.8 quantile: 2.46322
0.9 quantile: 2.65756
1.0 quantile: 3.19221
Violations:
Max violation: 22484
Number of locations with violations: 15
Number of individuals with violations: 152539
Mean violation (conditional on violation): 10169.266666666666
Median violation (conditional on violation): 8525.0
Number of markets with wasserstein distance > 0.001: 10
Mean wasserstein distance for markets with wasserstein distance > 0.001: 1.0601384750377545
Mean wasserstein distance: 1.0601384750377545
Max wasserstein distance: 1.6814336362634978
Index of max wasserstein distance: 0
Iteration 0 complete.


Number of agents: 11344

Iteration 1:

agent_loc_data:
     blkid  locid   logdist       dist  market_ids  hpi_quantile  hpi_quantile1  hpi_quantile2  hpi_quantile3  hpi_quantile4  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4  nodes  population   weights
0   132759      0  0.737546   2.090799     90059.0             1              1              0              0              0               0.737546                    0.0                    0.0                    0.0      0       40488  0.000099
1   132759      4  1.309970   3.706062     90059.0             1              1              0              0              0               1.309970                    0.0                    0.0                    0.0      0       40488  0.000049
2   132759      7  1.941876   6.971814     90059.0             1              1              0              0              0               1.941876                    0.0                    0.0                    0.0      0       40488  0.000025
4   132759     16  2.388723  10.899569     90059.0             1              1              0              0              0               2.388723                    0.0                    0.0                    0.0      0       40488  0.000222
5   132760      0  0.817771   2.265445     90059.0             1              1              0              0              0               0.817771                    0.0                    0.0                    0.0      0       40488  0.000864
6   132760      4  1.368392   3.929026     90059.0             1              1              0              0              0               1.368392                    0.0                    0.0                    0.0      0       40488  0.000123
7   132760      7  1.909226   6.747865     90059.0             1              1              0              0              0               1.909226                    0.0                    0.0                    0.0      0       40488  0.000049
8   132760      1  2.210262   9.118109     90059.0             1              1              0              0              0               2.210262                    0.0                    0.0                    0.0      0       40488  0.000025
9   132760     16  2.407625  11.107545     90059.0             1              1              0              0              0               2.407625                    0.0                    0.0                    0.0      0       40488  0.001037
10  132761      0  0.835924   2.306944     90059.0             1              1              0              0              0               0.835924                    0.0                    0.0                    0.0      0       40488  0.000025
12  132761      7  1.897257   6.667582     90059.0             1              1              0              0              0               1.897257                    0.0                    0.0                    0.0      0       40488  0.000025
13  132761      1  2.221436   9.220563     90059.0             1              1              0              0              0               2.221436                    0.0                    0.0                    0.0      0       40488  0.000025
14  132761      9  2.405422  11.083104     90059.0             1              1              0              0              0               2.405422                    0.0                    0.0                    0.0      0       40488  0.000123
15  132763      0  0.685177   1.984123     90059.0             1              1              0              0              0               0.685177                    0.0                    0.0                    0.0      0       40488  0.000148
18  132763      1  2.192389   8.956590     90059.0             1              1              0              0              0               2.192389                    0.0                    0.0                    0.0      0       40488  0.000025
19  132763     16  2.382397  10.830829     90059.0             1              1              0              0              0               2.382397                    0.0                    0.0                    0.0      0       40488  0.000123
20  132772      0  0.959576   2.610589     90059.0             1              1              0              0              0               0.959576                    0.0                    0.0                    0.0      0       40488  0.001284
21  132772      4  1.464425   4.325055     90059.0             1              1              0              0              0               1.464425                    0.0                    0.0                    0.0      0       40488  0.000272
22  132772      7  1.847489   6.343871     90059.0             1              1              0              0              0               1.847489                    0.0                    0.0                    0.0      0       40488  0.000123
23  132772      1  2.250480   9.492289     90059.0             1              1              0              0              0               2.250480                    0.0                    0.0                    0.0      0       40488  0.000049
24  132772      9  2.387146  10.882389     90059.0             1              1              0              0              0               2.387146                    0.0                    0.0                    0.0      0       40488  0.001605
25  132774      0  1.021268   2.776713     90059.0             1              1              0              0              0               1.021268                    0.0                    0.0                    0.0      0       40488  0.000741
26  132774      4  1.507882   4.517154     90059.0             1              1              0              0              0               1.507882                    0.0                    0.0                    0.0      0       40488  0.000123
27  132774      7  1.816779   6.152013     90059.0             1              1              0              0              0               1.816779                    0.0                    0.0                    0.0      0       40488  0.000099
28  132774      1  2.269645   9.675964     90059.0             1              1              0              0              0               2.269645                    0.0                    0.0                    0.0      0       40488  0.000049
29  132774      9  2.373282  10.732561     90059.0             1              1              0              0              0               2.373282                    0.0                    0.0                    0.0      0       40488  0.001482
30  132775      0  0.943832   2.569810     90059.0             1              1              0              0              0               0.943832                    0.0                    0.0                    0.0      0       40488  0.001902
31  132775      4  1.464439   4.325118     90059.0             1              1              0              0              0               1.464439                    0.0                    0.0                    0.0      0       40488  0.000420
32  132775      7  1.850678   6.364134     90059.0             1              1              0              0              0               1.850678                    0.0                    0.0                    0.0      0       40488  0.000025
33  132775      1  2.251602   9.502947     90059.0             1              1              0              0              0               2.251602                    0.0                    0.0                    0.0      0       40488  0.000074
34  132775      9  2.384357  10.852086     90059.0             1              1              0              0              0               2.384357                    0.0                    0.0                    0.0      0       40488  0.002050
35  132776      0  0.887535   2.429133     90059.0             1              1              0              0              0               0.887535                    0.0                    0.0                    0.0      0       40488  0.000988
36  132776      4  1.415862   4.120036     90059.0             1              1              0              0              0               1.415862                    0.0                    0.0                    0.0      0       40488  0.000074
37  132776      7  1.879925   6.553017     90059.0             1              1              0              0              0               1.879925                    0.0                    0.0                    0.0      0       40488  0.000099
38  132776      1  2.229868   9.298637     90059.0             1              1              0              0              0               2.229868                    0.0                    0.0                    0.0      0       40488  0.000025
39  132776      9  2.401359  11.038164     90059.0             1              1              0              0              0               2.401359                    0.0                    0.0                    0.0      0       40488  0.001581
40  132792      0  0.788905   2.200984     90059.0             1              1              0              0              0               0.788905                    0.0                    0.0                    0.0      0       40488  0.003013
41  132792      4  1.462907   4.318494     90059.0             1              1              0              0              0               1.462907                    0.0                    0.0                    0.0      0       40488  0.000519
42  132792      7  1.889494   6.616020     90059.0             1              1              0              0              0               1.889494                    0.0                    0.0                    0.0      0       40488  0.000296
43  132792      1  2.258765   9.571262     90059.0             1              1              0              0              0               2.258765                    0.0                    0.0                    0.0      0       40488  0.000025
44  132792      9  2.363775  10.631010     90059.0             1              1              0              0              0               2.363775                    0.0                    0.0                    0.0      0       40488  0.003878
45  132793      0  0.782841   2.187679     90059.0             1              1              0              0              0               0.782841                    0.0                    0.0                    0.0      0       40488  0.002470
46  132793      4  1.473780   4.365707     90059.0             1              1              0              0              0               1.473780                    0.0                    0.0                    0.0      0       40488  0.000370
47  132793      7  1.890205   6.620723     90059.0             1              1              0              0              0               1.890205                    0.0                    0.0                    0.0      0       40488  0.000198
48  132793      1  2.264449   9.625818     90059.0             1              1              0              0              0               2.264449                    0.0                    0.0                    0.0      0       40488  0.000074
49  132793      9  2.357149  10.560804     90059.0             1              1              0              0              0               2.357149                    0.0                    0.0                    0.0      0       40488  0.003310
50  132794      0  0.887200   2.428321     90059.0             1              1              0              0              0               0.887200                    0.0                    0.0                    0.0      0       40488  0.000963
51  132794      4  1.526687   4.602902     90059.0             1              1              0              0              0               1.526687                    0.0                    0.0                    0.0      0       40488  0.000148
52  132794      7  1.852737   6.377253     90059.0             1              1              0              0              0               1.852737                    0.0                    0.0                    0.0      0       40488  0.000099
53  132794      1  2.287930   9.854524     90059.0             1              1              0              0              0               2.287930                    0.0                    0.0                    0.0      0       40488  0.000049
pi_init:
[[-1.14268336 -0.00474984  1.39369014 -0.32596289]]
Weight distribution by market:
count    10.0
mean      1.0
std       0.0
min       1.0
25%       1.0
50%       1.0
75%       1.0
max       1.0
Name: weights, dtype: float64
Estimating demand...
agent_vars: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
iv_df:
             demand_instruments0  demand_instruments1  demand_instruments2  demand_instruments3
market_ids                                                                                    
90059.0                1.426866              0.00000                  0.0             0.000000
90201.0                1.543861              0.00000                  0.0             0.000000
90277.0                0.000000              0.00000                  0.0             1.892472
90290.0                0.000000              0.00000                  0.0             2.836573
90302.0                0.000000              1.65527                  0.0             0.000000
Initializing the problem ...
Initialized the problem after 00:00:00.

Dimensions:
===========================================
 T    N    F     I     K1    K2    D    MD 
---  ---  ---  -----  ----  ----  ---  ----
10   10    1   11344   7     1     4    10 
===========================================

Formulations:
==================================================================================================================================================
       Column Indices:                   0                      1                      2                      3                  4         5    6 
-----------------------------  ---------------------  ---------------------  ---------------------  ---------------------  -------------  ---  ---
 X1: Linear Characteristics              1                   prices              hpi_quantile1          hpi_quantile2      hpi_quantile3   X    Y 
X2: Nonlinear Characteristics            1                                                                                                        
       d: Demographics         logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4                         
==================================================================================================================================================
pi_init: [[-1.14268336 -0.00474984  1.39369014 -0.32596289]]
pi_lb: [[-inf -inf -inf -inf]]
pi_ub: [[inf inf inf inf]]
Solving with one core...
Solving the problem ...

Nonlinear Coefficient Initial Values:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         -1.14E+00              -4.75E-03              +1.39E+00              -3.26E-01      
=====================================================================================================================

Nonlinear Coefficient Lower Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           -INF                   -INF                   -INF                   -INF         
=====================================================================================================================

Nonlinear Coefficient Upper Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           +INF                   +INF                   +INF                   +INF         
=====================================================================================================================

The model may be under-identified. The total number of unfixed parameters is 11, which is more than the total number of moments, 10. Consider checking whether instruments were properly specified when initializing the problem, and whether parameters were properly configured when solving the problem.
Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 1     00:00:00         0             1           131          131         0     +5.90E-01               +4.87E-01  -1.14E+00, -4.75E-03, +1.39E+00, -3.26E-01
 1     00:00:00         1             2           134          134         0     +3.98E-01   +1.92E-01   +2.27E-01  -1.15E+00, +4.32E-03, +1.10E+00, -8.13E-01
 1     00:00:00         2             3           133          133         0     +3.15E-01   +8.32E-02   +1.84E-01  -1.17E+00, -8.30E-03, +6.96E-01, -9.54E-01
 1     00:00:00         3             4           134          134         0     +1.98E-01   +1.17E-01   +2.23E-01  -1.20E+00, -5.80E-02, -4.96E-01, -1.10E+00
 1     00:00:00         4             5           133          133         0     +1.65E-01   +3.29E-02   +1.97E-01  -1.20E+00, -6.50E-02, -5.19E-01, -9.51E-01
 1     00:00:00         5             6           149          149         0     +1.53E+00               +2.79E+00  -1.25E+00, -1.97E-01, -2.28E+00, +1.31E+00
 1     00:00:00         6             7           136          136         0     +1.06E-01   +5.86E-02   +2.38E-01  -1.21E+00, -8.94E-02, -1.21E+00, -6.65E-01
 1     00:00:00         7             8           135          135         0     +7.81E-02   +2.83E-02   +1.74E-01  -1.21E+00, -8.82E-02, -1.17E+00, -5.39E-01
 1     00:00:00         8             9           129          129         0     +8.21E-02               +2.73E-01  -1.22E+00, -1.02E-01, -1.59E+00, +1.11E-01
 1     00:00:00         9            10           131          131         0     +5.68E-02   +2.12E-02   +5.96E-02  -1.21E+00, -8.26E-02, -1.14E+00, -3.63E-01
 1     00:00:00         10           11           130          130         0     +4.84E-02   +8.44E-03   +2.21E-02  -1.21E+00, -7.87E-02, -1.37E+00, -2.26E-01
 1     00:00:00         11           12           130          130         0     +4.78E-02   +5.88E-04   +1.76E-02  -1.21E+00, -5.95E-02, -1.37E+00, -1.99E-01
 1     00:00:00         12           13           129          129         0     +4.71E-02   +6.86E-04   +2.00E-02  -1.20E+00, -2.07E-02, -1.38E+00, -1.80E-01
 1     00:00:00         13           14           138          138         0     +3.75E-02   +9.61E-03   +1.30E-01  -1.10E+00, +5.77E-01, -1.52E+00, +2.65E-02
 1     00:00:00         14           15           131          131         0     +3.47E-02   +2.81E-03   +1.03E-01  -1.10E+00, +5.84E-01, -1.53E+00, +6.96E-03
 1     00:00:00         15           16           147          147         0     +1.24E+01               +5.55E+00  -2.31E-01, +4.94E+00, -2.48E+00, +7.03E-01
 1     00:00:00         16           17           137          137         0     +2.96E-02   +5.09E-03   +3.40E-02  -1.10E+00, +6.09E-01, -1.55E+00, -5.39E-02
 1     00:00:00         17           18           137          137         0     +2.88E-02   +8.55E-04   +3.15E-02  -1.09E+00, +6.29E-01, -1.55E+00, -6.74E-02
 1     00:00:00         18           19           141          141         0     +2.54E-02   +3.37E-03   +2.92E-02  -1.07E+00, +7.56E-01, -1.53E+00, -9.24E-02
 1     00:00:00         19           20           145          145         0     +2.08E-02   +4.63E-03   +7.12E-02  -1.03E+00, +1.05E+00, -1.55E+00, -8.29E-02
 1     00:00:00         20           21           144          144         0     +1.91E-02   +1.62E-03   +4.16E-02  -1.02E+00, +1.05E+00, -1.55E+00, -5.49E-02
 1     00:00:00         21           22           146          146         0     +1.12E-02   +7.89E-03   +1.96E-02  -9.48E-01, +1.49E+00, -1.69E+00, +1.12E-01
 1     00:00:00         22           23           149          149         0     +9.14E-03   +2.11E-03   +7.30E-03  -8.98E-01, +1.78E+00, -1.86E+00, +2.20E-01
 1     00:00:00         23           24           149          149         0     +9.02E-03   +1.16E-04   +4.98E-03  -8.89E-01, +1.77E+00, -1.88E+00, +2.19E-01
 1     00:00:00         24           25           147          147         0     +8.90E-03   +1.21E-04   +5.46E-03  -8.64E-01, +1.77E+00, -1.89E+00, +2.21E-01
 1     00:00:00         25           26           149          149         0     +8.67E-03   +2.30E-04   +1.11E-02  -8.03E-01, +1.76E+00, -1.91E+00, +2.21E-01
 1     00:00:00         26           27           148          148         0     +8.61E-03   +6.66E-05   +7.00E-03  -8.01E-01, +1.76E+00, -1.91E+00, +2.24E-01
 1     00:00:00         27           28           148          148         0     +5.92E-03   +2.68E-03   +1.46E-02  -3.58E-01, +1.71E+00, -1.97E+00, +2.51E-01
 1     00:00:00         28           29           146          146         0     +5.23E-03   +6.94E-04   +6.89E-03  -3.15E-01, +1.74E+00, -1.92E+00, +2.29E-01
 1     00:00:00         29           30           144          144         0     +1.34E-03   +3.89E-03   +6.79E-03  +3.90E-01, +1.65E+00, -1.96E+00, +2.29E-01
 1     00:00:00         30           31           154          154         0     +4.33E-05   +1.30E-03   +2.76E-03  +1.08E+00, +1.58E+00, -2.05E+00, +2.49E-01
 1     00:00:00         31           32           154          154         0     +2.64E-05   +1.69E-05   +3.95E-04  +1.08E+00, +1.58E+00, -2.04E+00, +2.46E-01
 1     00:00:00         32           33           151          151         0     +2.45E-06   +2.40E-05   +1.57E-04  +1.17E+00, +1.56E+00, -2.04E+00, +2.43E-01
 1     00:00:00         33           34           151          151         0     +7.61E-09   +2.44E-06   +7.93E-05  +1.21E+00, +1.56E+00, -2.04E+00, +2.44E-01
 1     00:00:00         34           35           152          152         0     +5.24E-09   +2.36E-09   +8.85E-06  +1.21E+00, +1.56E+00, -2.04E+00, +2.44E-01
 1     00:00:00         35           36           152          152         0     +3.68E-12   +5.24E-09   +4.11E-07  +1.21E+00, +1.56E+00, -2.04E+00, +2.44E-01
 1     00:00:00         36           37           152          152         0     +2.30E-13   +3.44E-12   +3.64E-08  +1.21E+00, +1.56E+00, -2.04E+00, +2.44E-01
 1     00:00:00         37           38           151          151         0     +1.98E-17   +2.30E-13   +9.08E-10  +1.21E+00, +1.56E+00, -2.04E+00, +2.44E-01
 1     00:00:00         38           39           151          151         0     +1.39E-20   +1.98E-17   +6.90E-12  +1.21E+00, +1.56E+00, -2.04E+00, +2.44E-01

Optimization completed after 00:00:01.
Computing the Hessian and and updating the weighting matrix ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +7.50E+18. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
=====================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number
----  ---------  ---------  --------------  --------------  -------  ----------------
 1    +1.39E-20  +6.90E-12    +2.95E-03       +1.65E+00        0        +1.23E+05    
=====================================================================================

Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 2     00:00:00         0             1           47           47          0     +6.90E+00               +5.15E+11  +1.21E+00, +1.56E+00, -2.04E+00, +2.44E-01
 2     00:00:00         1             2           123          123         0     +2.71E+20               +8.33E+20  +2.02E+00, +1.58E+00, -2.53E+00, -8.35E-02
 2     00:00:00         2             3           50           50          0     +4.46E+02               +1.04E+12  +1.21E+00, +1.56E+00, -2.04E+00, +2.44E-01

Optimization completed after 00:00:00.
Computing the Hessian and estimating standard errors ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +2.43E+17. To disable singularity checks, set options.singular_tol = numpy.inf.

Failed to compute standard errors because of invalid estimated covariances of GMM parameters.

Computed results after 00:00:00.

Problem Results Summary:
========================================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix  Covariance Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number  Condition Number 
----  ---------  ---------  --------------  --------------  -------  ----------------  -----------------
 2    +6.90E+00  +5.15E+11    -2.14E+18       +2.41E+21        0        +3.15E+16          +1.21E+22    
========================================================================================================

Cumulative Statistics:
===========================================================================
Computation  Optimizer  Optimization   Objective   Fixed Point  Contraction
   Time      Converged   Iterations   Evaluations  Iterations   Evaluations
-----------  ---------  ------------  -----------  -----------  -----------
 00:00:02       Yes          49           44          5966         5966    
===========================================================================

Nonlinear Coefficient Estimates (Robust SEs in Parentheses):
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +1.21E+00              +1.56E+00              -2.04E+00              +2.44E-01      
                   |            (+6.84E-10)            (+5.99E-10)            (+2.18E-10)            (+1.91E-10)     
=====================================================================================================================

Beta Estimates (Robust SEs in Parentheses):
===============================================================================================
     1         prices     hpi_quantile1  hpi_quantile2  hpi_quantile3       X            Y     
-----------  -----------  -------------  -------------  -------------  -----------  -----------
 +3.62E+00    -4.29E-13     -3.77E+00      -3.77E+00      +4.24E+00     -6.12E+00    -3.35E+00 
(+6.97E-10)     (NAN)      (+7.02E-10)    (+1.06E-09)    (+6.63E-10)   (+1.14E-09)  (+1.71E-09)
===============================================================================================
Computing delta ...
Finished after 00:00:00.

Mean delta: 0.9823854120429528
pi labels: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
ii=0, vv=logdistXhpi_quantile1
logdistXhpi_quantile1 is a distance term, omitting from ABD and adding to coefficients instead
ii=1, vv=logdistXhpi_quantile2
logdistXhpi_quantile2 is a distance term, omitting from ABD and adding to coefficients instead
ii=2, vv=logdistXhpi_quantile3
logdistXhpi_quantile3 is a distance term, omitting from ABD and adding to coefficients instead
ii=3, vv=logdistXhpi_quantile4
logdistXhpi_quantile4 is a distance term, omitting from ABD and adding to coefficients instead

Distance coefficients: [1.20811, 1.55895, -2.04376, 0.2443]

Computed abepsilon in: 0.011 seconds.
Assigning individuals...
time3 - time2: 0.319
time4 - time3: 2.001
Number of full locations: 15  out of  18
Offers:
% Rank 0 offers: 63.40560
% Rank 1 offers: 7.17654
% Rank 2 offers: 3.37982
% Rank 3 offers: 2.23886
% Rank 4 offers: 23.79919
% Offered any: 100.0
Mean offer distance: 1.32476
Quantiles of offered distances:
0.0 quantile: -2.65569
0.1 quantile: 0.18202
0.2 quantile: 0.50646
0.3 quantile: 0.78752
0.4 quantile: 1.02394
0.5 quantile: 1.23744
0.6 quantile: 1.50030
0.7 quantile: 2.04482
0.8 quantile: 2.26745
0.9 quantile: 2.57760
1.0 quantile: 3.19221
Assignments:
% Rank 0 assignments: 34.21010
% Rank 1 assignments: 3.74237
% Rank 2 assignments: 1.87814
% Rank 3 assignments: 1.34153
% Rank 4 assignments: 16.41236
% Assigned: 57.58451
Mean assignment distance: 1.47544
Quantiles of assignment distances:
0.0 quantile: -2.35557
0.1 quantile: 0.33247
0.2 quantile: 0.65289
0.3 quantile: 0.90874
0.4 quantile: 1.14165
0.5 quantile: 1.37015
0.6 quantile: 1.67639
0.7 quantile: 2.18276
0.8 quantile: 2.42653
0.9 quantile: 2.64704
1.0 quantile: 3.19221
Violations:
Max violation: 8787
Number of locations with violations: 15
Number of individuals with violations: 83825
Mean violation (conditional on violation): 5588.333333333333
Median violation (conditional on violation): 6654.0
Number of markets with wasserstein distance > 0.001: 10
Mean wasserstein distance for markets with wasserstein distance > 0.001: 0.13230270858260776
Mean wasserstein distance: 0.13230270858260776
Max wasserstein distance: 0.5315158008322828
Index of max wasserstein distance: 9
Iteration 1 complete.


Number of agents: 11134

Iteration 2:

agent_loc_data:
     blkid  locid   logdist       dist  market_ids  hpi_quantile  hpi_quantile1  hpi_quantile2  hpi_quantile3  hpi_quantile4  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4  nodes  population   weights
0   132759      0  0.737546   2.090799     90059.0             1              1              0              0              0               0.737546                    0.0                    0.0                    0.0      0       40488  0.000272
1   132759      4  1.309970   3.706062     90059.0             1              1              0              0              0               1.309970                    0.0                    0.0                    0.0      0       40488  0.000025
3   132759      1  2.186667   8.905486     90059.0             1              1              0              0              0               2.186667                    0.0                    0.0                    0.0      0       40488  0.000025
4   132759     16  2.388723  10.899569     90059.0             1              1              0              0              0               2.388723                    0.0                    0.0                    0.0      0       40488  0.000074
5   132760      0  0.817771   2.265445     90059.0             1              1              0              0              0               0.817771                    0.0                    0.0                    0.0      0       40488  0.001507
6   132760      4  1.368392   3.929026     90059.0             1              1              0              0              0               1.368392                    0.0                    0.0                    0.0      0       40488  0.000099
7   132760      7  1.909226   6.747865     90059.0             1              1              0              0              0               1.909226                    0.0                    0.0                    0.0      0       40488  0.000123
8   132760      1  2.210262   9.118109     90059.0             1              1              0              0              0               2.210262                    0.0                    0.0                    0.0      0       40488  0.000049
9   132760     16  2.407625  11.107545     90059.0             1              1              0              0              0               2.407625                    0.0                    0.0                    0.0      0       40488  0.000321
10  132761      0  0.835924   2.306944     90059.0             1              1              0              0              0               0.835924                    0.0                    0.0                    0.0      0       40488  0.000099
11  132761      4  1.393042   4.027080     90059.0             1              1              0              0              0               1.393042                    0.0                    0.0                    0.0      0       40488  0.000025
13  132761      1  2.221436   9.220563     90059.0             1              1              0              0              0               2.221436                    0.0                    0.0                    0.0      0       40488  0.000025
14  132761      9  2.405422  11.083104     90059.0             1              1              0              0              0               2.405422                    0.0                    0.0                    0.0      0       40488  0.000049
15  132763      0  0.685177   1.984123     90059.0             1              1              0              0              0               0.685177                    0.0                    0.0                    0.0      0       40488  0.000198
19  132763     16  2.382397  10.830829     90059.0             1              1              0              0              0               2.382397                    0.0                    0.0                    0.0      0       40488  0.000099
20  132772      0  0.959576   2.610589     90059.0             1              1              0              0              0               0.959576                    0.0                    0.0                    0.0      0       40488  0.002272
21  132772      4  1.464425   4.325055     90059.0             1              1              0              0              0               1.464425                    0.0                    0.0                    0.0      0       40488  0.000296
22  132772      7  1.847489   6.343871     90059.0             1              1              0              0              0               1.847489                    0.0                    0.0                    0.0      0       40488  0.000148
23  132772      1  2.250480   9.492289     90059.0             1              1              0              0              0               2.250480                    0.0                    0.0                    0.0      0       40488  0.000099
24  132772      9  2.387146  10.882389     90059.0             1              1              0              0              0               2.387146                    0.0                    0.0                    0.0      0       40488  0.000519
25  132774      0  1.021268   2.776713     90059.0             1              1              0              0              0               1.021268                    0.0                    0.0                    0.0      0       40488  0.001433
26  132774      4  1.507882   4.517154     90059.0             1              1              0              0              0               1.507882                    0.0                    0.0                    0.0      0       40488  0.000296
27  132774      7  1.816779   6.152013     90059.0             1              1              0              0              0               1.816779                    0.0                    0.0                    0.0      0       40488  0.000173
28  132774      1  2.269645   9.675964     90059.0             1              1              0              0              0               2.269645                    0.0                    0.0                    0.0      0       40488  0.000049
29  132774      9  2.373282  10.732561     90059.0             1              1              0              0              0               2.373282                    0.0                    0.0                    0.0      0       40488  0.000543
30  132775      0  0.943832   2.569810     90059.0             1              1              0              0              0               0.943832                    0.0                    0.0                    0.0      0       40488  0.002914
31  132775      4  1.464439   4.325118     90059.0             1              1              0              0              0               1.464439                    0.0                    0.0                    0.0      0       40488  0.000346
32  132775      7  1.850678   6.364134     90059.0             1              1              0              0              0               1.850678                    0.0                    0.0                    0.0      0       40488  0.000148
33  132775      1  2.251602   9.502947     90059.0             1              1              0              0              0               2.251602                    0.0                    0.0                    0.0      0       40488  0.000123
34  132775      9  2.384357  10.852086     90059.0             1              1              0              0              0               2.384357                    0.0                    0.0                    0.0      0       40488  0.000939
35  132776      0  0.887535   2.429133     90059.0             1              1              0              0              0               0.887535                    0.0                    0.0                    0.0      0       40488  0.001778
36  132776      4  1.415862   4.120036     90059.0             1              1              0              0              0               1.415862                    0.0                    0.0                    0.0      0       40488  0.000296
37  132776      7  1.879925   6.553017     90059.0             1              1              0              0              0               1.879925                    0.0                    0.0                    0.0      0       40488  0.000198
38  132776      1  2.229868   9.298637     90059.0             1              1              0              0              0               2.229868                    0.0                    0.0                    0.0      0       40488  0.000099
39  132776      9  2.401359  11.038164     90059.0             1              1              0              0              0               2.401359                    0.0                    0.0                    0.0      0       40488  0.000395
40  132792      0  0.788905   2.200984     90059.0             1              1              0              0              0               0.788905                    0.0                    0.0                    0.0      0       40488  0.005187
41  132792      4  1.462907   4.318494     90059.0             1              1              0              0              0               1.462907                    0.0                    0.0                    0.0      0       40488  0.000593
42  132792      7  1.889494   6.616020     90059.0             1              1              0              0              0               1.889494                    0.0                    0.0                    0.0      0       40488  0.000247
43  132792      1  2.258765   9.571262     90059.0             1              1              0              0              0               2.258765                    0.0                    0.0                    0.0      0       40488  0.000247
44  132792      9  2.363775  10.631010     90059.0             1              1              0              0              0               2.363775                    0.0                    0.0                    0.0      0       40488  0.001457
45  132793      0  0.782841   2.187679     90059.0             1              1              0              0              0               0.782841                    0.0                    0.0                    0.0      0       40488  0.004100
46  132793      4  1.473780   4.365707     90059.0             1              1              0              0              0               1.473780                    0.0                    0.0                    0.0      0       40488  0.000543
47  132793      7  1.890205   6.620723     90059.0             1              1              0              0              0               1.890205                    0.0                    0.0                    0.0      0       40488  0.000469
48  132793      1  2.264449   9.625818     90059.0             1              1              0              0              0               2.264449                    0.0                    0.0                    0.0      0       40488  0.000198
49  132793      9  2.357149  10.560804     90059.0             1              1              0              0              0               2.357149                    0.0                    0.0                    0.0      0       40488  0.001111
50  132794      0  0.887200   2.428321     90059.0             1              1              0              0              0               0.887200                    0.0                    0.0                    0.0      0       40488  0.001655
51  132794      4  1.526687   4.602902     90059.0             1              1              0              0              0               1.526687                    0.0                    0.0                    0.0      0       40488  0.000148
52  132794      7  1.852737   6.377253     90059.0             1              1              0              0              0               1.852737                    0.0                    0.0                    0.0      0       40488  0.000173
53  132794      1  2.287930   9.854524     90059.0             1              1              0              0              0               2.287930                    0.0                    0.0                    0.0      0       40488  0.000025
54  132794      9  2.338092  10.361449     90059.0             1              1              0              0              0               2.338092                    0.0                    0.0                    0.0      0       40488  0.000321
pi_init:
[[ 1.20811266  1.55895036 -2.0437627   0.24430246]]
Weight distribution by market:
count    10.0
mean      1.0
std       0.0
min       1.0
25%       1.0
50%       1.0
75%       1.0
max       1.0
Name: weights, dtype: float64
Estimating demand...
agent_vars: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
iv_df:
             demand_instruments0  demand_instruments1  demand_instruments2  demand_instruments3
market_ids                                                                                    
90059.0                0.820946             0.000000                  0.0             0.000000
90201.0                0.938794             0.000000                  0.0             0.000000
90277.0                0.000000             0.000000                  0.0             1.808149
90290.0                0.000000             0.000000                  0.0             2.836247
90302.0                0.000000             1.580358                  0.0             0.000000
Initializing the problem ...
Initialized the problem after 00:00:00.

Dimensions:
===========================================
 T    N    F     I     K1    K2    D    MD 
---  ---  ---  -----  ----  ----  ---  ----
10   10    1   11134   7     1     4    10 
===========================================

Formulations:
==================================================================================================================================================
       Column Indices:                   0                      1                      2                      3                  4         5    6 
-----------------------------  ---------------------  ---------------------  ---------------------  ---------------------  -------------  ---  ---
 X1: Linear Characteristics              1                   prices              hpi_quantile1          hpi_quantile2      hpi_quantile3   X    Y 
X2: Nonlinear Characteristics            1                                                                                                        
       d: Demographics         logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4                         
==================================================================================================================================================
pi_init: [[ 1.20811266  1.55895036 -2.0437627   0.24430246]]
pi_lb: [[-inf -inf -inf -inf]]
pi_ub: [[inf inf inf inf]]
Solving with one core...
Solving the problem ...

Nonlinear Coefficient Initial Values:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +1.21E+00              +1.56E+00              -2.04E+00              +2.44E-01      
=====================================================================================================================

Nonlinear Coefficient Lower Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           -INF                   -INF                   -INF                   -INF         
=====================================================================================================================

Nonlinear Coefficient Upper Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           +INF                   +INF                   +INF                   +INF         
=====================================================================================================================

The model may be under-identified. The total number of unfixed parameters is 11, which is more than the total number of moments, 10. Consider checking whether instruments were properly specified when initializing the problem, and whether parameters were properly configured when solving the problem.
Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 1     00:00:00         0             1           150          150         0     +1.79E-01               +2.38E-01  +1.21E+00, +1.56E+00, -2.04E+00, +2.44E-01
 1     00:00:00         1             2           146          146         0     +8.75E-02   +9.10E-02   +2.12E-01  +1.18E+00, +1.32E+00, -2.26E+00, +9.97E-02
 1     00:00:00         2             3           142          142         0     +1.80E-03   +8.57E-02   +4.85E-02  +1.13E+00, +7.04E-01, -2.65E+00, +1.15E-01
 1     00:00:00         3             4           143          143         0     +9.46E-04   +8.54E-04   +3.56E-03  +1.13E+00, +6.97E-01, -2.64E+00, +1.42E-01
 1     00:00:00         4             5           144          144         0     +9.22E-04   +2.35E-05   +3.28E-03  +1.13E+00, +6.93E-01, -2.64E+00, +1.43E-01
 1     00:00:00         5             6           142          142         0     +8.56E-04   +6.61E-05   +7.29E-03  +1.14E+00, +6.81E-01, -2.63E+00, +1.42E-01
 1     00:00:00         6             7           142          142         0     +7.64E-04   +9.19E-05   +9.15E-03  +1.17E+00, +6.63E-01, -2.62E+00, +1.35E-01
 1     00:00:00         7             8           141          141         0     +7.40E-04   +2.48E-05   +4.14E-03  +1.17E+00, +6.63E-01, -2.62E+00, +1.32E-01
 1     00:00:00         8             9           142          142         0     +6.63E-04   +7.62E-05   +2.31E-03  +1.21E+00, +6.45E-01, -2.60E+00, +1.19E-01
 1     00:00:00         9            10           142          142         0     +6.52E-04   +1.18E-05   +2.30E-03  +1.22E+00, +6.47E-01, -2.60E+00, +1.20E-01
 1     00:00:00         10           11           142          142         0     +4.10E-04   +2.41E-04   +9.95E-03  +1.33E+00, +6.71E-01, -2.63E+00, +1.28E-01
 1     00:00:00         11           12           142          142         0     +3.80E-04   +3.07E-05   +4.02E-03  +1.33E+00, +6.69E-01, -2.63E+00, +1.32E-01
 1     00:00:00         12           13           141          141         0     +1.14E-04   +2.66E-04   +2.83E-03  +1.51E+00, +6.83E-01, -2.67E+00, +1.51E-01
 1     00:00:00         13           14           142          142         0     +6.94E-05   +4.42E-05   +1.14E-03  +1.54E+00, +6.64E-01, -2.66E+00, +1.44E-01
 1     00:00:00         14           15           142          142         0     +1.21E-07   +6.93E-05   +2.77E-04  +1.69E+00, +6.63E-01, -2.69E+00, +1.51E-01
 1     00:00:00         15           16           141          141         0     +9.22E-08   +2.86E-08   +3.62E-05  +1.69E+00, +6.63E-01, -2.69E+00, +1.51E-01
 1     00:00:00         16           17           141          141         0     +4.18E-11   +9.22E-08   +9.53E-07  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 1     00:00:00         17           18           142          142         0     +7.00E-14   +4.18E-11   +1.36E-07  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 1     00:00:00         18           19           142          142         0     +8.98E-15   +6.10E-14   +1.91E-08  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 1     00:00:00         19           20           141          141         0     +2.97E-15   +6.00E-15   +5.68E-09  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 1     00:00:00         20           21           142          142         0     +1.72E-17   +2.95E-15   +1.17E-09  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 1     00:00:00         21           22           142          142         0     +4.30E-19   +1.68E-17   +3.30E-10  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 1     00:00:00         22           23           142          142         0     +3.89E-19   +4.09E-20   +8.62E-11  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01

Optimization completed after 00:00:01.
Computing the Hessian and and updating the weighting matrix ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +1.27E+17. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
=====================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number
----  ---------  ---------  --------------  --------------  -------  ----------------
 1    +3.89E-19  +8.62E-11    +5.07E-03       +1.74E+00        0        +1.16E+05    
=====================================================================================

Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 2     00:00:00         0             1           47           47          0     +3.14E+00               +6.60E+09  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         1             2           132          132         0     +4.50E+19               +1.01E+20  +1.81E+00, +2.23E-01, -2.37E+00, +9.83E-01
 2     00:00:00         2             3           50           50          0     +2.64E+00   +5.00E-01   +1.96E+09  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         3             4           50           50          0     +2.56E+00   +7.63E-02   +2.08E+09  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         4             5           50           50          0     +3.65E+00               +1.51E+10  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         5             6           50           50          0     +2.43E+00   +1.36E-01   +3.28E+09  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         6             7           50           50          0     +2.37E+00   +5.30E-02   +2.88E+09  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         7             8           50           50          0     +2.17E+00   +2.04E-01   +2.87E+09  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         8             9           50           50          0     +2.02E+00   +1.45E-01   +2.16E+09  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         9            10           50           50          0     +2.09E+00               +6.18E+09  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         10           11           50           50          0     +1.86E+00   +1.65E-01   +2.14E+09  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         11           12           50           50          0     +1.80E+00   +5.32E-02   +1.37E+09  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         12           13           50           50          0     +1.68E+00   +1.26E-01   +3.11E+09  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         13           14           50           50          0     +1.51E+00   +1.69E-01   +1.08E+09  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         14           15           50           50          0     +1.35E+00   +1.57E-01   +1.33E+09  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         15           16           50           50          0     +1.19E+00   +1.64E-01   +6.80E+08  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         16           17           50           50          0     +9.72E-01   +2.16E-01   +9.81E+08  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         17           18           50           50          0     +9.30E-01   +4.19E-02   +8.55E+08  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         18           19           50           50          0     +7.00E-01   +2.30E-01   +1.14E+09  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         19           20           70           70          0     +4.15E+05               +1.61E+12  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         20           21           50           50          0     +2.45E-01   +4.56E-01   +1.26E+09  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         21           22           50           50          0     +2.93E-01               +9.94E+08  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 2     00:00:00         22           23           50           50          0     +3.22E-01               +7.00E+08  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01

Optimization completed after 00:00:01.
Computing the Hessian and estimating standard errors ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +3.02E+17. To disable singularity checks, set options.singular_tol = numpy.inf.

Failed to compute standard errors because of invalid estimated covariances of GMM parameters.

Computed results after 00:00:00.

Problem Results Summary:
========================================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix  Covariance Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number  Condition Number 
----  ---------  ---------  --------------  --------------  -------  ----------------  -----------------
 2    +2.45E-01  +1.26E+09    -1.81E+16       +7.53E+19        0        +2.97E+16          +4.19E+20    
========================================================================================================

Cumulative Statistics:
===========================================================================
Computation  Optimizer  Optimization   Objective   Fixed Point  Contraction
   Time      Converged   Iterations   Evaluations  Iterations   Evaluations
-----------  ---------  ------------  -----------  -----------  -----------
 00:00:02       Yes          49           48          4717         4717    
===========================================================================

Nonlinear Coefficient Estimates (Robust SEs in Parentheses):
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +1.69E+00              +6.63E-01              -2.69E+00              +1.52E-01      
                   |            (+1.40E-09)            (+4.93E-10)            (+2.49E-10)            (+3.05E-10)     
=====================================================================================================================

Beta Estimates (Robust SEs in Parentheses):
===============================================================================================
     1         prices     hpi_quantile1  hpi_quantile2  hpi_quantile3       X            Y     
-----------  -----------  -------------  -------------  -------------  -----------  -----------
 +3.47E+00    -2.59E-14     -3.26E+00      -2.47E+00      +5.22E+00     -4.34E+00    -2.92E+00 
(+9.69E-10)     (NAN)      (+7.25E-10)    (+1.06E-09)    (+9.63E-10)   (+1.24E-09)  (+1.92E-09)
===============================================================================================
Computing delta ...
Finished after 00:00:00.

Mean delta: 1.7853258807056016
pi labels: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
ii=0, vv=logdistXhpi_quantile1
logdistXhpi_quantile1 is a distance term, omitting from ABD and adding to coefficients instead
ii=1, vv=logdistXhpi_quantile2
logdistXhpi_quantile2 is a distance term, omitting from ABD and adding to coefficients instead
ii=2, vv=logdistXhpi_quantile3
logdistXhpi_quantile3 is a distance term, omitting from ABD and adding to coefficients instead
ii=3, vv=logdistXhpi_quantile4
logdistXhpi_quantile4 is a distance term, omitting from ABD and adding to coefficients instead

Distance coefficients: [1.6947, 0.66324, -2.68803, 0.15162]

Computed abepsilon in: 0.011 seconds.
Assigning individuals...
time3 - time2: 0.33
time4 - time3: 2.226
Number of full locations: 15  out of  18
Offers:
% Rank 0 offers: 47.42457
% Rank 1 offers: 7.39811
% Rank 2 offers: 3.40765
% Rank 3 offers: 1.52950
% Rank 4 offers: 40.24016
% Offered any: 100.0
Mean offer distance: 1.58760
Quantiles of offered distances:
0.0 quantile: -2.65569
0.1 quantile: 0.33247
0.2 quantile: 0.73423
0.3 quantile: 1.05684
0.4 quantile: 1.34463
0.5 quantile: 1.73301
0.6 quantile: 2.12854
0.7 quantile: 2.24159
0.8 quantile: 2.37917
0.9 quantile: 2.60415
1.0 quantile: 3.19221
Assignments:
% Rank 0 assignments: 33.30437
% Rank 1 assignments: 6.07023
% Rank 2 assignments: 2.91199
% Rank 3 assignments: 1.33943
% Rank 4 assignments: 34.83623
% Assigned: 78.46225
Mean assignment distance: 1.70740
Quantiles of assignment distances:
0.0 quantile: -2.35557
0.1 quantile: 0.50980
0.2 quantile: 0.88754
0.3 quantile: 1.20524
0.4 quantile: 1.50463
0.5 quantile: 2.03587
0.6 quantile: 2.17406
0.7 quantile: 2.27697
0.8 quantile: 2.42034
0.9 quantile: 2.62249
1.0 quantile: 3.19221
Violations:
Max violation: 24283
Number of locations with violations: 15
Number of individuals with violations: 149568
Mean violation (conditional on violation): 9971.2
Median violation (conditional on violation): 9064.0
Number of markets with wasserstein distance > 0.001: 10
Mean wasserstein distance for markets with wasserstein distance > 0.001: 0.25600311040027457
Mean wasserstein distance: 0.25600311040027457
Max wasserstein distance: 0.736845446781088
Index of max wasserstein distance: 0
Iteration 2 complete.


Number of agents: 11277

Iteration 3:

agent_loc_data:
     blkid  locid   logdist       dist  market_ids  hpi_quantile  hpi_quantile1  hpi_quantile2  hpi_quantile3  hpi_quantile4  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4  nodes  population   weights
0   132759      0  0.737546   2.090799     90059.0             1              1              0              0              0               0.737546                    0.0                    0.0                    0.0      0       40488  0.000173
4   132759     16  2.388723  10.899569     90059.0             1              1              0              0              0               2.388723                    0.0                    0.0                    0.0      0       40488  0.000222
5   132760      0  0.817771   2.265445     90059.0             1              1              0              0              0               0.817771                    0.0                    0.0                    0.0      0       40488  0.001037
6   132760      4  1.368392   3.929026     90059.0             1              1              0              0              0               1.368392                    0.0                    0.0                    0.0      0       40488  0.000123
7   132760      7  1.909226   6.747865     90059.0             1              1              0              0              0               1.909226                    0.0                    0.0                    0.0      0       40488  0.000025
9   132760     16  2.407625  11.107545     90059.0             1              1              0              0              0               2.407625                    0.0                    0.0                    0.0      0       40488  0.000914
10  132761      0  0.835924   2.306944     90059.0             1              1              0              0              0               0.835924                    0.0                    0.0                    0.0      0       40488  0.000074
14  132761      9  2.405422  11.083104     90059.0             1              1              0              0              0               2.405422                    0.0                    0.0                    0.0      0       40488  0.000123
15  132763      0  0.685177   1.984123     90059.0             1              1              0              0              0               0.685177                    0.0                    0.0                    0.0      0       40488  0.000173
19  132763     16  2.382397  10.830829     90059.0             1              1              0              0              0               2.382397                    0.0                    0.0                    0.0      0       40488  0.000123
20  132772      0  0.959576   2.610589     90059.0             1              1              0              0              0               0.959576                    0.0                    0.0                    0.0      0       40488  0.001754
21  132772      4  1.464425   4.325055     90059.0             1              1              0              0              0               1.464425                    0.0                    0.0                    0.0      0       40488  0.000099
22  132772      7  1.847489   6.343871     90059.0             1              1              0              0              0               1.847489                    0.0                    0.0                    0.0      0       40488  0.000099
24  132772      9  2.387146  10.882389     90059.0             1              1              0              0              0               2.387146                    0.0                    0.0                    0.0      0       40488  0.001383
25  132774      0  1.021268   2.776713     90059.0             1              1              0              0              0               1.021268                    0.0                    0.0                    0.0      0       40488  0.001087
26  132774      4  1.507882   4.517154     90059.0             1              1              0              0              0               1.507882                    0.0                    0.0                    0.0      0       40488  0.000123
27  132774      7  1.816779   6.152013     90059.0             1              1              0              0              0               1.816779                    0.0                    0.0                    0.0      0       40488  0.000025
29  132774      9  2.373282  10.732561     90059.0             1              1              0              0              0               2.373282                    0.0                    0.0                    0.0      0       40488  0.001260
30  132775      0  0.943832   2.569810     90059.0             1              1              0              0              0               0.943832                    0.0                    0.0                    0.0      0       40488  0.002470
31  132775      4  1.464439   4.325118     90059.0             1              1              0              0              0               1.464439                    0.0                    0.0                    0.0      0       40488  0.000099
32  132775      7  1.850678   6.364134     90059.0             1              1              0              0              0               1.850678                    0.0                    0.0                    0.0      0       40488  0.000074
33  132775      1  2.251602   9.502947     90059.0             1              1              0              0              0               2.251602                    0.0                    0.0                    0.0      0       40488  0.000025
34  132775      9  2.384357  10.852086     90059.0             1              1              0              0              0               2.384357                    0.0                    0.0                    0.0      0       40488  0.001803
35  132776      0  0.887535   2.429133     90059.0             1              1              0              0              0               0.887535                    0.0                    0.0                    0.0      0       40488  0.001210
36  132776      4  1.415862   4.120036     90059.0             1              1              0              0              0               1.415862                    0.0                    0.0                    0.0      0       40488  0.000222
37  132776      7  1.879925   6.553017     90059.0             1              1              0              0              0               1.879925                    0.0                    0.0                    0.0      0       40488  0.000099
39  132776      9  2.401359  11.038164     90059.0             1              1              0              0              0               2.401359                    0.0                    0.0                    0.0      0       40488  0.001235
40  132792      0  0.788905   2.200984     90059.0             1              1              0              0              0               0.788905                    0.0                    0.0                    0.0      0       40488  0.003828
41  132792      4  1.462907   4.318494     90059.0             1              1              0              0              0               1.462907                    0.0                    0.0                    0.0      0       40488  0.000173
42  132792      7  1.889494   6.616020     90059.0             1              1              0              0              0               1.889494                    0.0                    0.0                    0.0      0       40488  0.000222
43  132792      1  2.258765   9.571262     90059.0             1              1              0              0              0               2.258765                    0.0                    0.0                    0.0      0       40488  0.000123
44  132792      9  2.363775  10.631010     90059.0             1              1              0              0              0               2.363775                    0.0                    0.0                    0.0      0       40488  0.003384
45  132793      0  0.782841   2.187679     90059.0             1              1              0              0              0               0.782841                    0.0                    0.0                    0.0      0       40488  0.003236
46  132793      4  1.473780   4.365707     90059.0             1              1              0              0              0               1.473780                    0.0                    0.0                    0.0      0       40488  0.000247
47  132793      7  1.890205   6.620723     90059.0             1              1              0              0              0               1.890205                    0.0                    0.0                    0.0      0       40488  0.000074
48  132793      1  2.264449   9.625818     90059.0             1              1              0              0              0               2.264449                    0.0                    0.0                    0.0      0       40488  0.000025
49  132793      9  2.357149  10.560804     90059.0             1              1              0              0              0               2.357149                    0.0                    0.0                    0.0      0       40488  0.002840
50  132794      0  0.887200   2.428321     90059.0             1              1              0              0              0               0.887200                    0.0                    0.0                    0.0      0       40488  0.001284
51  132794      4  1.526687   4.602902     90059.0             1              1              0              0              0               1.526687                    0.0                    0.0                    0.0      0       40488  0.000074
52  132794      7  1.852737   6.377253     90059.0             1              1              0              0              0               1.852737                    0.0                    0.0                    0.0      0       40488  0.000025
54  132794      9  2.338092  10.361449     90059.0             1              1              0              0              0               2.338092                    0.0                    0.0                    0.0      0       40488  0.000939
55  132795      0  0.939920   2.559777     90059.0             1              1              0              0              0               0.939920                    0.0                    0.0                    0.0      0       40488  0.000395
57  132795      7  1.831855   6.245459     90059.0             1              1              0              0              0               1.831855                    0.0                    0.0                    0.0      0       40488  0.000025
59  132795      9  2.325947  10.236375     90059.0             1              1              0              0              0               2.325947                    0.0                    0.0                    0.0      0       40488  0.000198
60  132796      0  0.770565   2.160988     90059.0             1              1              0              0              0               0.770565                    0.0                    0.0                    0.0      0       40488  0.004075
61  132796      4  1.482172   4.402496     90059.0             1              1              0              0              0               1.482172                    0.0                    0.0                    0.0      0       40488  0.000272
62  132796      7  1.893739   6.644165     90059.0             1              1              0              0              0               1.893739                    0.0                    0.0                    0.0      0       40488  0.000198
64  132796      9  2.351270  10.498892     90059.0             1              1              0              0              0               2.351270                    0.0                    0.0                    0.0      0       40488  0.002840
65  132797      0  0.898773   2.456588     90059.0             1              1              0              0              0               0.898773                    0.0                    0.0                    0.0      0       40488  0.001729
66  132797      4  1.544251   4.684460     90059.0             1              1              0              0              0               1.544251                    0.0                    0.0                    0.0      0       40488  0.000198
pi_init:
[[ 1.69469698  0.66324288 -2.68803351  0.15162301]]
Weight distribution by market:
count    10.0
mean      1.0
std       0.0
min       1.0
25%       1.0
50%       1.0
75%       1.0
max       1.0
Name: weights, dtype: float64
Estimating demand...
agent_vars: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
iv_df:
             demand_instruments0  demand_instruments1  demand_instruments2  demand_instruments3
market_ids                                                                                    
90059.0                1.239871             0.000000                  0.0             0.000000
90201.0                1.301068             0.000000                  0.0             0.000000
90277.0                0.000000             0.000000                  0.0             1.926040
90290.0                0.000000             0.000000                  0.0             2.839433
90302.0                0.000000             1.618245                  0.0             0.000000
Initializing the problem ...
Initialized the problem after 00:00:00.

Dimensions:
===========================================
 T    N    F     I     K1    K2    D    MD 
---  ---  ---  -----  ----  ----  ---  ----
10   10    1   11277   7     1     4    10 
===========================================

Formulations:
==================================================================================================================================================
       Column Indices:                   0                      1                      2                      3                  4         5    6 
-----------------------------  ---------------------  ---------------------  ---------------------  ---------------------  -------------  ---  ---
 X1: Linear Characteristics              1                   prices              hpi_quantile1          hpi_quantile2      hpi_quantile3   X    Y 
X2: Nonlinear Characteristics            1                                                                                                        
       d: Demographics         logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4                         
==================================================================================================================================================
pi_init: [[ 1.69469698  0.66324288 -2.68803351  0.15162301]]
pi_lb: [[-inf -inf -inf -inf]]
pi_ub: [[inf inf inf inf]]
Solving with one core...
Solving the problem ...

Nonlinear Coefficient Initial Values:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +1.69E+00              +6.63E-01              -2.69E+00              +1.52E-01      
=====================================================================================================================

Nonlinear Coefficient Lower Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           -INF                   -INF                   -INF                   -INF         
=====================================================================================================================

Nonlinear Coefficient Upper Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           +INF                   +INF                   +INF                   +INF         
=====================================================================================================================

The model may be under-identified. The total number of unfixed parameters is 11, which is more than the total number of moments, 10. Consider checking whether instruments were properly specified when initializing the problem, and whether parameters were properly configured when solving the problem.
Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 1     00:00:00         0             1           148          148         0     +5.58E-02               +1.52E-01  +1.69E+00, +6.63E-01, -2.69E+00, +1.52E-01
 1     00:00:00         1             2           153          153         0     +3.71E-02   +1.87E-02   +8.08E-02  +1.70E+00, +7.04E-01, -2.54E+00, +2.35E-01
 1     00:00:00         2             3           151          151         0     +2.44E-02   +1.27E-02   +8.43E-02  +1.70E+00, +7.64E-01, -2.40E+00, +2.00E-01
 1     00:00:00         3             4           145          145         0     +1.02E-02   +1.43E-02   +2.25E-02  +1.72E+00, +8.99E-01, -2.09E+00, +6.51E-02
 1     00:00:00         4             5           145          145         0     +9.83E-03   +3.37E-04   +1.39E-02  +1.72E+00, +8.90E-01, -2.09E+00, +5.00E-02
 1     00:00:00         5             6           147          147         0     +9.47E-03   +3.64E-04   +1.29E-02  +1.72E+00, +8.67E-01, -2.09E+00, +3.24E-02
 1     00:00:00         6             7           139          139         0     +8.95E-03   +5.14E-04   +1.72E-02  +1.73E+00, +8.19E-01, -2.06E+00, +8.81E-03
 1     00:00:00         7             8           143          143         0     +8.79E-03   +1.67E-04   +8.50E-03  +1.73E+00, +8.15E-01, -2.06E+00, +1.55E-02
 1     00:00:00         8             9           139          139         0     +8.28E-03   +5.10E-04   +1.62E-03  +1.74E+00, +7.38E-01, -2.00E+00, -5.01E-03
 1     00:00:00         9            10           141          141         0     +8.27E-03   +6.89E-06   +1.60E-03  +1.75E+00, +7.34E-01, -1.99E+00, -8.76E-03
 1     00:00:00         10           11           140          140         0     +8.27E-03   +2.48E-06   +1.60E-03  +1.75E+00, +7.33E-01, -1.99E+00, -8.53E-03
 1     00:00:00         11           12           139          139         0     +8.03E-03   +2.34E-04   +1.22E-02  +1.93E+00, +7.23E-01, -2.01E+00, +6.79E-03
 1     00:00:00         12           13           138          138         0     +7.99E-03   +4.16E-05   +7.98E-03  +1.93E+00, +7.24E-01, -2.01E+00, +3.16E-03
 1     00:00:00         13           14           139          139         0     +7.92E-03   +7.30E-05   +1.92E-03  +1.95E+00, +7.35E-01, -2.00E+00, -6.74E-03
 1     00:00:00         14           15           134          134         0     +5.91E-03   +2.01E-03   +1.44E-02  +2.87E+00, +7.21E-01, -2.04E+00, -7.01E-03
 1     00:00:00         15           16           135          135         0     +5.79E-03   +1.12E-04   +2.26E-03  +2.87E+00, +7.22E-01, -2.04E+00, +4.32E-03
 1     00:00:00         16           17           141          141         0     +4.30E-03   +1.49E-03   +2.92E-03  +3.92E+00, +7.26E-01, -2.08E+00, +2.06E-02
 1     00:00:00         17           18           141          141         0     +4.26E-03   +3.96E-05   +5.41E-04  +3.92E+00, +7.40E-01, -2.07E+00, +1.71E-02
 1     00:00:00         18           19           138          138         0     +4.17E-03   +8.80E-05   +7.10E-04  +4.26E+00, +7.48E-01, -2.08E+00, +2.15E-02
 1     00:00:00         19           20           140          140         0     +4.17E-03   +2.15E-06   +3.63E-05  +4.26E+00, +7.44E-01, -2.07E+00, +1.94E-02
 1     00:00:00         20           21           140          140         0     +4.17E-03   +6.45E-09   +3.73E-06  +4.26E+00, +7.44E-01, -2.07E+00, +1.93E-02
 1     00:00:00         21           22           139          139         0     +4.17E-03   +4.32E-09   +9.17E-07  +4.26E+00, +7.44E-01, -2.07E+00, +1.93E-02
 1     00:00:00         22           23           140          140         0     +4.17E-03   +3.56E-12   +2.79E-07  +4.26E+00, +7.44E-01, -2.07E+00, +1.93E-02
 1     00:00:00         23           24           140          140         0     +4.17E-03   +3.61E-12   +8.60E-09  +4.26E+00, +7.44E-01, -2.07E+00, +1.93E-02
 1     00:00:00         24           25           140          140         0     +4.17E-03   +2.11E-16   +4.22E-10  +4.26E+00, +7.44E-01, -2.07E+00, +1.93E-02
 1     00:00:00         25           26           140          140         0     +4.17E-03   +3.78E-16   +1.42E-11  +4.26E+00, +7.44E-01, -2.07E+00, +1.93E-02

Optimization completed after 00:00:01.
Computing the Hessian and and updating the weighting matrix ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +3.35E+20. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
=====================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number
----  ---------  ---------  --------------  --------------  -------  ----------------
 1    +4.17E-03  +1.42E-11    +1.62E-03       +1.23E+00        0        +1.86E+05    
=====================================================================================

Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 2     00:00:00         0             1           47           47          0     +6.33E+00               +6.24E+01  +4.26E+00, +7.44E-01, -2.07E+00, +1.93E-02
 2     00:00:00         1             2           130          130         0     +3.57E+02               +7.44E+02  +4.26E+00, +4.57E-02, -1.66E+00, +6.05E-01
 2     00:00:00         2             3           100          100         0     +3.64E-01   +5.96E+00   +2.43E+01  +4.26E+00, +6.79E-01, -1.98E+00, +1.01E-01
 2     00:00:00         3             4           100          100         0     +2.64E-02   +3.37E-01   +6.87E+00  +4.26E+00, +6.95E-01, -1.97E+00, +1.13E-01
 2     00:00:00         4             5           100          100         0     +2.64E-05   +2.64E-02   +1.14E-01  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         5             6           100          100         0     +1.63E-09   +2.64E-05   +2.15E-03  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         6             7           100          100         0     +2.22E-10   +1.41E-09   +3.17E-04  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         7             8           100          100         0     +8.49E-11   +1.38E-10   +1.90E-04  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         8             9           100          100         0     +1.40E-11   +7.09E-11   +2.52E-04  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         9            10           100          100         0     +2.40E-11               +4.18E-04  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         10           11           100          100         0     +3.59E-10               +7.01E-04  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         11           12           100          100         0     +1.61E-09               +1.12E-03  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         12           13           100          100         0     +7.11E-09               +2.01E-03  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         13           14           100          100         0     +2.71E-09               +2.21E-03  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         14           15           100          100         0     +1.95E-10               +5.46E-04  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         15           16           103          103         0     +2.76E-10               +3.37E-04  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         16           17           100          100         0     +2.78E-10               +3.43E-04  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         17           18           104          104         0     +4.31E-10               +4.38E-04  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         18           19           104          104         0     +2.74E-10               +3.53E-04  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         19           20           100          100         0     +2.47E-10               +3.96E-04  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         20           21           99           99          0     +8.28E-11               +2.27E-04  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         21           22           100          100         0     +3.71E-11               +1.64E-04  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         22           23           100          100         0     +2.27E-11               +2.09E-04  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         23           24           100          100         0     +1.76E-11               +2.30E-04  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         24           25           100          100         0     +1.56E-11               +2.42E-04  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         25           26           100          100         0     +1.48E-11               +2.47E-04  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 2     00:00:00         26           27           100          100         0     +1.44E-11               +2.50E-04  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01

Optimization completed after 00:00:01.
Computing the Hessian and estimating standard errors ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +1.19E+20. To disable singularity checks, set options.singular_tol = numpy.inf.
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +4.86E+16. To disable singularity checks, set options.singular_tol = numpy.inf.

Failed to compute standard errors because of invalid estimated covariances of GMM parameters.

Computed results after 00:00:00.

Problem Results Summary:
========================================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix  Covariance Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number  Condition Number 
----  ---------  ---------  --------------  --------------  -------  ----------------  -----------------
 2    +1.40E-11  +2.52E-04    -1.92E+01       +1.78E+03        0        +3.05E+30          +4.27E+20    
========================================================================================================

Cumulative Statistics:
===========================================================================
Computation  Optimizer  Optimization   Objective   Fixed Point  Contraction
   Time      Converged   Iterations   Evaluations  Iterations   Evaluations
-----------  ---------  ------------  -----------  -----------  -----------
 00:00:02       Yes          53           55          6602         6602    
===========================================================================

Nonlinear Coefficient Estimates (Robust SEs in Parentheses):
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +4.26E+00              +6.90E-01              -1.96E+00              +1.18E-01      
                   |            (+1.21E-01)            (+9.80E-02)            (+4.29E-02)            (+7.78E-02)     
=====================================================================================================================

Beta Estimates (Robust SEs in Parentheses):
===============================================================================================
     1         prices     hpi_quantile1  hpi_quantile2  hpi_quantile3       X            Y     
-----------  -----------  -------------  -------------  -------------  -----------  -----------
 +2.35E+00    -4.34E-12     -4.47E+00      -1.72E+00      +4.36E+00     -7.73E+00    -8.23E-01 
(+2.72E-01)     (NAN)      (+1.90E-01)    (+3.26E-01)    (+2.54E-01)   (+6.45E-02)  (+1.67E-01)
===============================================================================================
Computing delta ...
Finished after 00:00:00.

Mean delta: 1.0046036625619739
pi labels: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
ii=0, vv=logdistXhpi_quantile1
logdistXhpi_quantile1 is a distance term, omitting from ABD and adding to coefficients instead
ii=1, vv=logdistXhpi_quantile2
logdistXhpi_quantile2 is a distance term, omitting from ABD and adding to coefficients instead
ii=2, vv=logdistXhpi_quantile3
logdistXhpi_quantile3 is a distance term, omitting from ABD and adding to coefficients instead
ii=3, vv=logdistXhpi_quantile4
logdistXhpi_quantile4 is a distance term, omitting from ABD and adding to coefficients instead

Distance coefficients: [4.25562, 0.68978, -1.961, 0.11827]

Computed abepsilon in: 0.011 seconds.
Assigning individuals...
time3 - time2: 0.313
time4 - time3: 2.114
Number of full locations: 15  out of  18
Offers:
% Rank 0 offers: 52.70879
% Rank 1 offers: 9.20117
% Rank 2 offers: 4.25037
% Rank 3 offers: 2.73793
% Rank 4 offers: 31.10174
% Offered any: 100.0
Mean offer distance: 1.48018
Quantiles of offered distances:
0.0 quantile: -2.65569
0.1 quantile: 0.25391
0.2 quantile: 0.62514
0.3 quantile: 0.93714
0.4 quantile: 1.20533
0.5 quantile: 1.48475
0.6 quantile: 1.98320
0.7 quantile: 2.18816
0.8 quantile: 2.34398
0.9 quantile: 2.59719
1.0 quantile: 3.19221
Assignments:
% Rank 0 assignments: 30.02063
% Rank 1 assignments: 7.29572
% Rank 2 assignments: 3.67333
% Rank 3 assignments: 2.42394
% Rank 4 assignments: 26.97476
% Assigned: 70.38839
Mean assignment distance: 1.72276
Quantiles of assignment distances:
0.0 quantile: -2.05992
0.1 quantile: 0.64497
0.2 quantile: 0.98871
0.3 quantile: 1.23445
0.4 quantile: 1.50258
0.5 quantile: 1.94581
0.6 quantile: 2.14332
0.7 quantile: 2.25988
0.8 quantile: 2.41697
0.9 quantile: 2.61749
1.0 quantile: 3.19221
Violations:
Max violation: 21947
Number of locations with violations: 15
Number of individuals with violations: 114207
Mean violation (conditional on violation): 7613.8
Median violation (conditional on violation): 6841.0
Number of markets with wasserstein distance > 0.001: 9
Mean wasserstein distance for markets with wasserstein distance > 0.001: 0.12219291990006147
Mean wasserstein distance: 0.1100185745666096
Max wasserstein distance: 0.3066066269839549
Index of max wasserstein distance: 0
Iteration 3 complete.


Number of agents: 11494

Iteration 4:

agent_loc_data:
     blkid  locid   logdist       dist  market_ids  hpi_quantile  hpi_quantile1  hpi_quantile2  hpi_quantile3  hpi_quantile4  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4  nodes  population   weights
0   132759      0  0.737546   2.090799     90059.0             1              1              0              0              0               0.737546                    0.0                    0.0                    0.0      0       40488  0.000247
1   132759      4  1.309970   3.706062     90059.0             1              1              0              0              0               1.309970                    0.0                    0.0                    0.0      0       40488  0.000025
2   132759      7  1.941876   6.971814     90059.0             1              1              0              0              0               1.941876                    0.0                    0.0                    0.0      0       40488  0.000025
4   132759     16  2.388723  10.899569     90059.0             1              1              0              0              0               2.388723                    0.0                    0.0                    0.0      0       40488  0.000099
5   132760      0  0.817771   2.265445     90059.0             1              1              0              0              0               0.817771                    0.0                    0.0                    0.0      0       40488  0.001235
6   132760      4  1.368392   3.929026     90059.0             1              1              0              0              0               1.368392                    0.0                    0.0                    0.0      0       40488  0.000272
7   132760      7  1.909226   6.747865     90059.0             1              1              0              0              0               1.909226                    0.0                    0.0                    0.0      0       40488  0.000074
9   132760     16  2.407625  11.107545     90059.0             1              1              0              0              0               2.407625                    0.0                    0.0                    0.0      0       40488  0.000519
10  132761      0  0.835924   2.306944     90059.0             1              1              0              0              0               0.835924                    0.0                    0.0                    0.0      0       40488  0.000099
11  132761      4  1.393042   4.027080     90059.0             1              1              0              0              0               1.393042                    0.0                    0.0                    0.0      0       40488  0.000025
14  132761      9  2.405422  11.083104     90059.0             1              1              0              0              0               2.405422                    0.0                    0.0                    0.0      0       40488  0.000074
15  132763      0  0.685177   1.984123     90059.0             1              1              0              0              0               0.685177                    0.0                    0.0                    0.0      0       40488  0.000173
19  132763     16  2.382397  10.830829     90059.0             1              1              0              0              0               2.382397                    0.0                    0.0                    0.0      0       40488  0.000123
20  132772      0  0.959576   2.610589     90059.0             1              1              0              0              0               0.959576                    0.0                    0.0                    0.0      0       40488  0.001926
21  132772      4  1.464425   4.325055     90059.0             1              1              0              0              0               1.464425                    0.0                    0.0                    0.0      0       40488  0.000321
22  132772      7  1.847489   6.343871     90059.0             1              1              0              0              0               1.847489                    0.0                    0.0                    0.0      0       40488  0.000198
23  132772      1  2.250480   9.492289     90059.0             1              1              0              0              0               2.250480                    0.0                    0.0                    0.0      0       40488  0.000025
24  132772      9  2.387146  10.882389     90059.0             1              1              0              0              0               2.387146                    0.0                    0.0                    0.0      0       40488  0.000864
25  132774      0  1.021268   2.776713     90059.0             1              1              0              0              0               1.021268                    0.0                    0.0                    0.0      0       40488  0.001358
26  132774      4  1.507882   4.517154     90059.0             1              1              0              0              0               1.507882                    0.0                    0.0                    0.0      0       40488  0.000247
27  132774      7  1.816779   6.152013     90059.0             1              1              0              0              0               1.816779                    0.0                    0.0                    0.0      0       40488  0.000099
28  132774      1  2.269645   9.675964     90059.0             1              1              0              0              0               2.269645                    0.0                    0.0                    0.0      0       40488  0.000025
29  132774      9  2.373282  10.732561     90059.0             1              1              0              0              0               2.373282                    0.0                    0.0                    0.0      0       40488  0.000766
30  132775      0  0.943832   2.569810     90059.0             1              1              0              0              0               0.943832                    0.0                    0.0                    0.0      0       40488  0.002643
31  132775      4  1.464439   4.325118     90059.0             1              1              0              0              0               1.464439                    0.0                    0.0                    0.0      0       40488  0.000395
32  132775      7  1.850678   6.364134     90059.0             1              1              0              0              0               1.850678                    0.0                    0.0                    0.0      0       40488  0.000198
33  132775      1  2.251602   9.502947     90059.0             1              1              0              0              0               2.251602                    0.0                    0.0                    0.0      0       40488  0.000025
34  132775      9  2.384357  10.852086     90059.0             1              1              0              0              0               2.384357                    0.0                    0.0                    0.0      0       40488  0.001210
35  132776      0  0.887535   2.429133     90059.0             1              1              0              0              0               0.887535                    0.0                    0.0                    0.0      0       40488  0.001408
36  132776      4  1.415862   4.120036     90059.0             1              1              0              0              0               1.415862                    0.0                    0.0                    0.0      0       40488  0.000445
37  132776      7  1.879925   6.553017     90059.0             1              1              0              0              0               1.879925                    0.0                    0.0                    0.0      0       40488  0.000198
38  132776      1  2.229868   9.298637     90059.0             1              1              0              0              0               2.229868                    0.0                    0.0                    0.0      0       40488  0.000025
39  132776      9  2.401359  11.038164     90059.0             1              1              0              0              0               2.401359                    0.0                    0.0                    0.0      0       40488  0.000692
40  132792      0  0.788905   2.200984     90059.0             1              1              0              0              0               0.788905                    0.0                    0.0                    0.0      0       40488  0.004322
41  132792      4  1.462907   4.318494     90059.0             1              1              0              0              0               1.462907                    0.0                    0.0                    0.0      0       40488  0.000963
42  132792      7  1.889494   6.616020     90059.0             1              1              0              0              0               1.889494                    0.0                    0.0                    0.0      0       40488  0.000321
43  132792      1  2.258765   9.571262     90059.0             1              1              0              0              0               2.258765                    0.0                    0.0                    0.0      0       40488  0.000049
44  132792      9  2.363775  10.631010     90059.0             1              1              0              0              0               2.363775                    0.0                    0.0                    0.0      0       40488  0.002075
45  132793      0  0.782841   2.187679     90059.0             1              1              0              0              0               0.782841                    0.0                    0.0                    0.0      0       40488  0.003779
46  132793      4  1.473780   4.365707     90059.0             1              1              0              0              0               1.473780                    0.0                    0.0                    0.0      0       40488  0.000642
47  132793      7  1.890205   6.620723     90059.0             1              1              0              0              0               1.890205                    0.0                    0.0                    0.0      0       40488  0.000222
48  132793      1  2.264449   9.625818     90059.0             1              1              0              0              0               2.264449                    0.0                    0.0                    0.0      0       40488  0.000074
49  132793      9  2.357149  10.560804     90059.0             1              1              0              0              0               2.357149                    0.0                    0.0                    0.0      0       40488  0.001704
50  132794      0  0.887200   2.428321     90059.0             1              1              0              0              0               0.887200                    0.0                    0.0                    0.0      0       40488  0.001457
51  132794      4  1.526687   4.602902     90059.0             1              1              0              0              0               1.526687                    0.0                    0.0                    0.0      0       40488  0.000296
52  132794      7  1.852737   6.377253     90059.0             1              1              0              0              0               1.852737                    0.0                    0.0                    0.0      0       40488  0.000049
53  132794      1  2.287930   9.854524     90059.0             1              1              0              0              0               2.287930                    0.0                    0.0                    0.0      0       40488  0.000049
54  132794      9  2.338092  10.361449     90059.0             1              1              0              0              0               2.338092                    0.0                    0.0                    0.0      0       40488  0.000469
55  132795      0  0.939920   2.559777     90059.0             1              1              0              0              0               0.939920                    0.0                    0.0                    0.0      0       40488  0.000420
56  132795      4  1.556965   4.744402     90059.0             1              1              0              0              0               1.556965                    0.0                    0.0                    0.0      0       40488  0.000049
pi_init:
[[ 4.25561948  0.68978338 -1.96100488  0.118265  ]]
Weight distribution by market:
count    10.0
mean      1.0
std       0.0
min       1.0
25%       1.0
50%       1.0
75%       1.0
max       1.0
Name: weights, dtype: float64
Estimating demand...
agent_vars: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
iv_df:
             demand_instruments0  demand_instruments1  demand_instruments2  demand_instruments3
market_ids                                                                                    
90059.0                1.009589             0.000000                  0.0             0.000000
90201.0                1.118504             0.000000                  0.0             0.000000
90277.0                0.000000             0.000000                  0.0             1.900235
90290.0                0.000000             0.000000                  0.0             2.838979
90302.0                0.000000             1.603709                  0.0             0.000000
Initializing the problem ...
Initialized the problem after 00:00:00.

Dimensions:
===========================================
 T    N    F     I     K1    K2    D    MD 
---  ---  ---  -----  ----  ----  ---  ----
10   10    1   11494   7     1     4    10 
===========================================

Formulations:
==================================================================================================================================================
       Column Indices:                   0                      1                      2                      3                  4         5    6 
-----------------------------  ---------------------  ---------------------  ---------------------  ---------------------  -------------  ---  ---
 X1: Linear Characteristics              1                   prices              hpi_quantile1          hpi_quantile2      hpi_quantile3   X    Y 
X2: Nonlinear Characteristics            1                                                                                                        
       d: Demographics         logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4                         
==================================================================================================================================================
pi_init: [[ 4.25561948  0.68978338 -1.96100488  0.118265  ]]
pi_lb: [[-inf -inf -inf -inf]]
pi_ub: [[inf inf inf inf]]
Solving with one core...
Solving the problem ...

Nonlinear Coefficient Initial Values:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +4.26E+00              +6.90E-01              -1.96E+00              +1.18E-01      
=====================================================================================================================

Nonlinear Coefficient Lower Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           -INF                   -INF                   -INF                   -INF         
=====================================================================================================================

Nonlinear Coefficient Upper Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           +INF                   +INF                   +INF                   +INF         
=====================================================================================================================

The model may be under-identified. The total number of unfixed parameters is 11, which is more than the total number of moments, 10. Consider checking whether instruments were properly specified when initializing the problem, and whether parameters were properly configured when solving the problem.
Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 1     00:00:00         0             1           142          142         0     +1.91E-02               +1.06E-01  +4.26E+00, +6.90E-01, -1.96E+00, +1.18E-01
 1     00:00:00         1             2           134          134         0     +9.08E-03   +9.97E-03   +5.25E-02  +4.25E+00, +6.59E-01, -2.06E+00, +1.25E-02
 1     00:00:00         2             3           137          137         0     +6.40E-03   +2.68E-03   +3.64E-02  +4.25E+00, +6.33E-01, -2.08E+00, +4.45E-02
 1     00:00:00         3             4           136          136         0     +2.26E-03   +4.14E-03   +2.61E-02  +4.25E+00, +5.53E-01, -2.18E+00, +9.39E-02
 1     00:00:00         4             5           136          136         0     +1.43E-03   +8.35E-04   +1.05E-02  +4.24E+00, +5.27E-01, -2.23E+00, +9.53E-02
 1     00:00:00         5             6           135          135         0     +1.28E-03   +1.53E-04   +8.00E-03  +4.24E+00, +5.36E-01, -2.24E+00, +9.24E-02
 1     00:00:00         6             7           136          136         0     +9.51E-04   +3.24E-04   +1.54E-02  +4.24E+00, +5.62E-01, -2.27E+00, +9.75E-02
 1     00:00:00         7             8           138          138         0     +6.48E-04   +3.03E-04   +1.56E-02  +4.24E+00, +5.93E-01, -2.31E+00, +1.16E-01
 1     00:00:00         8             9           137          137         0     +5.72E-04   +7.66E-05   +6.78E-03  +4.23E+00, +5.93E-01, -2.31E+00, +1.23E-01
 1     00:00:00         9            10           140          140         0     +5.00E-04   +7.14E-05   +6.57E-04  +4.23E+00, +6.16E-01, -2.33E+00, +1.39E-01
 1     00:00:00         10           11           139          139         0     +4.99E-04   +1.74E-06   +5.34E-04  +4.23E+00, +6.13E-01, -2.34E+00, +1.39E-01
 1     00:00:00         11           12           140          140         0     +4.98E-04   +2.48E-07   +5.34E-04  +4.23E+00, +6.13E-01, -2.34E+00, +1.39E-01
 1     00:00:00         12           13           140          140         0     +4.93E-04   +4.95E-06   +1.93E-03  +4.22E+00, +6.14E-01, -2.34E+00, +1.38E-01
 1     00:00:00         13           14           139          139         0     +4.92E-04   +9.67E-07   +1.22E-03  +4.22E+00, +6.14E-01, -2.34E+00, +1.39E-01
 1     00:00:00         14           15           140          140         0     +4.72E-04   +2.03E-05   +5.37E-04  +4.18E+00, +6.14E-01, -2.33E+00, +1.39E-01
 1     00:00:00         15           16           142          142         0     +1.74E-04   +2.98E-04   +1.41E-02  +3.38E+00, +6.12E-01, -2.29E+00, +1.35E-01
 1     00:00:00         16           17           138          138         0     +1.19E-04   +5.54E-05   +7.86E-03  +3.37E+00, +6.13E-01, -2.29E+00, +1.31E-01
 1     00:00:00         17           18           140          140         0     +9.17E-05   +2.70E-05   +9.02E-04  +3.37E+00, +6.13E-01, -2.29E+00, +1.25E-01
 1     00:00:00         18           19           138          138         0     +2.64E-04               +2.88E-03  +2.35E+00, +6.08E-01, -2.24E+00, +1.09E-01
 1     00:00:00         19           20           140          140         0     +1.77E-05   +7.41E-05   +4.75E-04  +3.11E+00, +6.09E-01, -2.28E+00, +1.20E-01
 1     00:00:00         20           21           140          140         0     +2.63E-06   +1.50E-05   +1.78E-04  +2.99E+00, +6.08E-01, -2.27E+00, +1.18E-01
 1     00:00:00         21           22           140          140         0     +8.01E-08   +2.55E-06   +4.07E-05  +2.91E+00, +6.08E-01, -2.27E+00, +1.17E-01
 1     00:00:00         22           23           140          140         0     +2.65E-10   +7.98E-08   +1.38E-06  +2.93E+00, +6.08E-01, -2.27E+00, +1.17E-01
 1     00:00:00         23           24           140          140         0     +6.78E-14   +2.65E-10   +7.58E-08  +2.93E+00, +6.08E-01, -2.27E+00, +1.17E-01
 1     00:00:00         24           25           140          140         0     +4.43E-14   +2.34E-14   +1.64E-08  +2.93E+00, +6.08E-01, -2.27E+00, +1.17E-01
 1     00:00:00         25           26           140          140         0     +6.70E-18   +4.43E-14   +8.86E-10  +2.93E+00, +6.08E-01, -2.27E+00, +1.17E-01
 1     00:00:00         26           27           139          139         0     +5.96E-19   +6.10E-18   +3.51E-11  +2.93E+00, +6.08E-01, -2.27E+00, +1.17E-01

Optimization completed after 00:00:01.
Computing the Hessian and and updating the weighting matrix ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +2.84E+17. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
=====================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number
----  ---------  ---------  --------------  --------------  -------  ----------------
 1    +5.96E-19  +3.51E-11    +1.11E-03       +1.42E+00        0        +1.26E+05    
=====================================================================================

Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 2     00:00:00         0             1           47           47          0     +5.88E+00               +1.89E+12  +2.93E+00, +6.08E-01, -2.27E+00, +1.17E-01
 2     00:00:00         1             2           107          107         0     +3.44E+18               +1.12E+19  +2.93E+00, +7.01E-01, -1.27E+00, +1.15E-01
 2     00:00:00         2             3           66           66          0     +4.60E+05               +2.29E+12  +2.93E+00, +6.08E-01, -2.27E+00, +1.17E-01
 2     00:00:00         3             4           66           66          0     +4.60E+05               +2.28E+12  +2.93E+00, +6.08E-01, -2.27E+00, +1.17E-01
 2     00:00:00         4             5           56           56          0     +7.27E+01               +1.83E+12  +2.93E+00, +6.08E-01, -2.27E+00, +1.17E-01
 2     00:00:00         5             6           66           66          0     +1.14E+06               +5.12E+12  +2.93E+00, +6.08E-01, -2.27E+00, +1.17E-01
 2     00:00:00         6             7           70           70          0     +1.31E+06               +1.89E+12  +2.93E+00, +6.08E-01, -2.27E+00, +1.17E-01
 2     00:00:00         7             8           66           66          0     +8.01E+05               +2.86E+12  +2.93E+00, +6.08E-01, -2.27E+00, +1.17E-01
 2     00:00:00         8             9           66           66          0     +3.02E+05               +2.13E+12  +2.93E+00, +6.08E-01, -2.27E+00, +1.17E-01
 2     00:00:00         9            10           66           66          0     +1.35E+05               +1.65E+12  +2.93E+00, +6.08E-01, -2.27E+00, +1.17E-01
 2     00:00:00         10           11           60           60          0     +5.77E+04               +1.46E+12  +2.93E+00, +6.08E-01, -2.27E+00, +1.17E-01
 2     00:00:00         11           12           60           60          0     +1.45E+04               +1.43E+12  +2.93E+00, +6.08E-01, -2.27E+00, +1.17E-01
 2     00:00:00         12           13           59           59          0     +3.66E+03               +1.65E+12  +2.93E+00, +6.08E-01, -2.27E+00, +1.17E-01
 2     00:00:00         13           14           54           54          0     +9.34E+02               +1.77E+12  +2.93E+00, +6.08E-01, -2.27E+00, +1.17E-01

Optimization completed after 00:00:00.
Computing the Hessian and estimating standard errors ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +6.66E+17. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
========================================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix  Covariance Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number  Condition Number 
----  ---------  ---------  --------------  --------------  -------  ----------------  -----------------
 2    +5.88E+00  +1.89E+12    -1.25E+17       +4.66E+19        0        +9.26E+17          +2.54E+20    
========================================================================================================

Cumulative Statistics:
===========================================================================
Computation  Optimizer  Optimization   Objective   Fixed Point  Contraction
   Time      Converged   Iterations   Evaluations  Iterations   Evaluations
-----------  ---------  ------------  -----------  -----------  -----------
 00:00:02       Yes          41           43          4841         4841    
===========================================================================

Nonlinear Coefficient Estimates (Robust SEs in Parentheses):
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +2.93E+00              +6.08E-01              -2.27E+00              +1.17E-01      
                   |            (+6.05E-09)            (+6.86E-10)            (+6.44E-10)            (+4.75E-10)     
=====================================================================================================================

Beta Estimates (Robust SEs in Parentheses):
===============================================================================================
     1         prices     hpi_quantile1  hpi_quantile2  hpi_quantile3       X            Y     
-----------  -----------  -------------  -------------  -------------  -----------  -----------
 +3.32E+00    -9.11E-13     -4.20E+00      -2.43E+00      +4.61E+00     -3.32E+00    -2.66E+00 
(+1.44E-09)  (+1.67E-22)   (+2.17E-09)    (+1.56E-09)    (+2.02E-09)   (+3.79E-09)  (+3.60E-09)
===============================================================================================
Computing delta ...
Finished after 00:00:00.

Mean delta: 1.4965874248056346
pi labels: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
ii=0, vv=logdistXhpi_quantile1
logdistXhpi_quantile1 is a distance term, omitting from ABD and adding to coefficients instead
ii=1, vv=logdistXhpi_quantile2
logdistXhpi_quantile2 is a distance term, omitting from ABD and adding to coefficients instead
ii=2, vv=logdistXhpi_quantile3
logdistXhpi_quantile3 is a distance term, omitting from ABD and adding to coefficients instead
ii=3, vv=logdistXhpi_quantile4
logdistXhpi_quantile4 is a distance term, omitting from ABD and adding to coefficients instead

Distance coefficients: [2.92604, 0.60797, -2.26894, 0.11673]

Computed abepsilon in: 0.011 seconds.
Assigning individuals...
time3 - time2: 0.378
time4 - time3: 2.243
Number of full locations: 15  out of  18
Offers:
% Rank 0 offers: 45.04894
% Rank 1 offers: 8.19489
% Rank 2 offers: 4.12383
% Rank 3 offers: 2.33495
% Rank 4 offers: 40.29739
% Offered any: 100.0
Mean offer distance: 1.61984
Quantiles of offered distances:
0.0 quantile: -2.65569
0.1 quantile: 0.36673
0.2 quantile: 0.78268
0.3 quantile: 1.10392
0.4 quantile: 1.40684
0.5 quantile: 1.91187
0.6 quantile: 2.13881
0.7 quantile: 2.24640
0.8 quantile: 2.38500
0.9 quantile: 2.60772
1.0 quantile: 3.19221
Assignments:
% Rank 0 assignments: 30.89696
% Rank 1 assignments: 7.05918
% Rank 2 assignments: 3.71953
% Rank 3 assignments: 2.15905
% Rank 4 assignments: 36.05280
% Assigned: 79.88753
Mean assignment distance: 1.75792
Quantiles of assignment distances:
0.0 quantile: -2.05992
0.1 quantile: 0.62439
0.2 quantile: 0.99402
0.3 quantile: 1.28216
0.4 quantile: 1.63066
0.5 quantile: 2.06615
0.6 quantile: 2.17481
0.7 quantile: 2.27080
0.8 quantile: 2.39936
0.9 quantile: 2.60615
1.0 quantile: 3.19221
Violations:
Max violation: 35054
Number of locations with violations: 15
Number of individuals with violations: 150302
Mean violation (conditional on violation): 10020.133333333333
Median violation (conditional on violation): 7292.0
Number of markets with wasserstein distance > 0.001: 10
Mean wasserstein distance for markets with wasserstein distance > 0.001: 0.07021258216356818
Mean wasserstein distance: 0.07021258216356818
Max wasserstein distance: 0.171280230849429
Index of max wasserstein distance: 7
Iteration 4 complete.


Number of agents: 11445

Iteration 5:

agent_loc_data:
     blkid  locid   logdist       dist  market_ids  hpi_quantile  hpi_quantile1  hpi_quantile2  hpi_quantile3  hpi_quantile4  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4  nodes  population   weights
0   132759      0  0.737546   2.090799     90059.0             1              1              0              0              0               0.737546                    0.0                    0.0                    0.0      0       40488  0.000148
1   132759      4  1.309970   3.706062     90059.0             1              1              0              0              0               1.309970                    0.0                    0.0                    0.0      0       40488  0.000025
4   132759     16  2.388723  10.899569     90059.0             1              1              0              0              0               2.388723                    0.0                    0.0                    0.0      0       40488  0.000222
5   132760      0  0.817771   2.265445     90059.0             1              1              0              0              0               0.817771                    0.0                    0.0                    0.0      0       40488  0.000988
6   132760      4  1.368392   3.929026     90059.0             1              1              0              0              0               1.368392                    0.0                    0.0                    0.0      0       40488  0.000173
7   132760      7  1.909226   6.747865     90059.0             1              1              0              0              0               1.909226                    0.0                    0.0                    0.0      0       40488  0.000049
8   132760      1  2.210262   9.118109     90059.0             1              1              0              0              0               2.210262                    0.0                    0.0                    0.0      0       40488  0.000025
9   132760     16  2.407625  11.107545     90059.0             1              1              0              0              0               2.407625                    0.0                    0.0                    0.0      0       40488  0.000864
10  132761      0  0.835924   2.306944     90059.0             1              1              0              0              0               0.835924                    0.0                    0.0                    0.0      0       40488  0.000074
14  132761      9  2.405422  11.083104     90059.0             1              1              0              0              0               2.405422                    0.0                    0.0                    0.0      0       40488  0.000123
15  132763      0  0.685177   1.984123     90059.0             1              1              0              0              0               0.685177                    0.0                    0.0                    0.0      0       40488  0.000123
16  132763      4  1.317212   3.733000     90059.0             1              1              0              0              0               1.317212                    0.0                    0.0                    0.0      0       40488  0.000049
19  132763     16  2.382397  10.830829     90059.0             1              1              0              0              0               2.382397                    0.0                    0.0                    0.0      0       40488  0.000123
20  132772      0  0.959576   2.610589     90059.0             1              1              0              0              0               0.959576                    0.0                    0.0                    0.0      0       40488  0.001704
21  132772      4  1.464425   4.325055     90059.0             1              1              0              0              0               1.464425                    0.0                    0.0                    0.0      0       40488  0.000148
22  132772      7  1.847489   6.343871     90059.0             1              1              0              0              0               1.847489                    0.0                    0.0                    0.0      0       40488  0.000074
23  132772      1  2.250480   9.492289     90059.0             1              1              0              0              0               2.250480                    0.0                    0.0                    0.0      0       40488  0.000025
24  132772      9  2.387146  10.882389     90059.0             1              1              0              0              0               2.387146                    0.0                    0.0                    0.0      0       40488  0.001383
25  132774      0  1.021268   2.776713     90059.0             1              1              0              0              0               1.021268                    0.0                    0.0                    0.0      0       40488  0.001037
26  132774      4  1.507882   4.517154     90059.0             1              1              0              0              0               1.507882                    0.0                    0.0                    0.0      0       40488  0.000148
27  132774      7  1.816779   6.152013     90059.0             1              1              0              0              0               1.816779                    0.0                    0.0                    0.0      0       40488  0.000049
28  132774      1  2.269645   9.675964     90059.0             1              1              0              0              0               2.269645                    0.0                    0.0                    0.0      0       40488  0.000049
29  132774      9  2.373282  10.732561     90059.0             1              1              0              0              0               2.373282                    0.0                    0.0                    0.0      0       40488  0.001210
30  132775      0  0.943832   2.569810     90059.0             1              1              0              0              0               0.943832                    0.0                    0.0                    0.0      0       40488  0.002248
31  132775      4  1.464439   4.325118     90059.0             1              1              0              0              0               1.464439                    0.0                    0.0                    0.0      0       40488  0.000296
32  132775      7  1.850678   6.364134     90059.0             1              1              0              0              0               1.850678                    0.0                    0.0                    0.0      0       40488  0.000148
33  132775      1  2.251602   9.502947     90059.0             1              1              0              0              0               2.251602                    0.0                    0.0                    0.0      0       40488  0.000025
34  132775      9  2.384357  10.852086     90059.0             1              1              0              0              0               2.384357                    0.0                    0.0                    0.0      0       40488  0.001754
35  132776      0  0.887535   2.429133     90059.0             1              1              0              0              0               0.887535                    0.0                    0.0                    0.0      0       40488  0.001161
36  132776      4  1.415862   4.120036     90059.0             1              1              0              0              0               1.415862                    0.0                    0.0                    0.0      0       40488  0.000272
37  132776      7  1.879925   6.553017     90059.0             1              1              0              0              0               1.879925                    0.0                    0.0                    0.0      0       40488  0.000099
38  132776      1  2.229868   9.298637     90059.0             1              1              0              0              0               2.229868                    0.0                    0.0                    0.0      0       40488  0.000025
39  132776      9  2.401359  11.038164     90059.0             1              1              0              0              0               2.401359                    0.0                    0.0                    0.0      0       40488  0.001210
40  132792      0  0.788905   2.200984     90059.0             1              1              0              0              0               0.788905                    0.0                    0.0                    0.0      0       40488  0.003705
41  132792      4  1.462907   4.318494     90059.0             1              1              0              0              0               1.462907                    0.0                    0.0                    0.0      0       40488  0.000420
42  132792      7  1.889494   6.616020     90059.0             1              1              0              0              0               1.889494                    0.0                    0.0                    0.0      0       40488  0.000198
43  132792      1  2.258765   9.571262     90059.0             1              1              0              0              0               2.258765                    0.0                    0.0                    0.0      0       40488  0.000049
44  132792      9  2.363775  10.631010     90059.0             1              1              0              0              0               2.363775                    0.0                    0.0                    0.0      0       40488  0.003359
45  132793      0  0.782841   2.187679     90059.0             1              1              0              0              0               0.782841                    0.0                    0.0                    0.0      0       40488  0.003013
46  132793      4  1.473780   4.365707     90059.0             1              1              0              0              0               1.473780                    0.0                    0.0                    0.0      0       40488  0.000494
47  132793      7  1.890205   6.620723     90059.0             1              1              0              0              0               1.890205                    0.0                    0.0                    0.0      0       40488  0.000074
49  132793      9  2.357149  10.560804     90059.0             1              1              0              0              0               2.357149                    0.0                    0.0                    0.0      0       40488  0.002840
50  132794      0  0.887200   2.428321     90059.0             1              1              0              0              0               0.887200                    0.0                    0.0                    0.0      0       40488  0.001260
51  132794      4  1.526687   4.602902     90059.0             1              1              0              0              0               1.526687                    0.0                    0.0                    0.0      0       40488  0.000099
52  132794      7  1.852737   6.377253     90059.0             1              1              0              0              0               1.852737                    0.0                    0.0                    0.0      0       40488  0.000025
54  132794      9  2.338092  10.361449     90059.0             1              1              0              0              0               2.338092                    0.0                    0.0                    0.0      0       40488  0.000939
55  132795      0  0.939920   2.559777     90059.0             1              1              0              0              0               0.939920                    0.0                    0.0                    0.0      0       40488  0.000395
56  132795      4  1.556965   4.744402     90059.0             1              1              0              0              0               1.556965                    0.0                    0.0                    0.0      0       40488  0.000025
59  132795      9  2.325947  10.236375     90059.0             1              1              0              0              0               2.325947                    0.0                    0.0                    0.0      0       40488  0.000198
60  132796      0  0.770565   2.160988     90059.0             1              1              0              0              0               0.770565                    0.0                    0.0                    0.0      0       40488  0.003878
pi_init:
[[ 2.92603786  0.6079651  -2.26893667  0.11673472]]
Weight distribution by market:
count    10.0
mean      1.0
std       0.0
min       1.0
25%       1.0
50%       1.0
75%       1.0
max       1.0
Name: weights, dtype: float64
Estimating demand...
agent_vars: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
iv_df:
             demand_instruments0  demand_instruments1  demand_instruments2  demand_instruments3
market_ids                                                                                    
90059.0                1.278676             0.000000                  0.0             0.000000
90201.0                1.363608             0.000000                  0.0             0.000000
90277.0                0.000000             0.000000                  0.0             1.943894
90290.0                0.000000             0.000000                  0.0             2.840099
90302.0                0.000000             1.627894                  0.0             0.000000
Initializing the problem ...
Initialized the problem after 00:00:00.

Dimensions:
===========================================
 T    N    F     I     K1    K2    D    MD 
---  ---  ---  -----  ----  ----  ---  ----
10   10    1   11445   7     1     4    10 
===========================================

Formulations:
==================================================================================================================================================
       Column Indices:                   0                      1                      2                      3                  4         5    6 
-----------------------------  ---------------------  ---------------------  ---------------------  ---------------------  -------------  ---  ---
 X1: Linear Characteristics              1                   prices              hpi_quantile1          hpi_quantile2      hpi_quantile3   X    Y 
X2: Nonlinear Characteristics            1                                                                                                        
       d: Demographics         logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4                         
==================================================================================================================================================
pi_init: [[ 2.92603786  0.6079651  -2.26893667  0.11673472]]
pi_lb: [[-inf -inf -inf -inf]]
pi_ub: [[inf inf inf inf]]
Solving with one core...
Solving the problem ...

Nonlinear Coefficient Initial Values:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +2.93E+00              +6.08E-01              -2.27E+00              +1.17E-01      
=====================================================================================================================

Nonlinear Coefficient Lower Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           -INF                   -INF                   -INF                   -INF         
=====================================================================================================================

Nonlinear Coefficient Upper Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           +INF                   +INF                   +INF                   +INF         
=====================================================================================================================

The model may be under-identified. The total number of unfixed parameters is 11, which is more than the total number of moments, 10. Consider checking whether instruments were properly specified when initializing the problem, and whether parameters were properly configured when solving the problem.
Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 1     00:00:00         0             1           141          141         0     +1.18E-02               +4.66E-02  +2.93E+00, +6.08E-01, -2.27E+00, +1.17E-01
 1     00:00:00         1             2           140          140         0     +8.72E-03   +3.13E-03   +3.71E-02  +2.93E+00, +6.41E-01, -2.22E+00, +1.03E-01
 1     00:00:00         2             3           142          142         0     +3.08E-03   +5.64E-03   +3.23E-03  +2.95E+00, +7.77E-01, -2.03E+00, +3.87E-02
 1     00:00:00         3             4           142          142         0     +3.06E-03   +1.03E-05   +9.14E-03  +2.96E+00, +7.62E-01, -2.03E+00, +4.57E-02
 1     00:00:00         4             5           143          143         0     +3.02E-03   +4.05E-05   +1.74E-03  +2.96E+00, +7.62E-01, -2.03E+00, +3.71E-02
 1     00:00:00         5             6           143          143         0     +2.99E-03   +3.60E-05   +1.71E-03  +2.98E+00, +7.40E-01, -2.02E+00, +3.35E-02
 1     00:00:00         6             7           142          142         0     +2.96E-03   +3.25E-05   +1.60E-03  +3.00E+00, +7.36E-01, -2.01E+00, +2.89E-02
 1     00:00:00         7             8           141          141         0     +2.91E-03   +5.03E-05   +2.17E-03  +3.04E+00, +7.32E-01, -2.00E+00, +2.49E-02
 1     00:00:00         8             9           141          141         0     +2.75E-03   +1.55E-04   +4.79E-03  +3.20E+00, +7.26E-01, -1.99E+00, +1.89E-02
 1     00:00:00         9            10           141          141         0     +2.68E-03   +7.50E-05   +3.95E-03  +3.22E+00, +7.42E-01, -2.00E+00, +2.49E-02
 1     00:00:00         10           11           143          143         0     +2.16E-03   +5.14E-04   +3.13E-03  +3.73E+00, +7.71E-01, -2.04E+00, +3.98E-02
 1     00:00:00         11           12           141          141         0     +2.12E-03   +4.08E-05   +8.32E-04  +3.73E+00, +7.58E-01, -2.05E+00, +4.26E-02
 1     00:00:00         12           13           140          140         0     +1.97E-03   +1.49E-04   +1.21E-03  +4.19E+00, +7.59E-01, -2.06E+00, +4.77E-02
 1     00:00:00         13           14           139          139         0     +1.97E-03   +5.91E-06   +1.26E-04  +4.19E+00, +7.54E-01, -2.05E+00, +4.44E-02
 1     00:00:00         14           15           139          139         0     +1.96E-03   +1.36E-06   +2.68E-05  +4.24E+00, +7.53E-01, -2.05E+00, +4.40E-02
 1     00:00:00         15           16           139          139         0     +1.96E-03   +2.94E-09   +4.66E-06  +4.24E+00, +7.53E-01, -2.05E+00, +4.40E-02
 1     00:00:00         16           17           140          140         0     +1.96E-03   +9.71E-09   +1.67E-07  +4.24E+00, +7.53E-01, -2.05E+00, +4.40E-02
 1     00:00:00         17           18           140          140         0     +1.96E-03   +1.69E-13   +3.53E-08  +4.24E+00, +7.53E-01, -2.05E+00, +4.40E-02
 1     00:00:00         18           19           139          139         0     +1.96E-03   +5.54E-13   +1.98E-10  +4.24E+00, +7.53E-01, -2.05E+00, +4.40E-02
 1     00:00:00         19           20           140          140         0     +1.96E-03               +1.51E-11  +4.24E+00, +7.53E-01, -2.05E+00, +4.40E-02
 1     00:00:00         20           21           140          140         0     +1.96E-03   +1.96E-16   +1.48E-11  +4.24E+00, +7.53E-01, -2.05E+00, +4.40E-02

Optimization completed after 00:00:01.
Computing the Hessian and and updating the weighting matrix ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +2.87E+19. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
=====================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number
----  ---------  ---------  --------------  --------------  -------  ----------------
 1    +1.96E-03  +1.48E-11    +1.14E-03       +1.21E+00        0        +1.53E+05    
=====================================================================================

Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 2     00:00:00         0             1           47           47          0     +6.41E+00               +9.27E+01  +4.24E+00, +7.53E-01, -2.05E+00, +4.40E-02
 2     00:00:00         1             2           130          130         0     +8.98E+02               +1.75E+03  +4.24E+00, +5.89E-02, -1.64E+00, +6.37E-01
 2     00:00:00         2             3           98           98          0     +6.28E-01   +5.79E+00   +4.10E+01  +4.24E+00, +7.11E-01, -1.99E+00, +9.51E-02
 2     00:00:00         3             4           98           98          0     +6.70E-02   +5.60E-01   +8.26E+00  +4.24E+00, +7.22E-01, -1.98E+00, +1.05E-01
 2     00:00:00         4             5           98           98          0     +1.26E-04   +6.69E-02   +5.77E-01  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         5             6           98           98          0     +1.15E-08   +1.26E-04   +6.49E-03  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         6             7           98           98          0     +2.39E-10   +1.12E-08   +4.81E-04  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         7             8           98           98          0     +6.84E-11   +1.71E-10   +2.53E-04  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         8             9           98           98          0     +3.54E-11   +3.29E-11   +2.56E-04  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         9            10           98           98          0     +7.49E-11               +6.37E-04  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         10           11           98           98          0     +4.96E-10               +9.96E-04  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         11           12           101          101         0     +2.61E-09               +1.75E-03  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         12           13           102          102         0     +1.04E-08               +3.29E-03  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         13           14           101          101         0     +2.98E-10               +1.02E-03  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         14           15           102          102         0     +9.06E-10               +8.79E-04  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         15           16           102          102         0     +9.62E-10               +9.14E-04  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         16           17           100          100         0     +1.30E-09               +1.05E-03  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         17           18           102          102         0     +2.63E-10               +4.61E-04  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         18           19           98           98          0     +2.01E-10               +4.86E-04  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         19           20           102          102         0     +1.25E-10               +5.23E-04  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         20           21           98           98          0     +7.96E-11               +5.12E-04  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         21           22           98           98          0     +4.95E-11               +3.34E-04  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         22           23           98           98          0     +3.71E-11               +1.96E-04  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         23           24           98           98          0     +3.50E-11   +4.80E-13   +2.26E-04  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         24           25           98           98          0     +3.75E-11               +2.14E-04  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         25           26           98           98          0     +3.62E-11               +2.22E-04  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 2     00:00:00         26           27           98           98          0     +3.56E-11               +2.24E-04  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01

Optimization completed after 00:00:01.
Computing the Hessian and estimating standard errors ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +2.37E+20. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
========================================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix  Covariance Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number  Condition Number 
----  ---------  ---------  --------------  --------------  -------  ----------------  -----------------
 2    +3.50E-11  +2.26E-04    -4.95E+00       +3.83E+03        0        +1.44E+30          +5.37E+20    
========================================================================================================

Cumulative Statistics:
===========================================================================
Computation  Optimizer  Optimization   Objective   Fixed Point  Contraction
   Time      Converged   Iterations   Evaluations  Iterations   Evaluations
-----------  ---------  ------------  -----------  -----------  -----------
 00:00:02       Yes          48           50          5849         5849    
===========================================================================

Nonlinear Coefficient Estimates (Robust SEs in Parentheses):
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +4.24E+00              +7.20E-01              -1.97E+00              +1.12E-01      
                   |            (+8.73E-02)            (+6.53E-02)            (+2.93E-02)            (+5.42E-02)     
=====================================================================================================================

Beta Estimates (Robust SEs in Parentheses):
===============================================================================================
     1         prices     hpi_quantile1  hpi_quantile2  hpi_quantile3       X            Y     
-----------  -----------  -------------  -------------  -------------  -----------  -----------
 +2.63E+00    -2.27E-12     -5.19E+00      -2.04E+00      +4.31E+00     -6.21E+00    -1.35E+00 
(+1.89E-01)  (+8.12E-16)   (+1.23E-01)    (+2.24E-01)    (+1.73E-01)   (+4.40E-02)  (+1.14E-01)
===============================================================================================
Computing delta ...
Finished after 00:00:00.

Mean delta: 0.9418762845076651
pi labels: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
ii=0, vv=logdistXhpi_quantile1
logdistXhpi_quantile1 is a distance term, omitting from ABD and adding to coefficients instead
ii=1, vv=logdistXhpi_quantile2
logdistXhpi_quantile2 is a distance term, omitting from ABD and adding to coefficients instead
ii=2, vv=logdistXhpi_quantile3
logdistXhpi_quantile3 is a distance term, omitting from ABD and adding to coefficients instead
ii=3, vv=logdistXhpi_quantile4
logdistXhpi_quantile4 is a distance term, omitting from ABD and adding to coefficients instead

Distance coefficients: [4.24092, 0.71997, -1.97155, 0.11212]

Computed abepsilon in: 0.011 seconds.
Assigning individuals...
time3 - time2: 0.344
time4 - time3: 2.11
Number of full locations: 15  out of  18
Offers:
% Rank 0 offers: 50.80912
% Rank 1 offers: 9.23688
% Rank 2 offers: 4.21755
% Rank 3 offers: 2.85397
% Rank 4 offers: 32.88248
% Offered any: 100.0
Mean offer distance: 1.51272
Quantiles of offered distances:
0.0 quantile: -2.65569
0.1 quantile: 0.27588
0.2 quantile: 0.65912
0.3 quantile: 0.97460
0.4 quantile: 1.24182
0.5 quantile: 1.53545
0.6 quantile: 2.03704
0.7 quantile: 2.20256
0.8 quantile: 2.35252
0.9 quantile: 2.59901
1.0 quantile: 3.19221
Assignments:
% Rank 0 assignments: 29.48560
% Rank 1 assignments: 7.59002
% Rank 2 assignments: 3.73345
% Rank 3 assignments: 2.59564
% Rank 4 assignments: 28.37851
% Assigned: 71.78321
Mean assignment distance: 1.73502
Quantiles of assignment distances:
0.0 quantile: -2.05992
0.1 quantile: 0.67063
0.2 quantile: 1.00511
0.3 quantile: 1.25750
0.4 quantile: 1.53419
0.5 quantile: 1.98320
0.6 quantile: 2.14746
0.7 quantile: 2.25644
0.8 quantile: 2.39879
0.9 quantile: 2.60760
1.0 quantile: 3.19221
Violations:
Max violation: 25607
Number of locations with violations: 15
Number of individuals with violations: 120879
Mean violation (conditional on violation): 8058.6
Median violation (conditional on violation): 6788.0
Number of markets with wasserstein distance > 0.001: 9
Mean wasserstein distance for markets with wasserstein distance > 0.001: 0.08014500623827459
Mean wasserstein distance: 0.0722297891788342
Max wasserstein distance: 0.14777598826293348
Index of max wasserstein distance: 9
Iteration 5 complete.


Number of agents: 11516

Iteration 6:

agent_loc_data:
     blkid  locid   logdist       dist  market_ids  hpi_quantile  hpi_quantile1  hpi_quantile2  hpi_quantile3  hpi_quantile4  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4  nodes  population   weights
0   132759      0  0.737546   2.090799     90059.0             1              1              0              0              0               0.737546                    0.0                    0.0                    0.0      0       40488  0.000247
1   132759      4  1.309970   3.706062     90059.0             1              1              0              0              0               1.309970                    0.0                    0.0                    0.0      0       40488  0.000049
4   132759     16  2.388723  10.899569     90059.0             1              1              0              0              0               2.388723                    0.0                    0.0                    0.0      0       40488  0.000099
5   132760      0  0.817771   2.265445     90059.0             1              1              0              0              0               0.817771                    0.0                    0.0                    0.0      0       40488  0.001161
6   132760      4  1.368392   3.929026     90059.0             1              1              0              0              0               1.368392                    0.0                    0.0                    0.0      0       40488  0.000222
7   132760      7  1.909226   6.747865     90059.0             1              1              0              0              0               1.909226                    0.0                    0.0                    0.0      0       40488  0.000025
8   132760      1  2.210262   9.118109     90059.0             1              1              0              0              0               2.210262                    0.0                    0.0                    0.0      0       40488  0.000049
9   132760     16  2.407625  11.107545     90059.0             1              1              0              0              0               2.407625                    0.0                    0.0                    0.0      0       40488  0.000642
10  132761      0  0.835924   2.306944     90059.0             1              1              0              0              0               0.835924                    0.0                    0.0                    0.0      0       40488  0.000123
14  132761      9  2.405422  11.083104     90059.0             1              1              0              0              0               2.405422                    0.0                    0.0                    0.0      0       40488  0.000074
15  132763      0  0.685177   1.984123     90059.0             1              1              0              0              0               0.685177                    0.0                    0.0                    0.0      0       40488  0.000173
19  132763     16  2.382397  10.830829     90059.0             1              1              0              0              0               2.382397                    0.0                    0.0                    0.0      0       40488  0.000123
20  132772      0  0.959576   2.610589     90059.0             1              1              0              0              0               0.959576                    0.0                    0.0                    0.0      0       40488  0.001877
21  132772      4  1.464425   4.325055     90059.0             1              1              0              0              0               1.464425                    0.0                    0.0                    0.0      0       40488  0.000420
22  132772      7  1.847489   6.343871     90059.0             1              1              0              0              0               1.847489                    0.0                    0.0                    0.0      0       40488  0.000099
24  132772      9  2.387146  10.882389     90059.0             1              1              0              0              0               2.387146                    0.0                    0.0                    0.0      0       40488  0.000939
25  132774      0  1.021268   2.776713     90059.0             1              1              0              0              0               1.021268                    0.0                    0.0                    0.0      0       40488  0.001284
26  132774      4  1.507882   4.517154     90059.0             1              1              0              0              0               1.507882                    0.0                    0.0                    0.0      0       40488  0.000247
27  132774      7  1.816779   6.152013     90059.0             1              1              0              0              0               1.816779                    0.0                    0.0                    0.0      0       40488  0.000099
28  132774      1  2.269645   9.675964     90059.0             1              1              0              0              0               2.269645                    0.0                    0.0                    0.0      0       40488  0.000049
29  132774      9  2.373282  10.732561     90059.0             1              1              0              0              0               2.373282                    0.0                    0.0                    0.0      0       40488  0.000815
30  132775      0  0.943832   2.569810     90059.0             1              1              0              0              0               0.943832                    0.0                    0.0                    0.0      0       40488  0.002519
31  132775      4  1.464439   4.325118     90059.0             1              1              0              0              0               1.464439                    0.0                    0.0                    0.0      0       40488  0.000395
32  132775      7  1.850678   6.364134     90059.0             1              1              0              0              0               1.850678                    0.0                    0.0                    0.0      0       40488  0.000123
33  132775      1  2.251602   9.502947     90059.0             1              1              0              0              0               2.251602                    0.0                    0.0                    0.0      0       40488  0.000049
34  132775      9  2.384357  10.852086     90059.0             1              1              0              0              0               2.384357                    0.0                    0.0                    0.0      0       40488  0.001383
35  132776      0  0.887535   2.429133     90059.0             1              1              0              0              0               0.887535                    0.0                    0.0                    0.0      0       40488  0.001334
36  132776      4  1.415862   4.120036     90059.0             1              1              0              0              0               1.415862                    0.0                    0.0                    0.0      0       40488  0.000494
37  132776      7  1.879925   6.553017     90059.0             1              1              0              0              0               1.879925                    0.0                    0.0                    0.0      0       40488  0.000173
39  132776      9  2.401359  11.038164     90059.0             1              1              0              0              0               2.401359                    0.0                    0.0                    0.0      0       40488  0.000766
40  132792      0  0.788905   2.200984     90059.0             1              1              0              0              0               0.788905                    0.0                    0.0                    0.0      0       40488  0.004100
41  132792      4  1.462907   4.318494     90059.0             1              1              0              0              0               1.462907                    0.0                    0.0                    0.0      0       40488  0.000889
42  132792      7  1.889494   6.616020     90059.0             1              1              0              0              0               1.889494                    0.0                    0.0                    0.0      0       40488  0.000247
43  132792      1  2.258765   9.571262     90059.0             1              1              0              0              0               2.258765                    0.0                    0.0                    0.0      0       40488  0.000049
44  132792      9  2.363775  10.631010     90059.0             1              1              0              0              0               2.363775                    0.0                    0.0                    0.0      0       40488  0.002445
45  132793      0  0.782841   2.187679     90059.0             1              1              0              0              0               0.782841                    0.0                    0.0                    0.0      0       40488  0.003655
46  132793      4  1.473780   4.365707     90059.0             1              1              0              0              0               1.473780                    0.0                    0.0                    0.0      0       40488  0.000543
47  132793      7  1.890205   6.620723     90059.0             1              1              0              0              0               1.890205                    0.0                    0.0                    0.0      0       40488  0.000173
48  132793      1  2.264449   9.625818     90059.0             1              1              0              0              0               2.264449                    0.0                    0.0                    0.0      0       40488  0.000074
49  132793      9  2.357149  10.560804     90059.0             1              1              0              0              0               2.357149                    0.0                    0.0                    0.0      0       40488  0.001976
50  132794      0  0.887200   2.428321     90059.0             1              1              0              0              0               0.887200                    0.0                    0.0                    0.0      0       40488  0.001334
51  132794      4  1.526687   4.602902     90059.0             1              1              0              0              0               1.526687                    0.0                    0.0                    0.0      0       40488  0.000272
52  132794      7  1.852737   6.377253     90059.0             1              1              0              0              0               1.852737                    0.0                    0.0                    0.0      0       40488  0.000049
53  132794      1  2.287930   9.854524     90059.0             1              1              0              0              0               2.287930                    0.0                    0.0                    0.0      0       40488  0.000074
54  132794      9  2.338092  10.361449     90059.0             1              1              0              0              0               2.338092                    0.0                    0.0                    0.0      0       40488  0.000593
55  132795      0  0.939920   2.559777     90059.0             1              1              0              0              0               0.939920                    0.0                    0.0                    0.0      0       40488  0.000420
56  132795      4  1.556965   4.744402     90059.0             1              1              0              0              0               1.556965                    0.0                    0.0                    0.0      0       40488  0.000049
59  132795      9  2.325947  10.236375     90059.0             1              1              0              0              0               2.325947                    0.0                    0.0                    0.0      0       40488  0.000148
60  132796      0  0.770565   2.160988     90059.0             1              1              0              0              0               0.770565                    0.0                    0.0                    0.0      0       40488  0.004347
61  132796      4  1.482172   4.402496     90059.0             1              1              0              0              0               1.482172                    0.0                    0.0                    0.0      0       40488  0.000667
pi_init:
[[ 4.24092431  0.71997227 -1.97154613  0.11211606]]
Weight distribution by market:
count    10.0
mean      1.0
std       0.0
min       1.0
25%       1.0
50%       1.0
75%       1.0
max       1.0
Name: weights, dtype: float64
Estimating demand...
agent_vars: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
iv_df:
             demand_instruments0  demand_instruments1  demand_instruments2  demand_instruments3
market_ids                                                                                    
90059.0                1.074276             0.000000                  0.0             0.000000
90201.0                1.176868             0.000000                  0.0             0.000000
90277.0                0.000000             0.000000                  0.0             1.908599
90290.0                0.000000             0.000000                  0.0             2.839204
90302.0                0.000000             1.609298                  0.0             0.000000
Initializing the problem ...
Initialized the problem after 00:00:00.

Dimensions:
===========================================
 T    N    F     I     K1    K2    D    MD 
---  ---  ---  -----  ----  ----  ---  ----
10   10    1   11516   7     1     4    10 
===========================================

Formulations:
==================================================================================================================================================
       Column Indices:                   0                      1                      2                      3                  4         5    6 
-----------------------------  ---------------------  ---------------------  ---------------------  ---------------------  -------------  ---  ---
 X1: Linear Characteristics              1                   prices              hpi_quantile1          hpi_quantile2      hpi_quantile3   X    Y 
X2: Nonlinear Characteristics            1                                                                                                        
       d: Demographics         logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4                         
==================================================================================================================================================
pi_init: [[ 4.24092431  0.71997227 -1.97154613  0.11211606]]
pi_lb: [[-inf -inf -inf -inf]]
pi_ub: [[inf inf inf inf]]
Solving with one core...
Solving the problem ...

Nonlinear Coefficient Initial Values:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +4.24E+00              +7.20E-01              -1.97E+00              +1.12E-01      
=====================================================================================================================

Nonlinear Coefficient Lower Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           -INF                   -INF                   -INF                   -INF         
=====================================================================================================================

Nonlinear Coefficient Upper Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           +INF                   +INF                   +INF                   +INF         
=====================================================================================================================

The model may be under-identified. The total number of unfixed parameters is 11, which is more than the total number of moments, 10. Consider checking whether instruments were properly specified when initializing the problem, and whether parameters were properly configured when solving the problem.
Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 1     00:00:00         0             1           142          142         0     +1.04E-02               +7.86E-02  +4.24E+00, +7.20E-01, -1.97E+00, +1.12E-01
 1     00:00:00         1             2           138          138         0     +4.63E-03   +5.74E-03   +3.77E-02  +4.24E+00, +6.94E-01, -2.04E+00, +3.36E-02
 1     00:00:00         2             3           137          137         0     +3.10E-03   +1.52E-03   +2.66E-02  +4.24E+00, +6.73E-01, -2.06E+00, +5.72E-02
 1     00:00:00         3             4           138          138         0     +6.70E-04   +2.43E-03   +1.70E-02  +4.24E+00, +6.06E-01, -2.13E+00, +9.20E-02
 1     00:00:00         4             5           135          135         0     +3.02E-04   +3.68E-04   +6.16E-03  +4.24E+00, +5.86E-01, -2.17E+00, +9.24E-02
 1     00:00:00         5             6           138          138         0     +2.53E-04   +4.92E-05   +4.33E-03  +4.24E+00, +5.91E-01, -2.18E+00, +9.07E-02
 1     00:00:00         6             7           137          137         0     +1.58E-04   +9.54E-05   +8.48E-03  +4.24E+00, +6.04E-01, -2.19E+00, +9.32E-02
 1     00:00:00         7             8           139          139         0     +6.03E-05   +9.73E-05   +9.06E-03  +4.24E+00, +6.22E-01, -2.22E+00, +1.03E-01
 1     00:00:00         8             9           138          138         0     +3.43E-05   +2.59E-05   +4.19E-03  +4.24E+00, +6.22E-01, -2.22E+00, +1.07E-01
 1     00:00:00         9            10           139          139         0     +6.40E-06   +2.79E-05   +4.76E-04  +4.24E+00, +6.38E-01, -2.23E+00, +1.17E-01
 1     00:00:00         10           11           140          140         0     +5.60E-06   +8.05E-07   +6.02E-05  +4.24E+00, +6.36E-01, -2.23E+00, +1.17E-01
 1     00:00:00         11           12           140          140         0     +5.56E-06   +3.71E-08   +2.95E-05  +4.24E+00, +6.36E-01, -2.23E+00, +1.18E-01
 1     00:00:00         12           13           140          140         0     +5.56E-06   +1.01E-09   +2.94E-05  +4.24E+00, +6.36E-01, -2.23E+00, +1.18E-01
 1     00:00:00         13           14           140          140         0     +5.56E-06   +1.78E-09   +2.93E-05  +4.24E+00, +6.36E-01, -2.23E+00, +1.18E-01
 1     00:00:00         14           15           140          140         0     +5.55E-06   +5.28E-09   +3.40E-05  +4.24E+00, +6.36E-01, -2.23E+00, +1.18E-01
 1     00:00:00         15           16           140          140         0     +5.54E-06   +1.36E-08   +6.86E-05  +4.23E+00, +6.36E-01, -2.23E+00, +1.18E-01
 1     00:00:00         16           17           141          141         0     +5.53E-06   +6.93E-09   +5.98E-05  +4.23E+00, +6.36E-01, -2.23E+00, +1.18E-01
 1     00:00:00         17           18           140          140         0     +5.39E-06   +1.38E-07   +7.22E-05  +4.23E+00, +6.37E-01, -2.23E+00, +1.18E-01
 1     00:00:00         18           19           140          140         0     +4.32E-06   +1.07E-06   +3.17E-04  +4.18E+00, +6.38E-01, -2.23E+00, +1.17E-01
 1     00:00:00         19           20           140          140         0     +4.12E-06   +1.97E-07   +2.08E-04  +4.18E+00, +6.37E-01, -2.23E+00, +1.17E-01
 1     00:00:00         20           21           140          140         0     +3.99E-06   +1.35E-07   +2.64E-05  +4.18E+00, +6.36E-01, -2.23E+00, +1.17E-01
 1     00:00:00         21           22           141          141         0     +9.97E-07   +2.99E-06   +1.24E-04  +4.04E+00, +6.36E-01, -2.23E+00, +1.16E-01
 1     00:00:00         22           23           140          140         0     +9.87E-07   +1.00E-08   +3.66E-05  +4.04E+00, +6.36E-01, -2.23E+00, +1.16E-01
 1     00:00:00         23           24           141          141         0     +4.78E-07   +5.10E-07   +1.12E-04  +3.85E+00, +6.36E-01, -2.22E+00, +1.15E-01
 1     00:00:00         24           25           140          140         0     +4.28E-07   +5.00E-08   +1.24E-05  +3.85E+00, +6.36E-01, -2.22E+00, +1.15E-01
 1     00:00:00         25           26           140          140         0     +1.20E-08   +4.16E-07   +1.26E-05  +3.93E+00, +6.36E-01, -2.22E+00, +1.15E-01
 1     00:00:00         26           27           140          140         0     +1.12E-08   +8.17E-10   +1.86E-06  +3.93E+00, +6.36E-01, -2.22E+00, +1.15E-01
 1     00:00:00         27           28           140          140         0     +1.21E-10   +1.10E-08   +7.68E-07  +3.92E+00, +6.36E-01, -2.22E+00, +1.15E-01
 1     00:00:00         28           29           141          141         0     +4.42E-14   +1.21E-10   +2.99E-08  +3.92E+00, +6.36E-01, -2.22E+00, +1.15E-01
 1     00:00:00         29           30           141          141         0     +4.09E-14   +3.24E-15   +3.56E-09  +3.92E+00, +6.36E-01, -2.22E+00, +1.15E-01
 1     00:00:00         30           31           140          140         0     +1.22E-19   +4.09E-14   +2.24E-11  +3.92E+00, +6.36E-01, -2.22E+00, +1.15E-01

Optimization completed after 00:00:01.
Computing the Hessian and and updating the weighting matrix ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +2.72E+17. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
=====================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number
----  ---------  ---------  --------------  --------------  -------  ----------------
 1    +1.22E-19  +2.24E-11    +1.54E-04       +1.40E+00        0        +1.29E+05    
=====================================================================================

Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 2     00:00:00         0             1           47           47          0     +1.77E+00               +4.65E+10  +3.92E+00, +6.36E-01, -2.22E+00, +1.15E-01
 2     00:00:00         1             2           126          126         0     +3.87E+19               +9.55E+19  +3.92E+00, +1.16E+00, -1.37E+00, +6.35E-02
 2     00:00:00         2             3           50           50          0     +2.70E+01               +2.65E+10  +3.92E+00, +6.36E-01, -2.22E+00, +1.15E-01

Optimization completed after 00:00:00.
Computing the Hessian and estimating standard errors ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +1.65E+17. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
========================================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix  Covariance Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number  Condition Number 
----  ---------  ---------  --------------  --------------  -------  ----------------  -----------------
 2    +1.77E+00  +4.65E+10    -5.82E+14       +2.04E+20        0        +8.18E+16          +3.13E+21    
========================================================================================================

Cumulative Statistics:
===========================================================================
Computation  Optimizer  Optimization   Objective   Fixed Point  Contraction
   Time      Converged   Iterations   Evaluations  Iterations   Evaluations
-----------  ---------  ------------  -----------  -----------  -----------
 00:00:01       Yes          41           36          4736         4736    
===========================================================================

Nonlinear Coefficient Estimates (Robust SEs in Parentheses):
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +3.92E+00              +6.36E-01              -2.22E+00              +1.15E-01      
                   |            (+3.60E-09)            (+2.29E-10)            (+4.10E-10)            (+2.21E-10)     
=====================================================================================================================

Beta Estimates (Robust SEs in Parentheses):
===============================================================================================
     1         prices     hpi_quantile1  hpi_quantile2  hpi_quantile3       X            Y     
-----------  -----------  -------------  -------------  -------------  -----------  -----------
 +3.31E+00    +1.70E-14     -4.89E+00      -2.47E+00      +4.55E+00     -3.28E+00    -2.65E+00 
(+9.61E-10)  (+2.73E-22)   (+7.33E-10)    (+9.96E-10)    (+9.91E-10)   (+5.02E-09)  (+2.47E-09)
===============================================================================================
Computing delta ...
Finished after 00:00:00.

Mean delta: 1.3294667963738722
pi labels: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
ii=0, vv=logdistXhpi_quantile1
logdistXhpi_quantile1 is a distance term, omitting from ABD and adding to coefficients instead
ii=1, vv=logdistXhpi_quantile2
logdistXhpi_quantile2 is a distance term, omitting from ABD and adding to coefficients instead
ii=2, vv=logdistXhpi_quantile3
logdistXhpi_quantile3 is a distance term, omitting from ABD and adding to coefficients instead
ii=3, vv=logdistXhpi_quantile4
logdistXhpi_quantile4 is a distance term, omitting from ABD and adding to coefficients instead

Distance coefficients: [3.92229, 0.63584, -2.2237, 0.11527]

Computed abepsilon in: 0.011 seconds.
Assigning individuals...
time3 - time2: 0.36
time4 - time3: 2.173
Number of full locations: 15  out of  18
Offers:
% Rank 0 offers: 45.24137
% Rank 1 offers: 8.42408
% Rank 2 offers: 4.22280
% Rank 3 offers: 2.69698
% Rank 4 offers: 39.41477
% Offered any: 100.0
Mean offer distance: 1.61418
Quantiles of offered distances:
0.0 quantile: -2.65569
0.1 quantile: 0.36428
0.2 quantile: 0.77851
0.3 quantile: 1.09849
0.4 quantile: 1.40445
0.5 quantile: 1.88522
0.6 quantile: 2.13144
0.7 quantile: 2.24398
0.8 quantile: 2.38353
0.9 quantile: 2.60737
1.0 quantile: 3.19221
Assignments:
% Rank 0 assignments: 30.22147
% Rank 1 assignments: 7.24663
% Rank 2 assignments: 3.80591
% Rank 3 assignments: 2.51268
% Rank 4 assignments: 34.88296
% Assigned: 78.66965
Mean assignment distance: 1.76327
Quantiles of assignment distances:
0.0 quantile: -2.05992
0.1 quantile: 0.65705
0.2 quantile: 1.00822
0.3 quantile: 1.29036
0.4 quantile: 1.63289
0.5 quantile: 2.06214
0.6 quantile: 2.17221
0.7 quantile: 2.26698
0.8 quantile: 2.39511
0.9 quantile: 2.60348
1.0 quantile: 3.19221
Violations:
Max violation: 34982
Number of locations with violations: 15
Number of individuals with violations: 146899
Mean violation (conditional on violation): 9793.266666666666
Median violation (conditional on violation): 7077.0
Number of markets with wasserstein distance > 0.001: 9
Mean wasserstein distance for markets with wasserstein distance > 0.001: 0.06189354134514716
Mean wasserstein distance: 0.05579948454422181
Max wasserstein distance: 0.12276157771178524
Index of max wasserstein distance: 7
Iteration 6 complete.


Number of agents: 11435

Iteration 7:

agent_loc_data:
     blkid  locid   logdist       dist  market_ids  hpi_quantile  hpi_quantile1  hpi_quantile2  hpi_quantile3  hpi_quantile4  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4  nodes  population   weights
0   132759      0  0.737546   2.090799     90059.0             1              1              0              0              0               0.737546                    0.0                    0.0                    0.0      0       40488  0.000148
1   132759      4  1.309970   3.706062     90059.0             1              1              0              0              0               1.309970                    0.0                    0.0                    0.0      0       40488  0.000025
4   132759     16  2.388723  10.899569     90059.0             1              1              0              0              0               2.388723                    0.0                    0.0                    0.0      0       40488  0.000222
5   132760      0  0.817771   2.265445     90059.0             1              1              0              0              0               0.817771                    0.0                    0.0                    0.0      0       40488  0.000939
6   132760      4  1.368392   3.929026     90059.0             1              1              0              0              0               1.368392                    0.0                    0.0                    0.0      0       40488  0.000296
8   132760      1  2.210262   9.118109     90059.0             1              1              0              0              0               2.210262                    0.0                    0.0                    0.0      0       40488  0.000025
9   132760     16  2.407625  11.107545     90059.0             1              1              0              0              0               2.407625                    0.0                    0.0                    0.0      0       40488  0.000840
10  132761      0  0.835924   2.306944     90059.0             1              1              0              0              0               0.835924                    0.0                    0.0                    0.0      0       40488  0.000074
14  132761      9  2.405422  11.083104     90059.0             1              1              0              0              0               2.405422                    0.0                    0.0                    0.0      0       40488  0.000123
15  132763      0  0.685177   1.984123     90059.0             1              1              0              0              0               0.685177                    0.0                    0.0                    0.0      0       40488  0.000123
16  132763      4  1.317212   3.733000     90059.0             1              1              0              0              0               1.317212                    0.0                    0.0                    0.0      0       40488  0.000049
19  132763     16  2.382397  10.830829     90059.0             1              1              0              0              0               2.382397                    0.0                    0.0                    0.0      0       40488  0.000123
20  132772      0  0.959576   2.610589     90059.0             1              1              0              0              0               0.959576                    0.0                    0.0                    0.0      0       40488  0.001704
21  132772      4  1.464425   4.325055     90059.0             1              1              0              0              0               1.464425                    0.0                    0.0                    0.0      0       40488  0.000222
22  132772      7  1.847489   6.343871     90059.0             1              1              0              0              0               1.847489                    0.0                    0.0                    0.0      0       40488  0.000049
23  132772      1  2.250480   9.492289     90059.0             1              1              0              0              0               2.250480                    0.0                    0.0                    0.0      0       40488  0.000025
24  132772      9  2.387146  10.882389     90059.0             1              1              0              0              0               2.387146                    0.0                    0.0                    0.0      0       40488  0.001334
25  132774      0  1.021268   2.776713     90059.0             1              1              0              0              0               1.021268                    0.0                    0.0                    0.0      0       40488  0.001111
26  132774      4  1.507882   4.517154     90059.0             1              1              0              0              0               1.507882                    0.0                    0.0                    0.0      0       40488  0.000173
28  132774      1  2.269645   9.675964     90059.0             1              1              0              0              0               2.269645                    0.0                    0.0                    0.0      0       40488  0.000074
29  132774      9  2.373282  10.732561     90059.0             1              1              0              0              0               2.373282                    0.0                    0.0                    0.0      0       40488  0.001136
30  132775      0  0.943832   2.569810     90059.0             1              1              0              0              0               0.943832                    0.0                    0.0                    0.0      0       40488  0.002272
31  132775      4  1.464439   4.325118     90059.0             1              1              0              0              0               1.464439                    0.0                    0.0                    0.0      0       40488  0.000346
32  132775      7  1.850678   6.364134     90059.0             1              1              0              0              0               1.850678                    0.0                    0.0                    0.0      0       40488  0.000099
34  132775      9  2.384357  10.852086     90059.0             1              1              0              0              0               2.384357                    0.0                    0.0                    0.0      0       40488  0.001754
35  132776      0  0.887535   2.429133     90059.0             1              1              0              0              0               0.887535                    0.0                    0.0                    0.0      0       40488  0.001186
36  132776      4  1.415862   4.120036     90059.0             1              1              0              0              0               1.415862                    0.0                    0.0                    0.0      0       40488  0.000321
37  132776      7  1.879925   6.553017     90059.0             1              1              0              0              0               1.879925                    0.0                    0.0                    0.0      0       40488  0.000074
38  132776      1  2.229868   9.298637     90059.0             1              1              0              0              0               2.229868                    0.0                    0.0                    0.0      0       40488  0.000025
39  132776      9  2.401359  11.038164     90059.0             1              1              0              0              0               2.401359                    0.0                    0.0                    0.0      0       40488  0.001161
40  132792      0  0.788905   2.200984     90059.0             1              1              0              0              0               0.788905                    0.0                    0.0                    0.0      0       40488  0.003705
41  132792      4  1.462907   4.318494     90059.0             1              1              0              0              0               1.462907                    0.0                    0.0                    0.0      0       40488  0.000519
42  132792      7  1.889494   6.616020     90059.0             1              1              0              0              0               1.889494                    0.0                    0.0                    0.0      0       40488  0.000222
43  132792      1  2.258765   9.571262     90059.0             1              1              0              0              0               2.258765                    0.0                    0.0                    0.0      0       40488  0.000074
44  132792      9  2.363775  10.631010     90059.0             1              1              0              0              0               2.363775                    0.0                    0.0                    0.0      0       40488  0.003211
45  132793      0  0.782841   2.187679     90059.0             1              1              0              0              0               0.782841                    0.0                    0.0                    0.0      0       40488  0.003038
46  132793      4  1.473780   4.365707     90059.0             1              1              0              0              0               1.473780                    0.0                    0.0                    0.0      0       40488  0.000543
47  132793      7  1.890205   6.620723     90059.0             1              1              0              0              0               1.890205                    0.0                    0.0                    0.0      0       40488  0.000123
48  132793      1  2.264449   9.625818     90059.0             1              1              0              0              0               2.264449                    0.0                    0.0                    0.0      0       40488  0.000025
49  132793      9  2.357149  10.560804     90059.0             1              1              0              0              0               2.357149                    0.0                    0.0                    0.0      0       40488  0.002692
50  132794      0  0.887200   2.428321     90059.0             1              1              0              0              0               0.887200                    0.0                    0.0                    0.0      0       40488  0.001235
51  132794      4  1.526687   4.602902     90059.0             1              1              0              0              0               1.526687                    0.0                    0.0                    0.0      0       40488  0.000123
52  132794      7  1.852737   6.377253     90059.0             1              1              0              0              0               1.852737                    0.0                    0.0                    0.0      0       40488  0.000025
53  132794      1  2.287930   9.854524     90059.0             1              1              0              0              0               2.287930                    0.0                    0.0                    0.0      0       40488  0.000049
54  132794      9  2.338092  10.361449     90059.0             1              1              0              0              0               2.338092                    0.0                    0.0                    0.0      0       40488  0.000889
55  132795      0  0.939920   2.559777     90059.0             1              1              0              0              0               0.939920                    0.0                    0.0                    0.0      0       40488  0.000395
56  132795      4  1.556965   4.744402     90059.0             1              1              0              0              0               1.556965                    0.0                    0.0                    0.0      0       40488  0.000025
57  132795      7  1.831855   6.245459     90059.0             1              1              0              0              0               1.831855                    0.0                    0.0                    0.0      0       40488  0.000025
59  132795      9  2.325947  10.236375     90059.0             1              1              0              0              0               2.325947                    0.0                    0.0                    0.0      0       40488  0.000173
60  132796      0  0.770565   2.160988     90059.0             1              1              0              0              0               0.770565                    0.0                    0.0                    0.0      0       40488  0.003853
pi_init:
[[ 3.92229087  0.63583819 -2.22370381  0.11527422]]
Weight distribution by market:
count    10.0
mean      1.0
std       0.0
min       1.0
25%       1.0
50%       1.0
75%       1.0
max       1.0
Name: weights, dtype: float64
Estimating demand...
agent_vars: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
iv_df:
             demand_instruments0  demand_instruments1  demand_instruments2  demand_instruments3
market_ids                                                                                    
90059.0                1.265875             0.000000                  0.0             0.000000
90201.0                1.355510             0.000000                  0.0             0.000000
90277.0                0.000000             0.000000                  0.0             1.941221
90290.0                0.000000             0.000000                  0.0             2.840072
90302.0                0.000000             1.626596                  0.0             0.000000
Initializing the problem ...
Initialized the problem after 00:00:00.

Dimensions:
===========================================
 T    N    F     I     K1    K2    D    MD 
---  ---  ---  -----  ----  ----  ---  ----
10   10    1   11435   7     1     4    10 
===========================================

Formulations:
==================================================================================================================================================
       Column Indices:                   0                      1                      2                      3                  4         5    6 
-----------------------------  ---------------------  ---------------------  ---------------------  ---------------------  -------------  ---  ---
 X1: Linear Characteristics              1                   prices              hpi_quantile1          hpi_quantile2      hpi_quantile3   X    Y 
X2: Nonlinear Characteristics            1                                                                                                        
       d: Demographics         logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4                         
==================================================================================================================================================
pi_init: [[ 3.92229087  0.63583819 -2.22370381  0.11527422]]
pi_lb: [[-inf -inf -inf -inf]]
pi_ub: [[inf inf inf inf]]
Solving with one core...
Solving the problem ...

Nonlinear Coefficient Initial Values:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +3.92E+00              +6.36E-01              -2.22E+00              +1.15E-01      
=====================================================================================================================

Nonlinear Coefficient Lower Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           -INF                   -INF                   -INF                   -INF         
=====================================================================================================================

Nonlinear Coefficient Upper Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           +INF                   +INF                   +INF                   +INF         
=====================================================================================================================

The model may be under-identified. The total number of unfixed parameters is 11, which is more than the total number of moments, 10. Consider checking whether instruments were properly specified when initializing the problem, and whether parameters were properly configured when solving the problem.
Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 1     00:00:00         0             1           140          140         0     +7.27E-03               +3.28E-02  +3.92E+00, +6.36E-01, -2.22E+00, +1.15E-01
 1     00:00:00         1             2           138          138         0     +5.40E-03   +1.87E-03   +2.93E-02  +3.92E+00, +6.62E-01, -2.19E+00, +9.73E-02
 1     00:00:00         2             3           143          143         0     +4.61E-03   +7.86E-04   +6.42E-02  +3.92E+00, +7.89E-01, -1.98E+00, +9.14E-02
 1     00:00:00         3             4           141          141         0     +2.77E-03   +1.84E-03   +2.78E-02  +3.92E+00, +7.86E-01, -2.02E+00, +1.92E-02
 1     00:00:00         4             5           143          143         0     +2.34E-03   +4.28E-04   +6.61E-03  +3.92E+00, +7.76E-01, -2.02E+00, +4.41E-02
 1     00:00:00         5             6           140          140         0     +2.17E-03   +1.72E-04   +1.47E-03  +3.92E+00, +7.41E-01, -2.05E+00, +5.02E-02
 1     00:00:00         6             7           141          141         0     +2.17E-03   +7.23E-06   +6.06E-04  +3.92E+00, +7.41E-01, -2.04E+00, +4.79E-02
 1     00:00:00         7             8           141          141         0     +2.16E-03   +3.14E-06   +3.46E-04  +3.92E+00, +7.39E-01, -2.03E+00, +4.56E-02
 1     00:00:00         8             9           141          141         0     +2.16E-03   +6.48E-07   +1.33E-04  +3.92E+00, +7.36E-01, -2.03E+00, +4.45E-02
 1     00:00:00         9            10           141          141         0     +2.16E-03   +5.31E-08   +4.24E-05  +3.92E+00, +7.36E-01, -2.03E+00, +4.46E-02
 1     00:00:00         10           11           141          141         0     +2.16E-03   +7.87E-09   +1.51E-06  +3.92E+00, +7.35E-01, -2.03E+00, +4.45E-02
 1     00:00:00         11           12           141          141         0     +2.16E-03   +3.43E-12   +2.55E-07  +3.92E+00, +7.35E-01, -2.03E+00, +4.45E-02
 1     00:00:00         12           13           141          141         0     +2.16E-03   +2.44E-13   +8.87E-08  +3.92E+00, +7.35E-01, -2.03E+00, +4.45E-02
 1     00:00:00         13           14           141          141         0     +2.16E-03   +2.90E-14   +8.83E-08  +3.92E+00, +7.35E-01, -2.03E+00, +4.45E-02
 1     00:00:00         14           15           141          141         0     +2.16E-03   +3.76E-13   +1.96E-07  +3.92E+00, +7.35E-01, -2.03E+00, +4.45E-02
 1     00:00:00         15           16           140          140         0     +2.16E-03   +8.23E-14   +1.28E-07  +3.92E+00, +7.35E-01, -2.03E+00, +4.45E-02
 1     00:00:00         16           17           140          140         0     +2.16E-03   +1.05E-12   +1.24E-07  +3.92E+00, +7.35E-01, -2.03E+00, +4.45E-02
 1     00:00:00         17           18           141          141         0     +2.16E-03   +1.51E-12   +1.23E-07  +3.92E+00, +7.35E-01, -2.03E+00, +4.45E-02
 1     00:00:00         18           19           140          140         0     +2.16E-03   +4.82E-14   +3.68E-08  +3.92E+00, +7.35E-01, -2.03E+00, +4.45E-02
 1     00:00:00         19           20           141          141         0     +2.16E-03   +5.90E-15   +7.24E-09  +3.92E+00, +7.35E-01, -2.03E+00, +4.45E-02
 1     00:00:00         20           21           140          140         0     +2.16E-03   +2.09E-14   +6.13E-11  +3.92E+00, +7.35E-01, -2.03E+00, +4.45E-02

Optimization completed after 00:00:01.
Computing the Hessian and and updating the weighting matrix ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +9.16E+17. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
=====================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number
----  ---------  ---------  --------------  --------------  -------  ----------------
 1    +2.16E-03  +6.13E-11    +1.26E-03       +1.22E+00        0        +1.48E+05    
=====================================================================================

Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 2     00:00:00         0             1           47           47          0     +6.46E+00               +9.25E+01  +3.92E+00, +7.35E-01, -2.03E+00, +4.45E-02
 2     00:00:00         1             2           128          128         0     +9.70E+02               +1.80E+03  +3.92E+00, +5.25E-02, -1.64E+00, +6.58E-01
 2     00:00:00         2             3           98           98          0     +9.65E-01   +5.50E+00   +4.36E+01  +3.92E+00, +6.96E-01, -1.98E+00, +9.16E-02
 2     00:00:00         3             4           98           98          0     +1.87E-01   +7.78E-01   +1.36E+01  +3.92E+00, +7.08E-01, -1.97E+00, +1.02E-01
 2     00:00:00         4             5           100          100         0     +4.67E-04   +1.87E-01   +1.10E+00  +3.92E+00, +7.08E-01, -1.95E+00, +1.14E-01
 2     00:00:00         5             6           100          100         0     +9.39E-08   +4.67E-04   +2.50E-02  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         6             7           100          100         0     +1.95E-09   +9.20E-08   +1.44E-03  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         7             8           100          100         0     +1.41E-13   +1.95E-09   +3.89E-05  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         8             9           100          100         0     +1.27E-13   +1.35E-14   +1.11E-05  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         9            10           100          100         0     +9.84E-14   +2.86E-14   +8.66E-06  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         10           11           100          100         0     +7.19E-14   +2.65E-14   +1.09E-05  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         11           12           100          100         0     +3.92E-13               +2.89E-05  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         12           13           100          100         0     +6.74E-13               +3.65E-05  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         13           14           104          104         0     +3.44E-11               +1.92E-04  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         14           15           104          104         0     +6.43E-12               +8.77E-05  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         15           16           103          103         0     +3.47E-12               +6.59E-05  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         16           17           104          104         0     +2.18E-11               +1.61E-04  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         17           18           104          104         0     +2.12E-12               +7.29E-05  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         18           19           104          104         0     +1.39E-13               +1.49E-05  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         19           20           102          102         0     +2.03E-14   +5.16E-14   +2.96E-05  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         20           21           104          104         0     +4.28E-13               +2.42E-05  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         21           22           102          102         0     +5.09E-13               +2.34E-05  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         22           23           103          103         0     +1.58E-13               +1.23E-05  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         23           24           103          103         0     +4.13E-13               +2.53E-05  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         24           25           104          104         0     +7.84E-14               +1.49E-05  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         25           26           104          104         0     +6.53E-14               +1.30E-05  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 2     00:00:00         26           27           104          104         0     +2.13E-14               +8.79E-06  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01

Optimization completed after 00:00:01.
Computing the Hessian and estimating standard errors ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +2.47E+20. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
========================================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix  Covariance Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number  Condition Number 
----  ---------  ---------  --------------  --------------  -------  ----------------  -----------------
 2    +2.03E-14  +2.96E-05    -1.79E+00       +3.75E+03        0        +2.35E+29          +3.31E+20    
========================================================================================================

Cumulative Statistics:
===========================================================================
Computation  Optimizer  Optimization   Objective   Fixed Point  Contraction
   Time      Converged   Iterations   Evaluations  Iterations   Evaluations
-----------  ---------  ------------  -----------  -----------  -----------
 00:00:02       Yes          48           50          5918         5918    
===========================================================================

Nonlinear Coefficient Estimates (Robust SEs in Parentheses):
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +3.92E+00              +7.08E-01              -1.95E+00              +1.15E-01      
                   |            (+8.99E-02)            (+6.48E-02)            (+3.09E-02)            (+5.71E-02)     
=====================================================================================================================

Beta Estimates (Robust SEs in Parentheses):
===============================================================================================
     1         prices     hpi_quantile1  hpi_quantile2  hpi_quantile3       X            Y     
-----------  -----------  -------------  -------------  -------------  -----------  -----------
 +2.61E+00    -6.02E-13     -4.87E+00      -1.99E+00      +4.27E+00     -6.43E+00    -1.31E+00 
(+1.95E-01)  (+3.70E-15)   (+1.27E-01)    (+2.28E-01)    (+1.85E-01)   (+4.35E-02)  (+1.12E-01)
===============================================================================================
Computing delta ...
Finished after 00:00:00.

Mean delta: 0.9928989552457426
pi labels: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
ii=0, vv=logdistXhpi_quantile1
logdistXhpi_quantile1 is a distance term, omitting from ABD and adding to coefficients instead
ii=1, vv=logdistXhpi_quantile2
logdistXhpi_quantile2 is a distance term, omitting from ABD and adding to coefficients instead
ii=2, vv=logdistXhpi_quantile3
logdistXhpi_quantile3 is a distance term, omitting from ABD and adding to coefficients instead
ii=3, vv=logdistXhpi_quantile4
logdistXhpi_quantile4 is a distance term, omitting from ABD and adding to coefficients instead

Distance coefficients: [3.92237, 0.70774, -1.95048, 0.11473]

Computed abepsilon in: 0.011 seconds.
Assigning individuals...
time3 - time2: 0.327
time4 - time3: 2.128
Number of full locations: 15  out of  18
Offers:
% Rank 0 offers: 48.55451
% Rank 1 offers: 8.90845
% Rank 2 offers: 4.28502
% Rank 3 offers: 2.86447
% Rank 4 offers: 35.38755
% Offered any: 100.0
Mean offer distance: 1.55397
Quantiles of offered distances:
0.0 quantile: -2.65569
0.1 quantile: 0.30331
0.2 quantile: 0.70695
0.3 quantile: 1.02870
0.4 quantile: 1.30369
0.5 quantile: 1.62955
0.6 quantile: 2.08654
0.7 quantile: 2.21946
0.8 quantile: 2.35940
0.9 quantile: 2.60210
1.0 quantile: 3.19221
Assignments:
% Rank 0 assignments: 29.69326
% Rank 1 assignments: 7.42463
% Rank 2 assignments: 3.80906
% Rank 3 assignments: 2.62898
% Rank 4 assignments: 30.53441
% Assigned: 74.09033
Mean assignment distance: 1.74369
Quantiles of assignment distances:
0.0 quantile: -2.05992
0.1 quantile: 0.67114
0.2 quantile: 1.00538
0.3 quantile: 1.26627
0.4 quantile: 1.56132
0.5 quantile: 2.00895
0.6 quantile: 2.15373
0.7 quantile: 2.25762
0.8 quantile: 2.39149
0.9 quantile: 2.60268
1.0 quantile: 3.19221
Violations:
Max violation: 29608
Number of locations with violations: 15
Number of individuals with violations: 130931
Mean violation (conditional on violation): 8728.733333333334
Median violation (conditional on violation): 6839.0
Number of markets with wasserstein distance > 0.001: 9
Mean wasserstein distance for markets with wasserstein distance > 0.001: 0.04703007493758127
Mean wasserstein distance: 0.04238789613978682
Max wasserstein distance: 0.11999086354143645
Index of max wasserstein distance: 9
Iteration 7 complete.


Number of agents: 11547

Iteration 8:

agent_loc_data:
     blkid  locid   logdist       dist  market_ids  hpi_quantile  hpi_quantile1  hpi_quantile2  hpi_quantile3  hpi_quantile4  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4  nodes  population   weights
0   132759      0  0.737546   2.090799     90059.0             1              1              0              0              0               0.737546                    0.0                    0.0                    0.0      0       40488  0.000198
4   132759     16  2.388723  10.899569     90059.0             1              1              0              0              0               2.388723                    0.0                    0.0                    0.0      0       40488  0.000198
5   132760      0  0.817771   2.265445     90059.0             1              1              0              0              0               0.817771                    0.0                    0.0                    0.0      0       40488  0.001087
6   132760      4  1.368392   3.929026     90059.0             1              1              0              0              0               1.368392                    0.0                    0.0                    0.0      0       40488  0.000247
7   132760      7  1.909226   6.747865     90059.0             1              1              0              0              0               1.909226                    0.0                    0.0                    0.0      0       40488  0.000025
8   132760      1  2.210262   9.118109     90059.0             1              1              0              0              0               2.210262                    0.0                    0.0                    0.0      0       40488  0.000025
9   132760     16  2.407625  11.107545     90059.0             1              1              0              0              0               2.407625                    0.0                    0.0                    0.0      0       40488  0.000716
10  132761      0  0.835924   2.306944     90059.0             1              1              0              0              0               0.835924                    0.0                    0.0                    0.0      0       40488  0.000074
14  132761      9  2.405422  11.083104     90059.0             1              1              0              0              0               2.405422                    0.0                    0.0                    0.0      0       40488  0.000123
15  132763      0  0.685177   1.984123     90059.0             1              1              0              0              0               0.685177                    0.0                    0.0                    0.0      0       40488  0.000148
16  132763      4  1.317212   3.733000     90059.0             1              1              0              0              0               1.317212                    0.0                    0.0                    0.0      0       40488  0.000025
19  132763     16  2.382397  10.830829     90059.0             1              1              0              0              0               2.382397                    0.0                    0.0                    0.0      0       40488  0.000123
20  132772      0  0.959576   2.610589     90059.0             1              1              0              0              0               0.959576                    0.0                    0.0                    0.0      0       40488  0.001803
21  132772      4  1.464425   4.325055     90059.0             1              1              0              0              0               1.464425                    0.0                    0.0                    0.0      0       40488  0.000346
22  132772      7  1.847489   6.343871     90059.0             1              1              0              0              0               1.847489                    0.0                    0.0                    0.0      0       40488  0.000049
23  132772      1  2.250480   9.492289     90059.0             1              1              0              0              0               2.250480                    0.0                    0.0                    0.0      0       40488  0.000025
24  132772      9  2.387146  10.882389     90059.0             1              1              0              0              0               2.387146                    0.0                    0.0                    0.0      0       40488  0.001111
25  132774      0  1.021268   2.776713     90059.0             1              1              0              0              0               1.021268                    0.0                    0.0                    0.0      0       40488  0.001210
26  132774      4  1.507882   4.517154     90059.0             1              1              0              0              0               1.507882                    0.0                    0.0                    0.0      0       40488  0.000272
27  132774      7  1.816779   6.152013     90059.0             1              1              0              0              0               1.816779                    0.0                    0.0                    0.0      0       40488  0.000049
28  132774      1  2.269645   9.675964     90059.0             1              1              0              0              0               2.269645                    0.0                    0.0                    0.0      0       40488  0.000025
29  132774      9  2.373282  10.732561     90059.0             1              1              0              0              0               2.373282                    0.0                    0.0                    0.0      0       40488  0.000939
30  132775      0  0.943832   2.569810     90059.0             1              1              0              0              0               0.943832                    0.0                    0.0                    0.0      0       40488  0.002420
31  132775      4  1.464439   4.325118     90059.0             1              1              0              0              0               1.464439                    0.0                    0.0                    0.0      0       40488  0.000420
32  132775      7  1.850678   6.364134     90059.0             1              1              0              0              0               1.850678                    0.0                    0.0                    0.0      0       40488  0.000123
33  132775      1  2.251602   9.502947     90059.0             1              1              0              0              0               2.251602                    0.0                    0.0                    0.0      0       40488  0.000049
34  132775      9  2.384357  10.852086     90059.0             1              1              0              0              0               2.384357                    0.0                    0.0                    0.0      0       40488  0.001457
35  132776      0  0.887535   2.429133     90059.0             1              1              0              0              0               0.887535                    0.0                    0.0                    0.0      0       40488  0.001334
36  132776      4  1.415862   4.120036     90059.0             1              1              0              0              0               1.415862                    0.0                    0.0                    0.0      0       40488  0.000445
37  132776      7  1.879925   6.553017     90059.0             1              1              0              0              0               1.879925                    0.0                    0.0                    0.0      0       40488  0.000074
39  132776      9  2.401359  11.038164     90059.0             1              1              0              0              0               2.401359                    0.0                    0.0                    0.0      0       40488  0.000914
40  132792      0  0.788905   2.200984     90059.0             1              1              0              0              0               0.788905                    0.0                    0.0                    0.0      0       40488  0.003902
41  132792      4  1.462907   4.318494     90059.0             1              1              0              0              0               1.462907                    0.0                    0.0                    0.0      0       40488  0.000692
42  132792      7  1.889494   6.616020     90059.0             1              1              0              0              0               1.889494                    0.0                    0.0                    0.0      0       40488  0.000247
43  132792      1  2.258765   9.571262     90059.0             1              1              0              0              0               2.258765                    0.0                    0.0                    0.0      0       40488  0.000099
44  132792      9  2.363775  10.631010     90059.0             1              1              0              0              0               2.363775                    0.0                    0.0                    0.0      0       40488  0.002791
45  132793      0  0.782841   2.187679     90059.0             1              1              0              0              0               0.782841                    0.0                    0.0                    0.0      0       40488  0.003359
46  132793      4  1.473780   4.365707     90059.0             1              1              0              0              0               1.473780                    0.0                    0.0                    0.0      0       40488  0.000568
47  132793      7  1.890205   6.620723     90059.0             1              1              0              0              0               1.890205                    0.0                    0.0                    0.0      0       40488  0.000123
48  132793      1  2.264449   9.625818     90059.0             1              1              0              0              0               2.264449                    0.0                    0.0                    0.0      0       40488  0.000099
49  132793      9  2.357149  10.560804     90059.0             1              1              0              0              0               2.357149                    0.0                    0.0                    0.0      0       40488  0.002272
50  132794      0  0.887200   2.428321     90059.0             1              1              0              0              0               0.887200                    0.0                    0.0                    0.0      0       40488  0.001284
51  132794      4  1.526687   4.602902     90059.0             1              1              0              0              0               1.526687                    0.0                    0.0                    0.0      0       40488  0.000247
52  132794      7  1.852737   6.377253     90059.0             1              1              0              0              0               1.852737                    0.0                    0.0                    0.0      0       40488  0.000049
53  132794      1  2.287930   9.854524     90059.0             1              1              0              0              0               2.287930                    0.0                    0.0                    0.0      0       40488  0.000049
54  132794      9  2.338092  10.361449     90059.0             1              1              0              0              0               2.338092                    0.0                    0.0                    0.0      0       40488  0.000692
55  132795      0  0.939920   2.559777     90059.0             1              1              0              0              0               0.939920                    0.0                    0.0                    0.0      0       40488  0.000420
56  132795      4  1.556965   4.744402     90059.0             1              1              0              0              0               1.556965                    0.0                    0.0                    0.0      0       40488  0.000025
59  132795      9  2.325947  10.236375     90059.0             1              1              0              0              0               2.325947                    0.0                    0.0                    0.0      0       40488  0.000173
60  132796      0  0.770565   2.160988     90059.0             1              1              0              0              0               0.770565                    0.0                    0.0                    0.0      0       40488  0.004199
pi_init:
[[ 3.92236589  0.70774046 -1.95048106  0.1147269 ]]
Weight distribution by market:
count    10.0
mean      1.0
std       0.0
min       1.0
25%       1.0
50%       1.0
75%       1.0
max       1.0
Name: weights, dtype: float64
Estimating demand...
agent_vars: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
iv_df:
             demand_instruments0  demand_instruments1  demand_instruments2  demand_instruments3
market_ids                                                                                    
90059.0                1.155415             0.000000                  0.0             0.000000
90201.0                1.254755             0.000000                  0.0             0.000000
90277.0                0.000000             0.000000                  0.0             1.919019
90290.0                0.000000             0.000000                  0.0             2.839476
90302.0                0.000000             1.615155                  0.0             0.000000
Initializing the problem ...
Initialized the problem after 00:00:00.

Dimensions:
===========================================
 T    N    F     I     K1    K2    D    MD 
---  ---  ---  -----  ----  ----  ---  ----
10   10    1   11547   7     1     4    10 
===========================================

Formulations:
==================================================================================================================================================
       Column Indices:                   0                      1                      2                      3                  4         5    6 
-----------------------------  ---------------------  ---------------------  ---------------------  ---------------------  -------------  ---  ---
 X1: Linear Characteristics              1                   prices              hpi_quantile1          hpi_quantile2      hpi_quantile3   X    Y 
X2: Nonlinear Characteristics            1                                                                                                        
       d: Demographics         logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4                         
==================================================================================================================================================
pi_init: [[ 3.92236589  0.70774046 -1.95048106  0.1147269 ]]
pi_lb: [[-inf -inf -inf -inf]]
pi_ub: [[inf inf inf inf]]
Solving with one core...
Solving the problem ...

Nonlinear Coefficient Initial Values:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +3.92E+00              +7.08E-01              -1.95E+00              +1.15E-01      
=====================================================================================================================

Nonlinear Coefficient Lower Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           -INF                   -INF                   -INF                   -INF         
=====================================================================================================================

Nonlinear Coefficient Upper Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           +INF                   +INF                   +INF                   +INF         
=====================================================================================================================

The model may be under-identified. The total number of unfixed parameters is 11, which is more than the total number of moments, 10. Consider checking whether instruments were properly specified when initializing the problem, and whether parameters were properly configured when solving the problem.
Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 1     00:00:00         0             1           142          142         0     +7.96E-03               +9.96E-02  +3.92E+00, +7.08E-01, -1.95E+00, +1.15E-01
 1     00:00:00         1             2           138          138         0     +2.64E-03   +5.32E-03   +3.98E-02  +3.92E+00, +7.03E-01, -2.02E+00, +1.51E-02
 1     00:00:00         2             3           138          138         0     +1.71E-03   +9.24E-04   +1.61E-02  +3.92E+00, +6.90E-01, -2.02E+00, +3.97E-02
 1     00:00:00         3             4           137          137         0     +9.59E-04   +7.55E-04   +1.62E-02  +3.92E+00, +6.67E-01, -2.05E+00, +6.36E-02
 1     00:00:00         4             5           139          139         0     +5.56E-04   +4.03E-04   +8.99E-03  +3.92E+00, +6.46E-01, -2.09E+00, +7.47E-02
 1     00:00:00         5             6           137          137         0     +4.49E-04   +1.07E-04   +3.93E-03  +3.92E+00, +6.42E-01, -2.11E+00, +7.54E-02
 1     00:00:00         6             7           137          137         0     +4.19E-04   +3.01E-05   +3.01E-03  +3.92E+00, +6.47E-01, -2.11E+00, +7.48E-02
 1     00:00:00         7             8           137          137         0     +3.84E-04   +3.51E-05   +5.21E-03  +3.92E+00, +6.59E-01, -2.12E+00, +7.62E-02
 1     00:00:00         8             9           138          138         0     +3.58E-04   +2.58E-05   +4.95E-03  +3.92E+00, +6.68E-01, -2.13E+00, +8.16E-02
 1     00:00:00         9            10           138          138         0     +3.50E-04   +8.29E-06   +2.25E-03  +3.92E+00, +6.68E-01, -2.13E+00, +8.38E-02
 1     00:00:00         10           11           140          140         0     +3.42E-04   +7.32E-06   +3.66E-04  +3.92E+00, +6.77E-01, -2.14E+00, +8.82E-02
 1     00:00:00         11           12           139          139         0     +3.42E-04   +4.37E-07   +1.09E-04  +3.92E+00, +6.76E-01, -2.14E+00, +8.88E-02
 1     00:00:00         12           13           138          138         0     +3.42E-04   +6.69E-08   +1.09E-04  +3.92E+00, +6.77E-01, -2.14E+00, +8.91E-02
 1     00:00:00         13           14           139          139         0     +3.42E-04   +1.02E-08   +1.09E-04  +3.92E+00, +6.77E-01, -2.14E+00, +8.91E-02
 1     00:00:00         14           15           138          138         0     +3.39E-04   +2.43E-06   +7.47E-04  +3.95E+00, +6.75E-01, -2.14E+00, +8.86E-02
 1     00:00:00         15           16           139          139         0     +3.39E-04   +3.18E-07   +3.32E-04  +3.95E+00, +6.75E-01, -2.14E+00, +8.90E-02
 1     00:00:00         16           17           139          139         0     +3.39E-04   +4.01E-07   +9.57E-05  +3.95E+00, +6.76E-01, -2.14E+00, +8.91E-02
 1     00:00:00         17           18           139          139         0     +3.34E-04   +5.25E-06   +6.51E-04  +4.02E+00, +6.76E-01, -2.14E+00, +8.97E-02
 1     00:00:00         18           19           140          140         0     +3.33E-04   +1.92E-07   +1.23E-04  +4.02E+00, +6.76E-01, -2.14E+00, +8.93E-02
 1     00:00:00         19           20           140          140         0     +3.28E-04   +5.29E-06   +9.26E-05  +4.17E+00, +6.77E-01, -2.14E+00, +8.97E-02
 1     00:00:00         20           21           140          140         0     +3.28E-04   +2.51E-08   +1.59E-05  +4.17E+00, +6.77E-01, -2.14E+00, +8.96E-02
 1     00:00:00         21           22           138          138         0     +3.28E-04   +4.71E-08   +1.76E-06  +4.18E+00, +6.77E-01, -2.14E+00, +8.95E-02
 1     00:00:00         22           23           138          138         0     +3.28E-04   +3.41E-11   +2.73E-07  +4.18E+00, +6.77E-01, -2.14E+00, +8.95E-02
 1     00:00:00         23           24           140          140         0     +3.28E-04   +8.06E-11   +1.91E-08  +4.18E+00, +6.77E-01, -2.14E+00, +8.95E-02
 1     00:00:00         24           25           139          139         0     +3.28E-04   +1.27E-15   +1.15E-09  +4.18E+00, +6.77E-01, -2.14E+00, +8.95E-02
 1     00:00:00         25           26           139          139         0     +3.28E-04   +7.71E-16   +1.56E-12  +4.18E+00, +6.77E-01, -2.14E+00, +8.95E-02

Optimization completed after 00:00:01.
Computing the Hessian and and updating the weighting matrix ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +2.41E+18. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
=====================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number
----  ---------  ---------  --------------  --------------  -------  ----------------
 1    +3.28E-04  +1.56E-12    +3.93E-04       +1.33E+00        0        +1.34E+05    
=====================================================================================

Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 2     00:00:00         0             1           44           44          0     +6.73E+00               +3.30E+02  +4.18E+00, +6.77E-01, -2.14E+00, +8.95E-02
 2     00:00:00         1             2           127          127         0     +1.43E+04               +2.27E+04  +4.18E+00, +7.10E-02, -1.79E+00, +8.02E-01
 2     00:00:00         2             3           88           88          0     +2.20E+00   +4.52E+00   +1.23E+02  +4.18E+00, +6.68E-01, -2.13E+00, +1.01E-01
 2     00:00:00         3             4           90           90          0     +1.32E+00   +8.84E-01   +9.48E+01  +4.18E+00, +6.70E-01, -2.13E+00, +1.04E-01
 2     00:00:00         4             5           92           92          0     +4.50E-05   +1.32E+00   +1.33E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 2     00:00:00         5             6           92           92          0     +1.20E-04               +1.32E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 2     00:00:00         6             7           92           92          0     +4.20E-04               +2.67E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 2     00:00:00         7             8           92           92          0     +1.22E-03               +4.69E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 2     00:00:00         8             9           90           90          0     +4.50E-04               +3.07E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 2     00:00:00         9            10           92           92          0     +3.30E-04               +2.63E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 2     00:00:00         10           11           92           92          0     +1.40E-04               +1.66E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 2     00:00:00         11           12           92           92          0     +8.06E-05               +1.29E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 2     00:00:00         12           13           91           91          0     +5.98E-05               +1.31E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 2     00:00:00         13           14           91           91          0     +5.17E-05               +1.32E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 2     00:00:00         14           15           92           92          0     +4.82E-05               +1.32E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 2     00:00:00         15           16           92           92          0     +4.66E-05               +1.32E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 2     00:00:00         16           17           91           91          0     +4.58E-05               +1.33E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 2     00:00:00         17           18           92           92          0     +4.54E-05               +1.33E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 2     00:00:00         18           19           90           90          0     +4.52E-05               +1.33E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 2     00:00:00         19           20           92           92          0     +4.51E-05               +1.33E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 2     00:00:00         20           21           91           91          0     +4.51E-05               +1.33E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 2     00:00:00         21           22           92           92          0     +4.51E-05               +1.33E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 2     00:00:00         22           23           91           91          0     +4.51E-05               +1.33E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 2     00:00:00         23           24           92           92          0     +4.51E-05               +1.33E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 2     00:00:00         24           25           92           92          0     +4.50E-05               +1.33E+00  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01

Optimization completed after 00:00:01.
Computing the Hessian and estimating standard errors ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +8.21E+19. To disable singularity checks, set options.singular_tol = numpy.inf.

Failed to compute standard errors because of invalid estimated covariances of GMM parameters.

Computed results after 00:00:00.

Problem Results Summary:
========================================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix  Covariance Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number  Condition Number 
----  ---------  ---------  --------------  --------------  -------  ----------------  -----------------
 2    +4.50E-05  +1.33E+00    -2.32E+04       +3.40E+04        0        +5.63E+29          +6.09E+21    
========================================================================================================

Cumulative Statistics:
===========================================================================
Computation  Optimizer  Optimization   Objective   Fixed Point  Contraction
   Time      Converged   Iterations   Evaluations  Iterations   Evaluations
-----------  ---------  ------------  -----------  -----------  -----------
 00:00:02       Yes          51           53          6109         6109    
===========================================================================

Nonlinear Coefficient Estimates (Robust SEs in Parentheses):
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +4.18E+00              +6.77E-01              -2.11E+00              +1.15E-01      
                   |            (+2.97E-02)            (+1.99E-02)            (+1.26E-02)            (+2.24E-02)     
=====================================================================================================================

Beta Estimates (Robust SEs in Parentheses):
===============================================================================================
     1         prices     hpi_quantile1  hpi_quantile2  hpi_quantile3       X            Y     
-----------  -----------  -------------  -------------  -------------  -----------  -----------
 +3.04E+00    +1.01E-11     -5.04E+00      -2.31E+00      +4.42E+00     -4.54E+00    -2.14E+00 
(+6.93E-02)     (NAN)      (+5.10E-02)    (+7.70E-02)    (+7.62E-02)   (+1.26E-02)  (+3.24E-02)
===============================================================================================
Computing delta ...
Finished after 00:00:00.

Mean delta: 1.1609769116525197
pi labels: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
ii=0, vv=logdistXhpi_quantile1
logdistXhpi_quantile1 is a distance term, omitting from ABD and adding to coefficients instead
ii=1, vv=logdistXhpi_quantile2
logdistXhpi_quantile2 is a distance term, omitting from ABD and adding to coefficients instead
ii=2, vv=logdistXhpi_quantile3
logdistXhpi_quantile3 is a distance term, omitting from ABD and adding to coefficients instead
ii=3, vv=logdistXhpi_quantile4
logdistXhpi_quantile4 is a distance term, omitting from ABD and adding to coefficients instead

Distance coefficients: [4.18486, 0.67678, -2.1104, 0.11467]

Computed abepsilon in: 0.011 seconds.
Assigning individuals...
time3 - time2: 0.315
time4 - time3: 2.171
Number of full locations: 15  out of  18
Offers:
% Rank 0 offers: 46.38207
% Rank 1 offers: 8.57976
% Rank 2 offers: 4.28292
% Rank 3 offers: 2.81354
% Rank 4 offers: 37.94171
% Offered any: 99.99999999999999
Mean offer distance: 1.59333
Quantiles of offered distances:
0.0 quantile: -2.65569
0.1 quantile: 0.34197
0.2 quantile: 0.75126
0.3 quantile: 1.07358
0.4 quantile: 1.37046
0.5 quantile: 1.77466
0.6 quantile: 2.11735
0.7 quantile: 2.23633
0.8 quantile: 2.37519
0.9 quantile: 2.60430
1.0 quantile: 3.19221
Assignments:
% Rank 0 assignments: 29.91694
% Rank 1 assignments: 7.31174
% Rank 2 assignments: 3.85001
% Rank 3 assignments: 2.60903
% Rank 4 assignments: 33.29544
% Assigned: 76.98316
Mean assignment distance: 1.75932
Quantiles of assignment distances:
0.0 quantile: -2.05992
0.1 quantile: 0.66684
0.2 quantile: 1.01352
0.3 quantile: 1.28410
0.4 quantile: 1.61622
0.5 quantile: 2.04619
0.6 quantile: 2.16827
0.7 quantile: 2.26434
0.8 quantile: 2.39464
0.9 quantile: 2.60348
1.0 quantile: 3.19221
Violations:
Max violation: 33140
Number of locations with violations: 15
Number of individuals with violations: 141034
Mean violation (conditional on violation): 9402.266666666666
Median violation (conditional on violation): 6972.0
Number of markets with wasserstein distance > 0.001: 9
Mean wasserstein distance for markets with wasserstein distance > 0.001: 0.02947508176255424
Mean wasserstein distance: 0.02656522603530187
Max wasserstein distance: 0.07599394884928641
Index of max wasserstein distance: 9
Iteration 8 complete.


Number of agents: 11516

Iteration 9:

agent_loc_data:
     blkid  locid   logdist       dist  market_ids  hpi_quantile  hpi_quantile1  hpi_quantile2  hpi_quantile3  hpi_quantile4  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4  nodes  population   weights
0   132759      0  0.737546   2.090799     90059.0             1              1              0              0              0               0.737546                    0.0                    0.0                    0.0      0       40488  0.000173
3   132759      1  2.186667   8.905486     90059.0             1              1              0              0              0               2.186667                    0.0                    0.0                    0.0      0       40488  0.000025
4   132759     16  2.388723  10.899569     90059.0             1              1              0              0              0               2.388723                    0.0                    0.0                    0.0      0       40488  0.000198
5   132760      0  0.817771   2.265445     90059.0             1              1              0              0              0               0.817771                    0.0                    0.0                    0.0      0       40488  0.000988
6   132760      4  1.368392   3.929026     90059.0             1              1              0              0              0               1.368392                    0.0                    0.0                    0.0      0       40488  0.000247
7   132760      7  1.909226   6.747865     90059.0             1              1              0              0              0               1.909226                    0.0                    0.0                    0.0      0       40488  0.000025
8   132760      1  2.210262   9.118109     90059.0             1              1              0              0              0               2.210262                    0.0                    0.0                    0.0      0       40488  0.000049
9   132760     16  2.407625  11.107545     90059.0             1              1              0              0              0               2.407625                    0.0                    0.0                    0.0      0       40488  0.000790
10  132761      0  0.835924   2.306944     90059.0             1              1              0              0              0               0.835924                    0.0                    0.0                    0.0      0       40488  0.000074
14  132761      9  2.405422  11.083104     90059.0             1              1              0              0              0               2.405422                    0.0                    0.0                    0.0      0       40488  0.000123
15  132763      0  0.685177   1.984123     90059.0             1              1              0              0              0               0.685177                    0.0                    0.0                    0.0      0       40488  0.000123
16  132763      4  1.317212   3.733000     90059.0             1              1              0              0              0               1.317212                    0.0                    0.0                    0.0      0       40488  0.000049
19  132763     16  2.382397  10.830829     90059.0             1              1              0              0              0               2.382397                    0.0                    0.0                    0.0      0       40488  0.000123
20  132772      0  0.959576   2.610589     90059.0             1              1              0              0              0               0.959576                    0.0                    0.0                    0.0      0       40488  0.001754
21  132772      4  1.464425   4.325055     90059.0             1              1              0              0              0               1.464425                    0.0                    0.0                    0.0      0       40488  0.000247
22  132772      7  1.847489   6.343871     90059.0             1              1              0              0              0               1.847489                    0.0                    0.0                    0.0      0       40488  0.000025
23  132772      1  2.250480   9.492289     90059.0             1              1              0              0              0               2.250480                    0.0                    0.0                    0.0      0       40488  0.000074
24  132772      9  2.387146  10.882389     90059.0             1              1              0              0              0               2.387146                    0.0                    0.0                    0.0      0       40488  0.001235
25  132774      0  1.021268   2.776713     90059.0             1              1              0              0              0               1.021268                    0.0                    0.0                    0.0      0       40488  0.001136
26  132774      4  1.507882   4.517154     90059.0             1              1              0              0              0               1.507882                    0.0                    0.0                    0.0      0       40488  0.000198
27  132774      7  1.816779   6.152013     90059.0             1              1              0              0              0               1.816779                    0.0                    0.0                    0.0      0       40488  0.000025
28  132774      1  2.269645   9.675964     90059.0             1              1              0              0              0               2.269645                    0.0                    0.0                    0.0      0       40488  0.000049
29  132774      9  2.373282  10.732561     90059.0             1              1              0              0              0               2.373282                    0.0                    0.0                    0.0      0       40488  0.001087
30  132775      0  0.943832   2.569810     90059.0             1              1              0              0              0               0.943832                    0.0                    0.0                    0.0      0       40488  0.002322
31  132775      4  1.464439   4.325118     90059.0             1              1              0              0              0               1.464439                    0.0                    0.0                    0.0      0       40488  0.000346
32  132775      7  1.850678   6.364134     90059.0             1              1              0              0              0               1.850678                    0.0                    0.0                    0.0      0       40488  0.000099
33  132775      1  2.251602   9.502947     90059.0             1              1              0              0              0               2.251602                    0.0                    0.0                    0.0      0       40488  0.000074
34  132775      9  2.384357  10.852086     90059.0             1              1              0              0              0               2.384357                    0.0                    0.0                    0.0      0       40488  0.001630
35  132776      0  0.887535   2.429133     90059.0             1              1              0              0              0               0.887535                    0.0                    0.0                    0.0      0       40488  0.001186
36  132776      4  1.415862   4.120036     90059.0             1              1              0              0              0               1.415862                    0.0                    0.0                    0.0      0       40488  0.000395
37  132776      7  1.879925   6.553017     90059.0             1              1              0              0              0               1.879925                    0.0                    0.0                    0.0      0       40488  0.000074
38  132776      1  2.229868   9.298637     90059.0             1              1              0              0              0               2.229868                    0.0                    0.0                    0.0      0       40488  0.000074
39  132776      9  2.401359  11.038164     90059.0             1              1              0              0              0               2.401359                    0.0                    0.0                    0.0      0       40488  0.001037
40  132792      0  0.788905   2.200984     90059.0             1              1              0              0              0               0.788905                    0.0                    0.0                    0.0      0       40488  0.003779
41  132792      4  1.462907   4.318494     90059.0             1              1              0              0              0               1.462907                    0.0                    0.0                    0.0      0       40488  0.000617
42  132792      7  1.889494   6.616020     90059.0             1              1              0              0              0               1.889494                    0.0                    0.0                    0.0      0       40488  0.000148
43  132792      1  2.258765   9.571262     90059.0             1              1              0              0              0               2.258765                    0.0                    0.0                    0.0      0       40488  0.000074
44  132792      9  2.363775  10.631010     90059.0             1              1              0              0              0               2.363775                    0.0                    0.0                    0.0      0       40488  0.003112
45  132793      0  0.782841   2.187679     90059.0             1              1              0              0              0               0.782841                    0.0                    0.0                    0.0      0       40488  0.003161
46  132793      4  1.473780   4.365707     90059.0             1              1              0              0              0               1.473780                    0.0                    0.0                    0.0      0       40488  0.000568
47  132793      7  1.890205   6.620723     90059.0             1              1              0              0              0               1.890205                    0.0                    0.0                    0.0      0       40488  0.000049
48  132793      1  2.264449   9.625818     90059.0             1              1              0              0              0               2.264449                    0.0                    0.0                    0.0      0       40488  0.000049
49  132793      9  2.357149  10.560804     90059.0             1              1              0              0              0               2.357149                    0.0                    0.0                    0.0      0       40488  0.002593
50  132794      0  0.887200   2.428321     90059.0             1              1              0              0              0               0.887200                    0.0                    0.0                    0.0      0       40488  0.001260
51  132794      4  1.526687   4.602902     90059.0             1              1              0              0              0               1.526687                    0.0                    0.0                    0.0      0       40488  0.000148
52  132794      7  1.852737   6.377253     90059.0             1              1              0              0              0               1.852737                    0.0                    0.0                    0.0      0       40488  0.000099
53  132794      1  2.287930   9.854524     90059.0             1              1              0              0              0               2.287930                    0.0                    0.0                    0.0      0       40488  0.000049
54  132794      9  2.338092  10.361449     90059.0             1              1              0              0              0               2.338092                    0.0                    0.0                    0.0      0       40488  0.000766
55  132795      0  0.939920   2.559777     90059.0             1              1              0              0              0               0.939920                    0.0                    0.0                    0.0      0       40488  0.000420
56  132795      4  1.556965   4.744402     90059.0             1              1              0              0              0               1.556965                    0.0                    0.0                    0.0      0       40488  0.000025
pi_init:
[[ 4.18485945  0.67678246 -2.11040137  0.11467088]]
Weight distribution by market:
count    10.0
mean      1.0
std       0.0
min       1.0
25%       1.0
50%       1.0
75%       1.0
max       1.0
Name: weights, dtype: float64
Estimating demand...
agent_vars: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
iv_df:
             demand_instruments0  demand_instruments1  demand_instruments2  demand_instruments3
market_ids                                                                                    
90059.0                1.227930             0.000000                  0.0             0.000000
90201.0                1.320389             0.000000                  0.0             0.000000
90277.0                0.000000             0.000000                  0.0             1.932899
90290.0                0.000000             0.000000                  0.0             2.839824
90302.0                0.000000             1.622382                  0.0             0.000000
Initializing the problem ...
Initialized the problem after 00:00:00.

Dimensions:
===========================================
 T    N    F     I     K1    K2    D    MD 
---  ---  ---  -----  ----  ----  ---  ----
10   10    1   11516   7     1     4    10 
===========================================

Formulations:
==================================================================================================================================================
       Column Indices:                   0                      1                      2                      3                  4         5    6 
-----------------------------  ---------------------  ---------------------  ---------------------  ---------------------  -------------  ---  ---
 X1: Linear Characteristics              1                   prices              hpi_quantile1          hpi_quantile2      hpi_quantile3   X    Y 
X2: Nonlinear Characteristics            1                                                                                                        
       d: Demographics         logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4                         
==================================================================================================================================================
pi_init: [[ 4.18485945  0.67678246 -2.11040137  0.11467088]]
pi_lb: [[-inf -inf -inf -inf]]
pi_ub: [[inf inf inf inf]]
Solving with one core...
Solving the problem ...

Nonlinear Coefficient Initial Values:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +4.18E+00              +6.77E-01              -2.11E+00              +1.15E-01      
=====================================================================================================================

Nonlinear Coefficient Lower Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           -INF                   -INF                   -INF                   -INF         
=====================================================================================================================

Nonlinear Coefficient Upper Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           +INF                   +INF                   +INF                   +INF         
=====================================================================================================================

The model may be under-identified. The total number of unfixed parameters is 11, which is more than the total number of moments, 10. Consider checking whether instruments were properly specified when initializing the problem, and whether parameters were properly configured when solving the problem.
Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 1     00:00:00         0             1           141          141         0     +3.48E-03               +5.27E-02  +4.18E+00, +6.77E-01, -2.11E+00, +1.15E-01
 1     00:00:00         1             2           137          137         0     +2.29E-03   +1.19E-03   +1.60E-02  +4.18E+00, +6.92E-01, -2.12E+00, +6.20E-02
 1     00:00:00         2             3           137          137         0     +2.10E-03   +1.97E-04   +1.01E-02  +4.18E+00, +6.96E-01, -2.11E+00, +6.94E-02
 1     00:00:00         3             4           137          137         0     +1.90E-03   +1.96E-04   +6.52E-03  +4.18E+00, +7.08E-01, -2.09E+00, +7.03E-02
 1     00:00:00         4             5           140          140         0     +1.80E-03   +9.76E-05   +5.14E-03  +4.18E+00, +7.21E-01, -2.07E+00, +6.42E-02
 1     00:00:00         5             6           140          140         0     +1.79E-03   +1.08E-05   +1.56E-03  +4.18E+00, +7.22E-01, -2.07E+00, +6.10E-02
 1     00:00:00         6             7           138          138         0     +1.79E-03   +6.07E-06   +8.22E-04  +4.18E+00, +7.24E-01, -2.06E+00, +5.84E-02
 1     00:00:00         7             8           140          140         0     +1.78E-03   +1.17E-06   +8.16E-04  +4.18E+00, +7.23E-01, -2.06E+00, +5.76E-02
 1     00:00:00         8             9           140          140         0     +1.78E-03   +4.48E-06   +1.24E-03  +4.18E+00, +7.18E-01, -2.06E+00, +5.49E-02
 1     00:00:00         9            10           140          140         0     +1.78E-03   +8.35E-07   +4.63E-04  +4.18E+00, +7.18E-01, -2.06E+00, +5.55E-02
 1     00:00:00         10           11           140          140         0     +1.78E-03   +2.00E-06   +4.12E-04  +4.17E+00, +7.14E-01, -2.05E+00, +5.41E-02
 1     00:00:00         11           12           140          140         0     +1.78E-03   +1.47E-07   +4.12E-04  +4.17E+00, +7.14E-01, -2.05E+00, +5.40E-02
 1     00:00:00         12           13           140          140         0     +1.77E-03   +6.14E-06   +1.71E-03  +4.15E+00, +7.16E-01, -2.06E+00, +5.37E-02
 1     00:00:00         13           14           140          140         0     +1.77E-03   +1.01E-06   +9.77E-04  +4.15E+00, +7.16E-01, -2.06E+00, +5.43E-02
 1     00:00:00         14           15           140          140         0     +1.75E-03   +2.02E-05   +3.34E-04  +4.10E+00, +7.17E-01, -2.06E+00, +5.61E-02
 1     00:00:00         15           16           140          140         0     +1.70E-03   +4.74E-05   +1.29E-03  +3.83E+00, +7.18E-01, -2.06E+00, +5.82E-02
 1     00:00:00         16           17           142          142         0     +1.70E-03   +7.14E-07   +2.86E-04  +3.83E+00, +7.18E-01, -2.06E+00, +5.72E-02
 1     00:00:00         17           18           139          139         0     +1.70E-03   +8.79E-07   +3.39E-05  +3.83E+00, +7.16E-01, -2.06E+00, +5.56E-02
 1     00:00:00         18           19           141          141         0     +1.70E-03   +5.09E-07   +1.59E-05  +3.80E+00, +7.15E-01, -2.06E+00, +5.56E-02
 1     00:00:00         19           20           142          142         0     +1.70E-03   +7.09E-10   +7.56E-07  +3.80E+00, +7.15E-01, -2.06E+00, +5.56E-02
 1     00:00:00         20           21           141          141         0     +1.70E-03   +1.73E-12   +2.07E-07  +3.80E+00, +7.15E-01, -2.06E+00, +5.56E-02
 1     00:00:00         21           22           142          142         0     +1.70E-03   +4.59E-12   +5.50E-09  +3.80E+00, +7.15E-01, -2.06E+00, +5.56E-02
 1     00:00:00         22           23           142          142         0     +1.70E-03   +8.26E-16   +1.45E-09  +3.80E+00, +7.15E-01, -2.06E+00, +5.56E-02
 1     00:00:00         23           24           142          142         0     +1.70E-03               +9.98E-11  +3.80E+00, +7.15E-01, -2.06E+00, +5.56E-02
 1     00:00:00         24           25           141          141         0     +1.70E-03   +2.17E-19   +9.97E-11  +3.80E+00, +7.15E-01, -2.06E+00, +5.56E-02

Optimization completed after 00:00:01.
Computing the Hessian and and updating the weighting matrix ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +1.53E+19. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
=====================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number
----  ---------  ---------  --------------  --------------  -------  ----------------
 1    +1.70E-03  +9.97E-11    +1.14E-03       +1.26E+00        0        +1.43E+05    
=====================================================================================

Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 2     00:00:00         0             1           46           46          0     +6.57E+00               +1.12E+02  +3.80E+00, +7.15E-01, -2.06E+00, +5.56E-02
 2     00:00:00         1             2           130          130         0     +1.65E+03               +2.79E+03  +3.80E+00, +5.86E-02, -1.68E+00, +7.07E-01
 2     00:00:00         2             3           98           98          0     +1.47E+00   +5.10E+00   +5.03E+01  +3.80E+00, +6.87E-01, -2.02E+00, +8.99E-02
 2     00:00:00         3             4           98           98          0     +5.27E-01   +9.46E-01   +2.73E+01  +3.80E+00, +6.96E-01, -2.01E+00, +9.84E-02
 2     00:00:00         4             5           98           98          0     +5.46E-04   +5.27E-01   +1.65E+00  +3.80E+00, +7.01E-01, -1.99E+00, +1.16E-01
 2     00:00:00         5             6           98           98          0     +4.27E-07   +5.45E-04   +6.50E-02  +3.80E+00, +7.00E-01, -1.99E+00, +1.16E-01
 2     00:00:00         6             7           98           98          0     +1.79E-09   +4.25E-07   +1.71E-03  +3.80E+00, +7.00E-01, -1.99E+00, +1.16E-01
 2     00:00:00         7             8           98           98          0     +2.06E-09               +1.76E-03  +3.80E+00, +7.00E-01, -1.99E+00, +1.16E-01
 2     00:00:00         8             9           98           98          0     +8.11E-09               +5.18E-03  +3.80E+00, +7.00E-01, -1.99E+00, +1.16E-01
 2     00:00:00         9            10           98           98          0     +2.74E-08               +1.25E-02  +3.80E+00, +7.00E-01, -1.99E+00, +1.16E-01
 2     00:00:00         10           11           102          102         0     +9.60E-08               +2.62E-02  +3.80E+00, +7.00E-01, -1.99E+00, +1.16E-01
 2     00:00:00         11           12           98           98          0     +1.66E-08               +7.33E-03  +3.80E+00, +7.00E-01, -1.99E+00, +1.16E-01
 2     00:00:00         12           13           98           98          0     +1.13E-08               +5.91E-03  +3.80E+00, +7.00E-01, -1.99E+00, +1.16E-01
 2     00:00:00         13           14           98           98          0     +4.28E-09               +2.96E-03  +3.80E+00, +7.00E-01, -1.99E+00, +1.16E-01
 2     00:00:00         14           15           98           98          0     +7.92E-09               +5.15E-03  +3.80E+00, +7.00E-01, -1.99E+00, +1.16E-01
 2     00:00:00         15           16           98           98          0     +6.08E-09               +4.10E-03  +3.80E+00, +7.00E-01, -1.99E+00, +1.16E-01
 2     00:00:00         16           17           98           98          0     +3.02E-09               +2.41E-03  +3.80E+00, +7.00E-01, -1.99E+00, +1.16E-01
 2     00:00:00         17           18           98           98          0     +2.17E-09               +1.86E-03  +3.80E+00, +7.00E-01, -1.99E+00, +1.16E-01
 2     00:00:00         18           19           98           98          0     +1.92E-09               +1.72E-03  +3.80E+00, +7.00E-01, -1.99E+00, +1.16E-01
 2     00:00:00         19           20           98           98          0     +1.84E-09               +1.68E-03  +3.80E+00, +7.00E-01, -1.99E+00, +1.16E-01
 2     00:00:00         20           21           98           98          0     +1.81E-09               +1.67E-03  +3.80E+00, +7.00E-01, -1.99E+00, +1.16E-01
 2     00:00:00         21           22           98           98          0     +1.80E-09               +1.66E-03  +3.80E+00, +7.00E-01, -1.99E+00, +1.16E-01
 2     00:00:00         22           23           98           98          0     +1.79E-09               +1.67E-03  +3.80E+00, +7.00E-01, -1.99E+00, +1.16E-01
 2     00:00:00         23           24           98           98          0     +1.79E-09               +1.69E-03  +3.80E+00, +7.00E-01, -1.99E+00, +1.16E-01

Optimization completed after 00:00:01.
Computing the Hessian and estimating standard errors ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +2.80E+20. To disable singularity checks, set options.singular_tol = numpy.inf.

Failed to compute standard errors because of invalid estimated covariances of GMM parameters.

Computed results after 00:00:00.

Problem Results Summary:
========================================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix  Covariance Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number  Condition Number 
----  ---------  ---------  --------------  --------------  -------  ----------------  -----------------
 2    +1.79E-09  +1.71E-03    -5.71E+01       +5.36E+03        0        +1.54E+30          +5.65E+21    
========================================================================================================

Cumulative Statistics:
===========================================================================
Computation  Optimizer  Optimization   Objective   Fixed Point  Contraction
   Time      Converged   Iterations   Evaluations  Iterations   Evaluations
-----------  ---------  ------------  -----------  -----------  -----------
 00:00:02       Yes          49           51          6077         6077    
===========================================================================

Nonlinear Coefficient Estimates (Robust SEs in Parentheses):
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +3.80E+00              +7.00E-01              -1.99E+00              +1.16E-01      
                   |            (+7.58E-02)            (+5.29E-02)            (+2.79E-02)            (+5.11E-02)     
=====================================================================================================================

Beta Estimates (Robust SEs in Parentheses):
===============================================================================================
     1         prices     hpi_quantile1  hpi_quantile2  hpi_quantile3       X            Y     
-----------  -----------  -------------  -------------  -------------  -----------  -----------
 +2.70E+00    -1.54E-11     -4.70E+00      -2.05E+00      +4.30E+00     -6.13E+00    -1.48E+00 
(+1.67E-01)     (NAN)      (+1.14E-01)    (+1.93E-01)    (+1.68E-01)   (+3.47E-02)  (+8.97E-02)
===============================================================================================
Computing delta ...
Finished after 00:00:00.

Mean delta: 1.0681028812673041
pi labels: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
ii=0, vv=logdistXhpi_quantile1
logdistXhpi_quantile1 is a distance term, omitting from ABD and adding to coefficients instead
ii=1, vv=logdistXhpi_quantile2
logdistXhpi_quantile2 is a distance term, omitting from ABD and adding to coefficients instead
ii=2, vv=logdistXhpi_quantile3
logdistXhpi_quantile3 is a distance term, omitting from ABD and adding to coefficients instead
ii=3, vv=logdistXhpi_quantile4
logdistXhpi_quantile4 is a distance term, omitting from ABD and adding to coefficients instead

Distance coefficients: [3.80343, 0.7004, -1.98553, 0.11602]

Computed abepsilon in: 0.011 seconds.
Assigning individuals...
time3 - time2: 0.362
time4 - time3: 2.164
Number of full locations: 15  out of  18
Offers:
% Rank 0 offers: 47.16388
% Rank 1 offers: 8.68162
% Rank 2 offers: 4.30471
% Rank 3 offers: 2.84294
% Rank 4 offers: 37.00684
% Offered any: 100.0
Mean offer distance: 1.57950
Quantiles of offered distances:
0.0 quantile: -2.65569
0.1 quantile: 0.33131
0.2 quantile: 0.73625
0.3 quantile: 1.05770
0.4 quantile: 1.34582
0.5 quantile: 1.70593
0.6 quantile: 2.10892
0.7 quantile: 2.23092
0.8 quantile: 2.37102
0.9 quantile: 2.60348
1.0 quantile: 3.19221
Assignments:
% Rank 0 assignments: 29.85970
% Rank 1 assignments: 7.31148
% Rank 2 assignments: 3.84529
% Rank 3 assignments: 2.62111
% Rank 4 assignments: 32.15947
% Assigned: 75.79704
Mean assignment distance: 1.75170
Quantiles of assignment distances:
0.0 quantile: -2.05992
0.1 quantile: 0.66617
0.2 quantile: 1.00820
0.3 quantile: 1.27545
0.4 quantile: 1.58887
0.5 quantile: 2.02600
0.6 quantile: 2.16129
0.7 quantile: 2.26044
0.8 quantile: 2.39149
0.9 quantile: 2.60214
1.0 quantile: 3.19221
Violations:
Max violation: 31925
Number of locations with violations: 15
Number of individuals with violations: 137343
Mean violation (conditional on violation): 9156.2
Median violation (conditional on violation): 6914.0
Number of markets with wasserstein distance > 0.001: 9
Mean wasserstein distance for markets with wasserstein distance > 0.001: 0.013236370745714666
Mean wasserstein distance: 0.011920787554099584
Max wasserstein distance: 0.05207642598801555
Index of max wasserstein distance: 9
Iteration 9 complete.


Number of agents: 11538

Iteration 10:

agent_loc_data:
     blkid  locid   logdist       dist  market_ids  hpi_quantile  hpi_quantile1  hpi_quantile2  hpi_quantile3  hpi_quantile4  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4  nodes  population   weights
0   132759      0  0.737546   2.090799     90059.0             1              1              0              0              0               0.737546                    0.0                    0.0                    0.0      0       40488  0.000198
4   132759     16  2.388723  10.899569     90059.0             1              1              0              0              0               2.388723                    0.0                    0.0                    0.0      0       40488  0.000198
5   132760      0  0.817771   2.265445     90059.0             1              1              0              0              0               0.817771                    0.0                    0.0                    0.0      0       40488  0.000988
6   132760      4  1.368392   3.929026     90059.0             1              1              0              0              0               1.368392                    0.0                    0.0                    0.0      0       40488  0.000272
7   132760      7  1.909226   6.747865     90059.0             1              1              0              0              0               1.909226                    0.0                    0.0                    0.0      0       40488  0.000049
8   132760      1  2.210262   9.118109     90059.0             1              1              0              0              0               2.210262                    0.0                    0.0                    0.0      0       40488  0.000025
9   132760     16  2.407625  11.107545     90059.0             1              1              0              0              0               2.407625                    0.0                    0.0                    0.0      0       40488  0.000766
10  132761      0  0.835924   2.306944     90059.0             1              1              0              0              0               0.835924                    0.0                    0.0                    0.0      0       40488  0.000074
14  132761      9  2.405422  11.083104     90059.0             1              1              0              0              0               2.405422                    0.0                    0.0                    0.0      0       40488  0.000123
15  132763      0  0.685177   1.984123     90059.0             1              1              0              0              0               0.685177                    0.0                    0.0                    0.0      0       40488  0.000123
16  132763      4  1.317212   3.733000     90059.0             1              1              0              0              0               1.317212                    0.0                    0.0                    0.0      0       40488  0.000049
19  132763     16  2.382397  10.830829     90059.0             1              1              0              0              0               2.382397                    0.0                    0.0                    0.0      0       40488  0.000123
20  132772      0  0.959576   2.610589     90059.0             1              1              0              0              0               0.959576                    0.0                    0.0                    0.0      0       40488  0.001803
21  132772      4  1.464425   4.325055     90059.0             1              1              0              0              0               1.464425                    0.0                    0.0                    0.0      0       40488  0.000272
22  132772      7  1.847489   6.343871     90059.0             1              1              0              0              0               1.847489                    0.0                    0.0                    0.0      0       40488  0.000049
23  132772      1  2.250480   9.492289     90059.0             1              1              0              0              0               2.250480                    0.0                    0.0                    0.0      0       40488  0.000025
24  132772      9  2.387146  10.882389     90059.0             1              1              0              0              0               2.387146                    0.0                    0.0                    0.0      0       40488  0.001186
25  132774      0  1.021268   2.776713     90059.0             1              1              0              0              0               1.021268                    0.0                    0.0                    0.0      0       40488  0.001161
26  132774      4  1.507882   4.517154     90059.0             1              1              0              0              0               1.507882                    0.0                    0.0                    0.0      0       40488  0.000247
27  132774      7  1.816779   6.152013     90059.0             1              1              0              0              0               1.816779                    0.0                    0.0                    0.0      0       40488  0.000049
29  132774      9  2.373282  10.732561     90059.0             1              1              0              0              0               2.373282                    0.0                    0.0                    0.0      0       40488  0.001037
30  132775      0  0.943832   2.569810     90059.0             1              1              0              0              0               0.943832                    0.0                    0.0                    0.0      0       40488  0.002346
31  132775      4  1.464439   4.325118     90059.0             1              1              0              0              0               1.464439                    0.0                    0.0                    0.0      0       40488  0.000370
32  132775      7  1.850678   6.364134     90059.0             1              1              0              0              0               1.850678                    0.0                    0.0                    0.0      0       40488  0.000123
33  132775      1  2.251602   9.502947     90059.0             1              1              0              0              0               2.251602                    0.0                    0.0                    0.0      0       40488  0.000049
34  132775      9  2.384357  10.852086     90059.0             1              1              0              0              0               2.384357                    0.0                    0.0                    0.0      0       40488  0.001581
35  132776      0  0.887535   2.429133     90059.0             1              1              0              0              0               0.887535                    0.0                    0.0                    0.0      0       40488  0.001260
36  132776      4  1.415862   4.120036     90059.0             1              1              0              0              0               1.415862                    0.0                    0.0                    0.0      0       40488  0.000395
37  132776      7  1.879925   6.553017     90059.0             1              1              0              0              0               1.879925                    0.0                    0.0                    0.0      0       40488  0.000099
38  132776      1  2.229868   9.298637     90059.0             1              1              0              0              0               2.229868                    0.0                    0.0                    0.0      0       40488  0.000074
39  132776      9  2.401359  11.038164     90059.0             1              1              0              0              0               2.401359                    0.0                    0.0                    0.0      0       40488  0.000939
40  132792      0  0.788905   2.200984     90059.0             1              1              0              0              0               0.788905                    0.0                    0.0                    0.0      0       40488  0.003804
41  132792      4  1.462907   4.318494     90059.0             1              1              0              0              0               1.462907                    0.0                    0.0                    0.0      0       40488  0.000667
42  132792      7  1.889494   6.616020     90059.0             1              1              0              0              0               1.889494                    0.0                    0.0                    0.0      0       40488  0.000198
43  132792      1  2.258765   9.571262     90059.0             1              1              0              0              0               2.258765                    0.0                    0.0                    0.0      0       40488  0.000025
44  132792      9  2.363775  10.631010     90059.0             1              1              0              0              0               2.363775                    0.0                    0.0                    0.0      0       40488  0.003038
45  132793      0  0.782841   2.187679     90059.0             1              1              0              0              0               0.782841                    0.0                    0.0                    0.0      0       40488  0.003211
46  132793      4  1.473780   4.365707     90059.0             1              1              0              0              0               1.473780                    0.0                    0.0                    0.0      0       40488  0.000568
47  132793      7  1.890205   6.620723     90059.0             1              1              0              0              0               1.890205                    0.0                    0.0                    0.0      0       40488  0.000049
48  132793      1  2.264449   9.625818     90059.0             1              1              0              0              0               2.264449                    0.0                    0.0                    0.0      0       40488  0.000049
49  132793      9  2.357149  10.560804     90059.0             1              1              0              0              0               2.357149                    0.0                    0.0                    0.0      0       40488  0.002544
50  132794      0  0.887200   2.428321     90059.0             1              1              0              0              0               0.887200                    0.0                    0.0                    0.0      0       40488  0.001260
51  132794      4  1.526687   4.602902     90059.0             1              1              0              0              0               1.526687                    0.0                    0.0                    0.0      0       40488  0.000247
52  132794      7  1.852737   6.377253     90059.0             1              1              0              0              0               1.852737                    0.0                    0.0                    0.0      0       40488  0.000049
53  132794      1  2.287930   9.854524     90059.0             1              1              0              0              0               2.287930                    0.0                    0.0                    0.0      0       40488  0.000025
54  132794      9  2.338092  10.361449     90059.0             1              1              0              0              0               2.338092                    0.0                    0.0                    0.0      0       40488  0.000741
55  132795      0  0.939920   2.559777     90059.0             1              1              0              0              0               0.939920                    0.0                    0.0                    0.0      0       40488  0.000420
56  132795      4  1.556965   4.744402     90059.0             1              1              0              0              0               1.556965                    0.0                    0.0                    0.0      0       40488  0.000025
59  132795      9  2.325947  10.236375     90059.0             1              1              0              0              0               2.325947                    0.0                    0.0                    0.0      0       40488  0.000173
60  132796      0  0.770565   2.160988     90059.0             1              1              0              0              0               0.770565                    0.0                    0.0                    0.0      0       40488  0.004075
pi_init:
[[ 3.80342793  0.70040145 -1.98552984  0.11602091]]
Weight distribution by market:
count    10.0
mean      1.0
std       0.0
min       1.0
25%       1.0
50%       1.0
75%       1.0
max       1.0
Name: weights, dtype: float64
Estimating demand...
agent_vars: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
iv_df:
             demand_instruments0  demand_instruments1  demand_instruments2  demand_instruments3
market_ids                                                                                    
90059.0                1.204176             0.000000                  0.0             0.000000
90201.0                1.298707             0.000000                  0.0             0.000000
90277.0                0.000000             0.000000                  0.0             1.927108
90290.0                0.000000             0.000000                  0.0             2.839736
90302.0                0.000000             1.619503                  0.0             0.000000
Initializing the problem ...
Initialized the problem after 00:00:00.

Dimensions:
===========================================
 T    N    F     I     K1    K2    D    MD 
---  ---  ---  -----  ----  ----  ---  ----
10   10    1   11538   7     1     4    10 
===========================================

Formulations:
==================================================================================================================================================
       Column Indices:                   0                      1                      2                      3                  4         5    6 
-----------------------------  ---------------------  ---------------------  ---------------------  ---------------------  -------------  ---  ---
 X1: Linear Characteristics              1                   prices              hpi_quantile1          hpi_quantile2      hpi_quantile3   X    Y 
X2: Nonlinear Characteristics            1                                                                                                        
       d: Demographics         logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4                         
==================================================================================================================================================
pi_init: [[ 3.80342793  0.70040145 -1.98552984  0.11602091]]
pi_lb: [[-inf -inf -inf -inf]]
pi_ub: [[inf inf inf inf]]
Solving with one core...
Solving the problem ...

Nonlinear Coefficient Initial Values:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +3.80E+00              +7.00E-01              -1.99E+00              +1.16E-01      
=====================================================================================================================

Nonlinear Coefficient Lower Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           -INF                   -INF                   -INF                   -INF         
=====================================================================================================================

Nonlinear Coefficient Upper Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           +INF                   +INF                   +INF                   +INF         
=====================================================================================================================

The model may be under-identified. The total number of unfixed parameters is 11, which is more than the total number of moments, 10. Consider checking whether instruments were properly specified when initializing the problem, and whether parameters were properly configured when solving the problem.
Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 1     00:00:00         0             1           143          143         0     +5.80E-03               +9.57E-02  +3.80E+00, +7.00E-01, -1.99E+00, +1.16E-01
 1     00:00:00         1             2           140          140         0     +1.84E-03   +3.96E-03   +3.25E-02  +3.80E+00, +7.07E-01, -2.03E+00, +2.03E-02
 1     00:00:00         2             3           139          139         0     +1.35E-03   +4.87E-04   +6.69E-03  +3.80E+00, +7.00E-01, -2.03E+00, +4.37E-02
 1     00:00:00         3             4           139          139         0     +1.27E-03   +8.60E-05   +6.90E-03  +3.80E+00, +6.96E-01, -2.04E+00, +5.02E-02
 1     00:00:00         4             5           140          140         0     +1.16E-03   +1.10E-04   +4.08E-03  +3.80E+00, +6.86E-01, -2.06E+00, +6.06E-02
 1     00:00:00         5             6           140          140         0     +1.14E-03   +2.20E-05   +1.97E-03  +3.80E+00, +6.86E-01, -2.07E+00, +6.18E-02
 1     00:00:00         6             7           139          139         0     +1.12E-03   +1.06E-05   +1.69E-03  +3.80E+00, +6.88E-01, -2.08E+00, +6.23E-02
 1     00:00:00         7             8           140          140         0     +1.12E-03   +3.45E-06   +1.46E-03  +3.80E+00, +6.90E-01, -2.08E+00, +6.22E-02
 1     00:00:00         8             9           139          139         0     +1.11E-03   +7.57E-06   +1.81E-03  +3.80E+00, +6.99E-01, -2.08E+00, +6.36E-02
 1     00:00:00         9            10           140          140         0     +1.11E-03   +1.18E-06   +8.02E-04  +3.80E+00, +6.99E-01, -2.08E+00, +6.45E-02
 1     00:00:00         10           11           139          139         0     +1.11E-03   +2.45E-06   +9.26E-05  +3.81E+00, +7.03E-01, -2.08E+00, +6.73E-02
 1     00:00:00         11           12           140          140         0     +1.11E-03   +2.40E-08   +9.28E-05  +3.81E+00, +7.03E-01, -2.08E+00, +6.75E-02
 1     00:00:00         12           13           140          140         0     +1.11E-03   +7.93E-09   +9.28E-05  +3.81E+00, +7.03E-01, -2.08E+00, +6.75E-02
 1     00:00:00         13           14           140          140         0     +1.11E-03   +2.17E-07   +3.57E-04  +3.81E+00, +7.03E-01, -2.08E+00, +6.79E-02
 1     00:00:00         14           15           140          140         0     +1.11E-03   +3.98E-08   +2.17E-04  +3.81E+00, +7.03E-01, -2.08E+00, +6.77E-02
 1     00:00:00         15           16           140          140         0     +1.11E-03   +7.45E-07   +9.39E-05  +3.82E+00, +7.04E-01, -2.08E+00, +6.76E-02
 1     00:00:00         16           17           138          138         0     +1.11E-03   +3.23E-06   +6.32E-04  +3.88E+00, +7.04E-01, -2.09E+00, +6.74E-02
 1     00:00:00         17           18           138          138         0     +1.11E-03   +1.86E-07   +1.73E-04  +3.88E+00, +7.04E-01, -2.09E+00, +6.77E-02
 1     00:00:00         18           19           138          138         0     +1.11E-03   +8.38E-08   +4.95E-05  +3.88E+00, +7.03E-01, -2.09E+00, +6.78E-02
 1     00:00:00         19           20           138          138         0     +1.11E-03   +3.15E-07   +2.13E-05  +3.91E+00, +7.03E-01, -2.09E+00, +6.77E-02
 1     00:00:00         20           21           138          138         0     +1.11E-03   +6.34E-10   +4.46E-06  +3.91E+00, +7.03E-01, -2.08E+00, +6.76E-02
 1     00:00:00         21           22           138          138         0     +1.11E-03   +8.55E-10   +1.01E-07  +3.91E+00, +7.03E-01, -2.08E+00, +6.76E-02
 1     00:00:00         22           23           138          138         0     +1.11E-03   +6.30E-15   +1.88E-08  +3.91E+00, +7.03E-01, -2.08E+00, +6.76E-02
 1     00:00:00         23           24           138          138         0     +1.11E-03   +1.63E-15   +4.24E-09  +3.91E+00, +7.03E-01, -2.08E+00, +6.76E-02
 1     00:00:00         24           25           138          138         0     +1.11E-03   +1.01E-14   +1.01E-10  +3.91E+00, +7.03E-01, -2.08E+00, +6.76E-02
 1     00:00:00         25           26           138          138         0     +1.11E-03   +1.81E-16   +2.94E-11  +3.91E+00, +7.03E-01, -2.08E+00, +6.76E-02

Optimization completed after 00:00:01.
Computing the Hessian and and updating the weighting matrix ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +7.51E+18. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
=====================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number
----  ---------  ---------  --------------  --------------  -------  ----------------
 1    +1.11E-03  +2.94E-11    +8.68E-04       +1.28E+00        0        +1.40E+05    
=====================================================================================

Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 2     00:00:00         0             1           48           48          0     +6.64E+00               +1.53E+02  +3.91E+00, +7.03E-01, -2.08E+00, +6.76E-02
 2     00:00:00         1             2           129          129         0     +3.08E+03               +4.86E+03  +3.91E+00, +6.55E-02, -1.71E+00, +7.43E-01
 2     00:00:00         2             3           96           96          0     +1.76E+00   +4.88E+00   +6.21E+01  +3.91E+00, +6.82E-01, -2.06E+00, +9.23E-02
 2     00:00:00         3             4           98           98          0     +8.02E-01   +9.55E-01   +4.17E+01  +3.91E+00, +6.88E-01, -2.05E+00, +9.86E-02
 2     00:00:00         4             5           94           94          0     +1.23E-04   +8.02E-01   +1.17E+00  +3.91E+00, +6.96E-01, -2.03E+00, +1.15E-01
 2     00:00:00         5             6           94           94          0     +3.81E-08   +1.23E-04   +2.68E-02  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         6             7           94           94          0     +7.45E-09   +3.07E-08   +4.63E-03  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         7             8           94           94          0     +6.62E-09   +8.37E-10   +4.05E-03  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         8             9           94           94          0     +3.29E-08               +2.64E-02  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         9            10           94           94          0     +1.53E-07               +5.14E-02  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         10           11           96           96          0     +7.23E-07               +1.05E-01  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         11           12           98           98          0     +2.30E-07               +2.81E-02  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         12           13           94           94          0     +7.79E-08               +2.19E-02  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         13           14           94           94          0     +1.56E-08               +1.07E-02  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         14           15           94           94          0     +4.41E-09   +2.21E-09   +7.11E-03  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         15           16           94           94          0     +1.45E-08               +5.29E-03  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         16           17           94           94          0     +6.41E-08               +1.18E-02  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         17           18           94           94          0     +1.97E-08               +5.50E-03  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         18           19           94           94          0     +5.15E-09               +5.92E-03  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         19           20           94           94          0     +1.77E-09   +2.64E-09   +6.92E-03  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         20           21           94           94          0     +6.91E-09               +5.22E-03  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         21           22           94           94          0     +3.11E-09               +5.01E-03  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         22           23           94           94          0     +1.77E-09               +4.93E-03  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         23           24           94           94          0     +1.61E-09   +1.65E-10   +5.39E-03  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         24           25           94           94          0     +1.76E-09               +4.89E-03  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         25           26           94           94          0     +1.66E-09               +4.89E-03  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         26           27           94           94          0     +1.63E-09               +5.08E-03  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         27           28           94           94          0     +1.61E-09               +5.24E-03  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 2     00:00:00         28           29           94           94          0     +1.61E-09               +5.32E-03  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01

Optimization completed after 00:00:01.
Computing the Hessian and estimating standard errors ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +2.85E+21. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
========================================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix  Covariance Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number  Condition Number 
----  ---------  ---------  --------------  --------------  -------  ----------------  -----------------
 2    +1.61E-09  +5.39E-03    -1.04E+02       +8.59E+03        0        +8.94E+29          +2.92E+20    
========================================================================================================

Cumulative Statistics:
===========================================================================
Computation  Optimizer  Optimization   Objective   Fixed Point  Contraction
   Time      Converged   Iterations   Evaluations  Iterations   Evaluations
-----------  ---------  ------------  -----------  -----------  -----------
 00:00:02       Yes          55           57          6577         6577    
===========================================================================

Nonlinear Coefficient Estimates (Robust SEs in Parentheses):
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +3.91E+00              +6.95E-01              -2.03E+00              +1.15E-01      
                   |            (+5.88E-02)            (+4.03E-02)            (+2.28E-02)            (+4.12E-02)     
=====================================================================================================================

Beta Estimates (Robust SEs in Parentheses):
===============================================================================================
     1         prices     hpi_quantile1  hpi_quantile2  hpi_quantile3       X            Y     
-----------  -----------  -------------  -------------  -------------  -----------  -----------
 +2.82E+00    -1.36E-11     -4.81E+00      -2.14E+00      +4.34E+00     -5.59E+00    -1.71E+00 
(+1.32E-01)  (+6.46E-16)   (+9.27E-02)    (+1.50E-01)    (+1.38E-01)   (+2.60E-02)  (+6.73E-02)
===============================================================================================
Computing delta ...
Finished after 00:00:00.

Mean delta: 1.0996870740043898
pi labels: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
ii=0, vv=logdistXhpi_quantile1
logdistXhpi_quantile1 is a distance term, omitting from ABD and adding to coefficients instead
ii=1, vv=logdistXhpi_quantile2
logdistXhpi_quantile2 is a distance term, omitting from ABD and adding to coefficients instead
ii=2, vv=logdistXhpi_quantile3
logdistXhpi_quantile3 is a distance term, omitting from ABD and adding to coefficients instead
ii=3, vv=logdistXhpi_quantile4
logdistXhpi_quantile4 is a distance term, omitting from ABD and adding to coefficients instead

Distance coefficients: [3.90981, 0.69545, -2.02731, 0.11521]

Computed abepsilon in: 0.011 seconds.
Assigning individuals...
time3 - time2: 0.317
time4 - time3: 2.159
Number of full locations: 15  out of  18
Offers:
% Rank 0 offers: 46.92760
% Rank 1 offers: 8.63804
% Rank 2 offers: 4.27899
% Rank 3 offers: 2.83139
% Rank 4 offers: 37.32397
% Offered any: 100.0
Mean offer distance: 1.58381
Quantiles of offered distances:
0.0 quantile: -2.65569
0.1 quantile: 0.33270
0.2 quantile: 0.74217
0.3 quantile: 1.05948
0.4 quantile: 1.35032
0.5 quantile: 1.71528
0.6 quantile: 2.11233
0.7 quantile: 2.23185
0.8 quantile: 2.37304
0.9 quantile: 2.60348
1.0 quantile: 3.19221
Assignments:
% Rank 0 assignments: 29.89068
% Rank 1 assignments: 7.31620
% Rank 2 assignments: 3.83163
% Rank 3 assignments: 2.61638
% Rank 4 assignments: 32.59816
% Assigned: 76.25306
Mean assignment distance: 1.75493
Quantiles of assignment distances:
0.0 quantile: -2.05992
0.1 quantile: 0.66617
0.2 quantile: 1.01085
0.3 quantile: 1.27724
0.4 quantile: 1.60074
0.5 quantile: 2.03587
0.6 quantile: 2.16340
0.7 quantile: 2.26218
0.8 quantile: 2.39368
0.9 quantile: 2.60348
1.0 quantile: 3.19221
Violations:
Max violation: 32299
Number of locations with violations: 15
Number of individuals with violations: 138584
Mean violation (conditional on violation): 9238.933333333332
Median violation (conditional on violation): 6928.0
Number of markets with wasserstein distance > 0.001: 8
Mean wasserstein distance for markets with wasserstein distance > 0.001: 0.00632287426588541
Mean wasserstein distance: 0.005147071137768434
Max wasserstein distance: 0.026504467385157302
Index of max wasserstein distance: 9
Iteration 10 complete.


Number of agents: 11527

Iteration 11:

agent_loc_data:
     blkid  locid   logdist       dist  market_ids  hpi_quantile  hpi_quantile1  hpi_quantile2  hpi_quantile3  hpi_quantile4  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4  nodes  population   weights
0   132759      0  0.737546   2.090799     90059.0             1              1              0              0              0               0.737546                    0.0                    0.0                    0.0      0       40488  0.000198
4   132759     16  2.388723  10.899569     90059.0             1              1              0              0              0               2.388723                    0.0                    0.0                    0.0      0       40488  0.000198
5   132760      0  0.817771   2.265445     90059.0             1              1              0              0              0               0.817771                    0.0                    0.0                    0.0      0       40488  0.000988
6   132760      4  1.368392   3.929026     90059.0             1              1              0              0              0               1.368392                    0.0                    0.0                    0.0      0       40488  0.000247
7   132760      7  1.909226   6.747865     90059.0             1              1              0              0              0               1.909226                    0.0                    0.0                    0.0      0       40488  0.000049
8   132760      1  2.210262   9.118109     90059.0             1              1              0              0              0               2.210262                    0.0                    0.0                    0.0      0       40488  0.000025
9   132760     16  2.407625  11.107545     90059.0             1              1              0              0              0               2.407625                    0.0                    0.0                    0.0      0       40488  0.000790
10  132761      0  0.835924   2.306944     90059.0             1              1              0              0              0               0.835924                    0.0                    0.0                    0.0      0       40488  0.000074
14  132761      9  2.405422  11.083104     90059.0             1              1              0              0              0               2.405422                    0.0                    0.0                    0.0      0       40488  0.000123
15  132763      0  0.685177   1.984123     90059.0             1              1              0              0              0               0.685177                    0.0                    0.0                    0.0      0       40488  0.000123
16  132763      4  1.317212   3.733000     90059.0             1              1              0              0              0               1.317212                    0.0                    0.0                    0.0      0       40488  0.000049
19  132763     16  2.382397  10.830829     90059.0             1              1              0              0              0               2.382397                    0.0                    0.0                    0.0      0       40488  0.000123
20  132772      0  0.959576   2.610589     90059.0             1              1              0              0              0               0.959576                    0.0                    0.0                    0.0      0       40488  0.001754
21  132772      4  1.464425   4.325055     90059.0             1              1              0              0              0               1.464425                    0.0                    0.0                    0.0      0       40488  0.000272
22  132772      7  1.847489   6.343871     90059.0             1              1              0              0              0               1.847489                    0.0                    0.0                    0.0      0       40488  0.000025
23  132772      1  2.250480   9.492289     90059.0             1              1              0              0              0               2.250480                    0.0                    0.0                    0.0      0       40488  0.000074
24  132772      9  2.387146  10.882389     90059.0             1              1              0              0              0               2.387146                    0.0                    0.0                    0.0      0       40488  0.001210
25  132774      0  1.021268   2.776713     90059.0             1              1              0              0              0               1.021268                    0.0                    0.0                    0.0      0       40488  0.001161
26  132774      4  1.507882   4.517154     90059.0             1              1              0              0              0               1.507882                    0.0                    0.0                    0.0      0       40488  0.000247
27  132774      7  1.816779   6.152013     90059.0             1              1              0              0              0               1.816779                    0.0                    0.0                    0.0      0       40488  0.000049
29  132774      9  2.373282  10.732561     90059.0             1              1              0              0              0               2.373282                    0.0                    0.0                    0.0      0       40488  0.001037
30  132775      0  0.943832   2.569810     90059.0             1              1              0              0              0               0.943832                    0.0                    0.0                    0.0      0       40488  0.002322
31  132775      4  1.464439   4.325118     90059.0             1              1              0              0              0               1.464439                    0.0                    0.0                    0.0      0       40488  0.000370
32  132775      7  1.850678   6.364134     90059.0             1              1              0              0              0               1.850678                    0.0                    0.0                    0.0      0       40488  0.000123
33  132775      1  2.251602   9.502947     90059.0             1              1              0              0              0               2.251602                    0.0                    0.0                    0.0      0       40488  0.000074
34  132775      9  2.384357  10.852086     90059.0             1              1              0              0              0               2.384357                    0.0                    0.0                    0.0      0       40488  0.001581
35  132776      0  0.887535   2.429133     90059.0             1              1              0              0              0               0.887535                    0.0                    0.0                    0.0      0       40488  0.001260
36  132776      4  1.415862   4.120036     90059.0             1              1              0              0              0               1.415862                    0.0                    0.0                    0.0      0       40488  0.000395
37  132776      7  1.879925   6.553017     90059.0             1              1              0              0              0               1.879925                    0.0                    0.0                    0.0      0       40488  0.000074
38  132776      1  2.229868   9.298637     90059.0             1              1              0              0              0               2.229868                    0.0                    0.0                    0.0      0       40488  0.000049
39  132776      9  2.401359  11.038164     90059.0             1              1              0              0              0               2.401359                    0.0                    0.0                    0.0      0       40488  0.000988
40  132792      0  0.788905   2.200984     90059.0             1              1              0              0              0               0.788905                    0.0                    0.0                    0.0      0       40488  0.003804
41  132792      4  1.462907   4.318494     90059.0             1              1              0              0              0               1.462907                    0.0                    0.0                    0.0      0       40488  0.000617
42  132792      7  1.889494   6.616020     90059.0             1              1              0              0              0               1.889494                    0.0                    0.0                    0.0      0       40488  0.000173
43  132792      1  2.258765   9.571262     90059.0             1              1              0              0              0               2.258765                    0.0                    0.0                    0.0      0       40488  0.000074
44  132792      9  2.363775  10.631010     90059.0             1              1              0              0              0               2.363775                    0.0                    0.0                    0.0      0       40488  0.003063
45  132793      0  0.782841   2.187679     90059.0             1              1              0              0              0               0.782841                    0.0                    0.0                    0.0      0       40488  0.003186
46  132793      4  1.473780   4.365707     90059.0             1              1              0              0              0               1.473780                    0.0                    0.0                    0.0      0       40488  0.000593
47  132793      7  1.890205   6.620723     90059.0             1              1              0              0              0               1.890205                    0.0                    0.0                    0.0      0       40488  0.000049
48  132793      1  2.264449   9.625818     90059.0             1              1              0              0              0               2.264449                    0.0                    0.0                    0.0      0       40488  0.000049
49  132793      9  2.357149  10.560804     90059.0             1              1              0              0              0               2.357149                    0.0                    0.0                    0.0      0       40488  0.002544
50  132794      0  0.887200   2.428321     90059.0             1              1              0              0              0               0.887200                    0.0                    0.0                    0.0      0       40488  0.001260
51  132794      4  1.526687   4.602902     90059.0             1              1              0              0              0               1.526687                    0.0                    0.0                    0.0      0       40488  0.000247
52  132794      7  1.852737   6.377253     90059.0             1              1              0              0              0               1.852737                    0.0                    0.0                    0.0      0       40488  0.000049
53  132794      1  2.287930   9.854524     90059.0             1              1              0              0              0               2.287930                    0.0                    0.0                    0.0      0       40488  0.000025
54  132794      9  2.338092  10.361449     90059.0             1              1              0              0              0               2.338092                    0.0                    0.0                    0.0      0       40488  0.000741
55  132795      0  0.939920   2.559777     90059.0             1              1              0              0              0               0.939920                    0.0                    0.0                    0.0      0       40488  0.000420
56  132795      4  1.556965   4.744402     90059.0             1              1              0              0              0               1.556965                    0.0                    0.0                    0.0      0       40488  0.000025
59  132795      9  2.325947  10.236375     90059.0             1              1              0              0              0               2.325947                    0.0                    0.0                    0.0      0       40488  0.000173
60  132796      0  0.770565   2.160988     90059.0             1              1              0              0              0               0.770565                    0.0                    0.0                    0.0      0       40488  0.004051
pi_init:
[[ 3.9098137   0.69545087 -2.02731254  0.11520772]]
Weight distribution by market:
count    10.0
mean      1.0
std       0.0
min       1.0
25%       1.0
50%       1.0
75%       1.0
max       1.0
Name: weights, dtype: float64
Estimating demand...
agent_vars: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
iv_df:
             demand_instruments0  demand_instruments1  demand_instruments2  demand_instruments3
market_ids                                                                                    
90059.0                1.211743              0.00000                  0.0             0.000000
90201.0                1.305137              0.00000                  0.0             0.000000
90277.0                0.000000              0.00000                  0.0             1.928839
90290.0                0.000000              0.00000                  0.0             2.839770
90302.0                0.000000              1.62034                  0.0             0.000000
Initializing the problem ...
Initialized the problem after 00:00:00.

Dimensions:
===========================================
 T    N    F     I     K1    K2    D    MD 
---  ---  ---  -----  ----  ----  ---  ----
10   10    1   11527   7     1     4    10 
===========================================

Formulations:
==================================================================================================================================================
       Column Indices:                   0                      1                      2                      3                  4         5    6 
-----------------------------  ---------------------  ---------------------  ---------------------  ---------------------  -------------  ---  ---
 X1: Linear Characteristics              1                   prices              hpi_quantile1          hpi_quantile2      hpi_quantile3   X    Y 
X2: Nonlinear Characteristics            1                                                                                                        
       d: Demographics         logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4                         
==================================================================================================================================================
pi_init: [[ 3.9098137   0.69545087 -2.02731254  0.11520772]]
pi_lb: [[-inf -inf -inf -inf]]
pi_ub: [[inf inf inf inf]]
Solving with one core...
Solving the problem ...

Nonlinear Coefficient Initial Values:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +3.91E+00              +6.95E-01              -2.03E+00              +1.15E-01      
=====================================================================================================================

Nonlinear Coefficient Lower Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           -INF                   -INF                   -INF                   -INF         
=====================================================================================================================

Nonlinear Coefficient Upper Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           +INF                   +INF                   +INF                   +INF         
=====================================================================================================================

The model may be under-identified. The total number of unfixed parameters is 11, which is more than the total number of moments, 10. Consider checking whether instruments were properly specified when initializing the problem, and whether parameters were properly configured when solving the problem.
Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 1     00:00:00         0             1           142          142         0     +4.28E-03               +8.09E-02  +3.91E+00, +6.95E-01, -2.03E+00, +1.15E-01
 1     00:00:00         1             2           138          138         0     +1.65E-03   +2.63E-03   +2.56E-02  +3.91E+00, +7.04E-01, -2.06E+00, +3.43E-02
 1     00:00:00         2             3           138          138         0     +1.35E-03   +2.91E-04   +2.19E-03  +3.91E+00, +7.01E-01, -2.06E+00, +5.38E-02
 1     00:00:00         3             4           138          138         0     +1.35E-03   +6.88E-06   +2.22E-03  +3.91E+00, +7.00E-01, -2.06E+00, +5.57E-02
 1     00:00:00         4             5           138          138         0     +1.33E-03   +1.22E-05   +1.57E-03  +3.91E+00, +6.99E-01, -2.07E+00, +5.97E-02
 1     00:00:00         5             6           138          138         0     +1.33E-03   +3.71E-06   +8.67E-04  +3.91E+00, +6.99E-01, -2.07E+00, +6.07E-02
 1     00:00:00         6             7           138          138         0     +1.33E-03   +1.89E-06   +7.48E-04  +3.91E+00, +7.00E-01, -2.07E+00, +6.12E-02
 1     00:00:00         7             8           138          138         0     +1.33E-03   +5.64E-07   +5.68E-04  +3.91E+00, +7.01E-01, -2.07E+00, +6.10E-02
 1     00:00:00         8             9           137          137         0     +1.33E-03   +9.96E-07   +7.27E-04  +3.91E+00, +7.04E-01, -2.07E+00, +6.12E-02
 1     00:00:00         9            10           138          138         0     +1.33E-03   +1.89E-07   +3.52E-04  +3.91E+00, +7.04E-01, -2.07E+00, +6.15E-02
 1     00:00:00         10           11           138          138         0     +1.33E-03   +4.67E-07   +3.61E-05  +3.91E+00, +7.06E-01, -2.07E+00, +6.27E-02
 1     00:00:00         11           12           137          137         0     +1.33E-03   +7.94E-09   +2.98E-05  +3.91E+00, +7.06E-01, -2.07E+00, +6.28E-02
 1     00:00:00         12           13           138          138         0     +1.33E-03   +7.21E-10   +2.98E-05  +3.91E+00, +7.06E-01, -2.07E+00, +6.28E-02
 1     00:00:00         13           14           137          137         0     +1.33E-03   +7.41E-08   +2.13E-04  +3.91E+00, +7.06E-01, -2.07E+00, +6.26E-02
 1     00:00:00         14           15           138          138         0     +1.33E-03   +1.30E-08   +1.33E-04  +3.91E+00, +7.06E-01, -2.07E+00, +6.26E-02
 1     00:00:00         15           16           137          137         0     +1.33E-03   +8.65E-09   +2.65E-05  +3.91E+00, +7.06E-01, -2.07E+00, +6.28E-02
 1     00:00:00         16           17           137          137         0     +1.33E-03   +1.77E-07   +2.48E-05  +3.90E+00, +7.06E-01, -2.07E+00, +6.28E-02
 1     00:00:00         17           18           138          138         0     +1.33E-03   +1.86E-07   +2.36E-06  +3.88E+00, +7.06E-01, -2.07E+00, +6.28E-02
 1     00:00:00         18           19           138          138         0     +1.33E-03   +2.37E-11   +1.12E-07  +3.88E+00, +7.06E-01, -2.07E+00, +6.28E-02
 1     00:00:00         19           20           137          137         0     +1.33E-03   +6.97E-13   +4.94E-10  +3.88E+00, +7.06E-01, -2.07E+00, +6.28E-02
 1     00:00:00         20           21           138          138         0     +1.33E-03   +2.75E-17   +9.41E-11  +3.88E+00, +7.06E-01, -2.07E+00, +6.28E-02

Optimization completed after 00:00:01.
Computing the Hessian and and updating the weighting matrix ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +2.32E+19. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
=====================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number
----  ---------  ---------  --------------  --------------  -------  ----------------
 1    +1.33E-03  +9.41E-11    +9.68E-04       +1.27E+00        0        +1.41E+05    
=====================================================================================

Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 2     00:00:00         0             1           46           46          0     +6.61E+00               +1.35E+02  +3.88E+00, +7.06E-01, -2.07E+00, +6.28E-02
 2     00:00:00         1             2           130          130         0     +2.40E+03               +3.89E+03  +3.88E+00, +6.08E-02, -1.70E+00, +7.30E-01
 2     00:00:00         2             3           97           97          0     +1.67E+00   +4.95E+00   +5.63E+01  +3.88E+00, +6.82E-01, -2.05E+00, +9.09E-02
 2     00:00:00         3             4           98           98          0     +7.05E-01   +9.61E-01   +3.57E+01  +3.88E+00, +6.90E-01, -2.04E+00, +9.80E-02
 2     00:00:00         4             5           94           94          0     +3.08E-04   +7.04E-01   +1.55E+00  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         5             6           94           94          0     +2.17E-07   +3.08E-04   +4.90E-02  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         6             7           94           94          0     +3.24E-09   +2.14E-07   +2.91E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         7             8           94           94          0     +2.35E-09   +8.81E-10   +1.97E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         8             9           94           94          0     +2.39E-09               +5.15E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         9            10           94           94          0     +7.10E-09               +1.12E-02  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         10           11           94           94          0     +2.87E-08               +2.08E-02  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         11           12           94           94          0     +1.31E-07               +4.16E-02  +3.88E+00, +6.96E-01, -2.01E+00, +1.16E-01
 2     00:00:00         12           13           94           94          0     +2.75E-08               +9.50E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         13           14           94           94          0     +8.57E-09               +7.11E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         14           15           94           94          0     +1.27E-08               +1.06E-02  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         15           16           94           94          0     +1.01E-08               +8.62E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         16           17           94           94          0     +4.13E-09               +3.59E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         17           18           94           94          0     +2.72E-09               +2.77E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         18           19           94           94          0     +2.41E-09               +2.37E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         19           20           94           94          0     +2.35E-09   +7.06E-12   +2.17E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         20           21           94           94          0     +2.18E-09   +1.66E-10   +2.01E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         21           22           94           94          0     +2.16E-09   +2.20E-11   +2.05E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         22           23           94           94          0     +2.10E-09   +6.41E-11   +2.00E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         23           24           94           94          0     +2.08E-09   +1.72E-11   +2.01E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         24           25           94           94          0     +2.05E-09   +2.43E-11   +1.99E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         25           26           94           94          0     +2.04E-09   +9.43E-12   +1.99E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         26           27           94           94          0     +2.03E-09   +1.08E-11   +1.98E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         27           28           94           94          0     +2.03E-09   +3.71E-12   +1.98E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         28           29           94           94          0     +2.02E-09   +6.83E-12   +1.98E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         29           30           94           94          0     +2.02E-09               +1.98E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         30           31           94           94          0     +2.02E-09               +1.98E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         31           32           94           94          0     +2.02E-09               +1.98E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         32           33           94           94          0     +2.02E-09               +1.98E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         33           34           94           94          0     +2.02E-09               +1.98E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 2     00:00:00         34           35           94           94          0     +2.02E-09               +1.98E-03  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01

Optimization completed after 00:00:01.
Computing the Hessian and estimating standard errors ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +1.35E+22. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
========================================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix  Covariance Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number  Condition Number 
----  ---------  ---------  --------------  --------------  -------  ----------------  -----------------
 2    +2.02E-09  +1.98E-03    -1.23E+02       +7.27E+03        0        +2.74E+29          +6.99E+20    
========================================================================================================

Cumulative Statistics:
===========================================================================
Computation  Optimizer  Optimization   Objective   Fixed Point  Contraction
   Time      Converged   Iterations   Evaluations  Iterations   Evaluations
-----------  ---------  ------------  -----------  -----------  -----------
 00:00:02       Yes          56           58          6413         6413    
===========================================================================

Nonlinear Coefficient Estimates (Robust SEs in Parentheses):
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +3.88E+00              +6.96E-01              -2.01E+00              +1.15E-01      
                   |            (+6.52E-02)            (+4.50E-02)            (+2.48E-02)            (+4.51E-02)     
=====================================================================================================================

Beta Estimates (Robust SEs in Parentheses):
===============================================================================================
     1         prices     hpi_quantile1  hpi_quantile2  hpi_quantile3       X            Y     
-----------  -----------  -------------  -------------  -------------  -----------  -----------
 +2.77E+00    -3.03E-11     -4.76E+00      -2.10E+00      +4.32E+00     -5.81E+00    -1.62E+00 
(+1.46E-01)  (+1.62E-15)   (+1.02E-01)    (+1.67E-01)    (+1.50E-01)   (+2.93E-02)  (+7.58E-02)
===============================================================================================
Computing delta ...
Finished after 00:00:00.

Mean delta: 1.0888423298798593
pi labels: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
ii=0, vv=logdistXhpi_quantile1
logdistXhpi_quantile1 is a distance term, omitting from ABD and adding to coefficients instead
ii=1, vv=logdistXhpi_quantile2
logdistXhpi_quantile2 is a distance term, omitting from ABD and adding to coefficients instead
ii=2, vv=logdistXhpi_quantile3
logdistXhpi_quantile3 is a distance term, omitting from ABD and adding to coefficients instead
ii=3, vv=logdistXhpi_quantile4
logdistXhpi_quantile4 is a distance term, omitting from ABD and adding to coefficients instead

Distance coefficients: [3.8783, 0.696, -2.01158, 0.11543]

Computed abepsilon in: 0.011 seconds.
Assigning individuals...
time3 - time2: 0.318
time4 - time3: 2.152
Number of full locations: 15  out of  18
Offers:
% Rank 0 offers: 47.01897
% Rank 1 offers: 8.64960
% Rank 2 offers: 4.28214
% Rank 3 offers: 2.83454
% Rank 4 offers: 37.21476
% Offered any: 100.0
Mean offer distance: 1.58215
Quantiles of offered distances:
0.0 quantile: -2.65569
0.1 quantile: 0.33247
0.2 quantile: 0.73952
0.3 quantile: 1.05896
0.4 quantile: 1.34995
0.5 quantile: 1.71284
0.6 quantile: 2.11120
0.7 quantile: 2.23164
0.8 quantile: 2.37182
0.9 quantile: 2.60348
1.0 quantile: 3.19221
Assignments:
% Rank 0 assignments: 29.88989
% Rank 1 assignments: 7.31515
% Rank 2 assignments: 3.83111
% Rank 3 assignments: 2.61743
% Rank 4 assignments: 32.47871
% Assigned: 76.13229
Mean assignment distance: 1.75418
Quantiles of assignment distances:
0.0 quantile: -2.05992
0.1 quantile: 0.66617
0.2 quantile: 1.01036
0.3 quantile: 1.27676
0.4 quantile: 1.59881
0.5 quantile: 2.03400
0.6 quantile: 2.16247
0.7 quantile: 2.26182
0.8 quantile: 2.39344
0.9 quantile: 2.60329
1.0 quantile: 3.19221
Violations:
Max violation: 32145
Number of locations with violations: 15
Number of individuals with violations: 138152
Mean violation (conditional on violation): 9210.133333333333
Median violation (conditional on violation): 6921.0
Number of markets with wasserstein distance > 0.001: 5
Mean wasserstein distance for markets with wasserstein distance > 0.001: 0.0022304884921485312
Mean wasserstein distance: 0.0013550723717399406
Max wasserstein distance: 0.004861895932938889
Index of max wasserstein distance: 9
Iteration 11 complete.


Number of agents: 11532

Iteration 12:

agent_loc_data:
     blkid  locid   logdist       dist  market_ids  hpi_quantile  hpi_quantile1  hpi_quantile2  hpi_quantile3  hpi_quantile4  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4  nodes  population   weights
0   132759      0  0.737546   2.090799     90059.0             1              1              0              0              0               0.737546                    0.0                    0.0                    0.0      0       40488  0.000198
4   132759     16  2.388723  10.899569     90059.0             1              1              0              0              0               2.388723                    0.0                    0.0                    0.0      0       40488  0.000198
5   132760      0  0.817771   2.265445     90059.0             1              1              0              0              0               0.817771                    0.0                    0.0                    0.0      0       40488  0.000988
6   132760      4  1.368392   3.929026     90059.0             1              1              0              0              0               1.368392                    0.0                    0.0                    0.0      0       40488  0.000272
7   132760      7  1.909226   6.747865     90059.0             1              1              0              0              0               1.909226                    0.0                    0.0                    0.0      0       40488  0.000049
9   132760     16  2.407625  11.107545     90059.0             1              1              0              0              0               2.407625                    0.0                    0.0                    0.0      0       40488  0.000790
10  132761      0  0.835924   2.306944     90059.0             1              1              0              0              0               0.835924                    0.0                    0.0                    0.0      0       40488  0.000074
14  132761      9  2.405422  11.083104     90059.0             1              1              0              0              0               2.405422                    0.0                    0.0                    0.0      0       40488  0.000123
15  132763      0  0.685177   1.984123     90059.0             1              1              0              0              0               0.685177                    0.0                    0.0                    0.0      0       40488  0.000123
16  132763      4  1.317212   3.733000     90059.0             1              1              0              0              0               1.317212                    0.0                    0.0                    0.0      0       40488  0.000049
19  132763     16  2.382397  10.830829     90059.0             1              1              0              0              0               2.382397                    0.0                    0.0                    0.0      0       40488  0.000123
20  132772      0  0.959576   2.610589     90059.0             1              1              0              0              0               0.959576                    0.0                    0.0                    0.0      0       40488  0.001778
21  132772      4  1.464425   4.325055     90059.0             1              1              0              0              0               1.464425                    0.0                    0.0                    0.0      0       40488  0.000272
22  132772      7  1.847489   6.343871     90059.0             1              1              0              0              0               1.847489                    0.0                    0.0                    0.0      0       40488  0.000025
23  132772      1  2.250480   9.492289     90059.0             1              1              0              0              0               2.250480                    0.0                    0.0                    0.0      0       40488  0.000049
24  132772      9  2.387146  10.882389     90059.0             1              1              0              0              0               2.387146                    0.0                    0.0                    0.0      0       40488  0.001210
25  132774      0  1.021268   2.776713     90059.0             1              1              0              0              0               1.021268                    0.0                    0.0                    0.0      0       40488  0.001161
26  132774      4  1.507882   4.517154     90059.0             1              1              0              0              0               1.507882                    0.0                    0.0                    0.0      0       40488  0.000247
27  132774      7  1.816779   6.152013     90059.0             1              1              0              0              0               1.816779                    0.0                    0.0                    0.0      0       40488  0.000049
29  132774      9  2.373282  10.732561     90059.0             1              1              0              0              0               2.373282                    0.0                    0.0                    0.0      0       40488  0.001037
30  132775      0  0.943832   2.569810     90059.0             1              1              0              0              0               0.943832                    0.0                    0.0                    0.0      0       40488  0.002346
31  132775      4  1.464439   4.325118     90059.0             1              1              0              0              0               1.464439                    0.0                    0.0                    0.0      0       40488  0.000370
32  132775      7  1.850678   6.364134     90059.0             1              1              0              0              0               1.850678                    0.0                    0.0                    0.0      0       40488  0.000123
33  132775      1  2.251602   9.502947     90059.0             1              1              0              0              0               2.251602                    0.0                    0.0                    0.0      0       40488  0.000049
34  132775      9  2.384357  10.852086     90059.0             1              1              0              0              0               2.384357                    0.0                    0.0                    0.0      0       40488  0.001581
35  132776      0  0.887535   2.429133     90059.0             1              1              0              0              0               0.887535                    0.0                    0.0                    0.0      0       40488  0.001260
36  132776      4  1.415862   4.120036     90059.0             1              1              0              0              0               1.415862                    0.0                    0.0                    0.0      0       40488  0.000395
37  132776      7  1.879925   6.553017     90059.0             1              1              0              0              0               1.879925                    0.0                    0.0                    0.0      0       40488  0.000074
38  132776      1  2.229868   9.298637     90059.0             1              1              0              0              0               2.229868                    0.0                    0.0                    0.0      0       40488  0.000049
39  132776      9  2.401359  11.038164     90059.0             1              1              0              0              0               2.401359                    0.0                    0.0                    0.0      0       40488  0.000988
40  132792      0  0.788905   2.200984     90059.0             1              1              0              0              0               0.788905                    0.0                    0.0                    0.0      0       40488  0.003804
41  132792      4  1.462907   4.318494     90059.0             1              1              0              0              0               1.462907                    0.0                    0.0                    0.0      0       40488  0.000642
42  132792      7  1.889494   6.616020     90059.0             1              1              0              0              0               1.889494                    0.0                    0.0                    0.0      0       40488  0.000173
43  132792      1  2.258765   9.571262     90059.0             1              1              0              0              0               2.258765                    0.0                    0.0                    0.0      0       40488  0.000074
44  132792      9  2.363775  10.631010     90059.0             1              1              0              0              0               2.363775                    0.0                    0.0                    0.0      0       40488  0.003038
45  132793      0  0.782841   2.187679     90059.0             1              1              0              0              0               0.782841                    0.0                    0.0                    0.0      0       40488  0.003186
46  132793      4  1.473780   4.365707     90059.0             1              1              0              0              0               1.473780                    0.0                    0.0                    0.0      0       40488  0.000593
47  132793      7  1.890205   6.620723     90059.0             1              1              0              0              0               1.890205                    0.0                    0.0                    0.0      0       40488  0.000049
48  132793      1  2.264449   9.625818     90059.0             1              1              0              0              0               2.264449                    0.0                    0.0                    0.0      0       40488  0.000049
49  132793      9  2.357149  10.560804     90059.0             1              1              0              0              0               2.357149                    0.0                    0.0                    0.0      0       40488  0.002544
50  132794      0  0.887200   2.428321     90059.0             1              1              0              0              0               0.887200                    0.0                    0.0                    0.0      0       40488  0.001260
51  132794      4  1.526687   4.602902     90059.0             1              1              0              0              0               1.526687                    0.0                    0.0                    0.0      0       40488  0.000247
52  132794      7  1.852737   6.377253     90059.0             1              1              0              0              0               1.852737                    0.0                    0.0                    0.0      0       40488  0.000049
53  132794      1  2.287930   9.854524     90059.0             1              1              0              0              0               2.287930                    0.0                    0.0                    0.0      0       40488  0.000025
54  132794      9  2.338092  10.361449     90059.0             1              1              0              0              0               2.338092                    0.0                    0.0                    0.0      0       40488  0.000741
55  132795      0  0.939920   2.559777     90059.0             1              1              0              0              0               0.939920                    0.0                    0.0                    0.0      0       40488  0.000420
56  132795      4  1.556965   4.744402     90059.0             1              1              0              0              0               1.556965                    0.0                    0.0                    0.0      0       40488  0.000025
59  132795      9  2.325947  10.236375     90059.0             1              1              0              0              0               2.325947                    0.0                    0.0                    0.0      0       40488  0.000173
60  132796      0  0.770565   2.160988     90059.0             1              1              0              0              0               0.770565                    0.0                    0.0                    0.0      0       40488  0.004051
61  132796      4  1.482172   4.402496     90059.0             1              1              0              0              0               1.482172                    0.0                    0.0                    0.0      0       40488  0.000667
pi_init:
[[ 3.87830291  0.69599696 -2.01157923  0.11543188]]
Weight distribution by market:
count    10.0
mean      1.0
std       0.0
min       1.0
25%       1.0
50%       1.0
75%       1.0
max       1.0
Name: weights, dtype: float64
Estimating demand...
agent_vars: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
iv_df:
             demand_instruments0  demand_instruments1  demand_instruments2  demand_instruments3
market_ids                                                                                    
90059.0                1.208534             0.000000                  0.0             0.000000
90201.0                1.302437             0.000000                  0.0             0.000000
90277.0                0.000000             0.000000                  0.0             1.928269
90290.0                0.000000             0.000000                  0.0             2.839756
90302.0                0.000000             1.619962                  0.0             0.000000
Initializing the problem ...
Initialized the problem after 00:00:00.

Dimensions:
===========================================
 T    N    F     I     K1    K2    D    MD 
---  ---  ---  -----  ----  ----  ---  ----
10   10    1   11532   7     1     4    10 
===========================================

Formulations:
==================================================================================================================================================
       Column Indices:                   0                      1                      2                      3                  4         5    6 
-----------------------------  ---------------------  ---------------------  ---------------------  ---------------------  -------------  ---  ---
 X1: Linear Characteristics              1                   prices              hpi_quantile1          hpi_quantile2      hpi_quantile3   X    Y 
X2: Nonlinear Characteristics            1                                                                                                        
       d: Demographics         logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4                         
==================================================================================================================================================
pi_init: [[ 3.87830291  0.69599696 -2.01157923  0.11543188]]
pi_lb: [[-inf -inf -inf -inf]]
pi_ub: [[inf inf inf inf]]
Solving with one core...
Solving the problem ...

Nonlinear Coefficient Initial Values:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +3.88E+00              +6.96E-01              -2.01E+00              +1.15E-01      
=====================================================================================================================

Nonlinear Coefficient Lower Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           -INF                   -INF                   -INF                   -INF         
=====================================================================================================================

Nonlinear Coefficient Upper Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           +INF                   +INF                   +INF                   +INF         
=====================================================================================================================

The model may be under-identified. The total number of unfixed parameters is 11, which is more than the total number of moments, 10. Consider checking whether instruments were properly specified when initializing the problem, and whether parameters were properly configured when solving the problem.
Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 1     00:00:00         0             1           142          142         0     +4.79E-03               +8.68E-02  +3.88E+00, +6.96E-01, -2.01E+00, +1.15E-01
 1     00:00:00         1             2           138          138         0     +1.67E-03   +3.12E-03   +2.83E-02  +3.88E+00, +7.04E-01, -2.05E+00, +2.86E-02
 1     00:00:00         2             3           137          137         0     +1.31E-03   +3.57E-04   +3.90E-03  +3.88E+00, +7.00E-01, -2.05E+00, +4.98E-02
 1     00:00:00         3             4           138          138         0     +1.29E-03   +2.47E-05   +4.04E-03  +3.88E+00, +6.98E-01, -2.05E+00, +5.31E-02
 1     00:00:00         4             5           138          138         0     +1.25E-03   +4.15E-05   +2.39E-03  +3.88E+00, +6.93E-01, -2.07E+00, +6.01E-02
 1     00:00:00         5             6           138          138         0     +1.24E-03   +8.14E-06   +1.25E-03  +3.88E+00, +6.93E-01, -2.07E+00, +6.10E-02
 1     00:00:00         6             7           138          138         0     +1.23E-03   +4.78E-06   +1.11E-03  +3.88E+00, +6.95E-01, -2.08E+00, +6.16E-02
 1     00:00:00         7             8           138          138         0     +1.23E-03   +1.46E-06   +9.09E-04  +3.88E+00, +6.97E-01, -2.08E+00, +6.16E-02
 1     00:00:00         8             9           138          138         0     +1.23E-03   +2.98E-06   +1.02E-03  +3.88E+00, +7.02E-01, -2.08E+00, +6.23E-02
 1     00:00:00         9            10           138          138         0     +1.23E-03   +1.02E-06   +5.89E-04  +3.88E+00, +7.03E-01, -2.08E+00, +6.38E-02
 1     00:00:00         10           11           138          138         0     +1.23E-03   +1.50E-07   +1.30E-04  +3.88E+00, +7.03E-01, -2.08E+00, +6.42E-02
 1     00:00:00         11           12           138          138         0     +1.23E-03   +9.98E-08   +1.49E-05  +3.88E+00, +7.05E-01, -2.08E+00, +6.47E-02
 1     00:00:00         12           13           138          138         0     +1.23E-03   +1.81E-10   +1.49E-05  +3.88E+00, +7.05E-01, -2.08E+00, +6.47E-02
 1     00:00:00         13           14           137          137         0     +1.23E-03   +3.81E-08   +9.61E-05  +3.88E+00, +7.05E-01, -2.08E+00, +6.47E-02
 1     00:00:00         14           15           138          138         0     +1.23E-03   +4.87E-09   +4.98E-05  +3.88E+00, +7.05E-01, -2.08E+00, +6.47E-02
 1     00:00:00         15           16           138          138         0     +1.23E-03   +5.07E-09   +1.15E-05  +3.88E+00, +7.05E-01, -2.08E+00, +6.47E-02
 1     00:00:00         16           17           138          138         0     +1.23E-03   +5.14E-08   +5.26E-05  +3.89E+00, +7.05E-01, -2.08E+00, +6.48E-02
 1     00:00:00         17           18           138          138         0     +1.23E-03   +1.18E-09   +9.01E-06  +3.89E+00, +7.05E-01, -2.08E+00, +6.47E-02
 1     00:00:00         18           19           138          138         0     +1.23E-03   +1.90E-08   +1.69E-06  +3.89E+00, +7.05E-01, -2.08E+00, +6.47E-02
 1     00:00:00         19           20           138          138         0     +1.23E-03   +1.31E-11   +7.81E-08  +3.89E+00, +7.05E-01, -2.08E+00, +6.47E-02
 1     00:00:00         20           21           137          137         0     +1.23E-03   +3.29E-12   +8.64E-10  +3.89E+00, +7.05E-01, -2.08E+00, +6.47E-02
 1     00:00:00         21           22           137          137         0     +1.23E-03   +4.99E-17   +1.65E-10  +3.89E+00, +7.05E-01, -2.08E+00, +6.47E-02
 1     00:00:00         22           23           138          138         0     +1.23E-03   +3.90E-17   +4.80E-12  +3.89E+00, +7.05E-01, -2.08E+00, +6.47E-02

Optimization completed after 00:00:01.
Computing the Hessian and and updating the weighting matrix ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +1.58E+21. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
=====================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number
----  ---------  ---------  --------------  --------------  -------  ----------------
 1    +1.23E-03  +4.80E-12    +9.37E-04       +1.28E+00        0        +1.40E+05    
=====================================================================================

Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 2     00:00:00         0             1           45           45          0     +6.62E+00               +1.42E+02  +3.89E+00, +7.05E-01, -2.08E+00, +6.47E-02
 2     00:00:00         1             2           129          129         0     +2.66E+03               +4.27E+03  +3.89E+00, +6.18E-02, -1.71E+00, +7.34E-01
 2     00:00:00         2             3           97           97          0     +1.70E+00   +4.92E+00   +5.82E+01  +3.89E+00, +6.82E-01, -2.05E+00, +9.13E-02
 2     00:00:00         3             4           97           97          0     +7.37E-01   +9.60E-01   +3.80E+01  +3.89E+00, +6.89E-01, -2.04E+00, +9.81E-02
 2     00:00:00         4             5           94           94          0     +2.46E-04   +7.37E-01   +1.48E+00  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         5             6           94           94          0     +1.32E-07   +2.46E-04   +4.38E-02  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         6             7           94           94          0     +8.06E-10   +1.31E-07   +1.32E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         7             8           94           94          0     +8.87E-10               +1.47E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         8             9           94           94          0     +6.33E-09               +6.82E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         9            10           94           94          0     +2.51E-08               +1.63E-02  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         10           11           94           94          0     +8.69E-08               +3.23E-02  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         11           12           94           94          0     +1.18E-08               +1.04E-02  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         12           13           94           94          0     +8.44E-09               +8.38E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         13           14           93           93          0     +2.87E-09               +3.52E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         14           15           94           94          0     +6.60E-09               +7.01E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         15           16           94           94          0     +4.60E-09               +5.32E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         16           17           94           94          0     +1.91E-09               +2.57E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         17           18           94           94          0     +1.16E-09               +1.90E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         18           19           94           94          0     +9.35E-10               +1.56E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         19           20           94           94          0     +8.58E-10               +1.39E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         20           21           94           94          0     +8.29E-10               +1.34E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         21           22           94           94          0     +8.16E-10               +1.33E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         22           23           94           94          0     +8.11E-10               +1.33E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         23           24           94           94          0     +8.08E-10               +1.32E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01

Optimization completed after 00:00:01.
Computing the Hessian and estimating standard errors ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +5.50E+20. To disable singularity checks, set options.singular_tol = numpy.inf.

Failed to compute standard errors because of invalid estimated covariances of GMM parameters.

Computed results after 00:00:00.

Problem Results Summary:
========================================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix  Covariance Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number  Condition Number 
----  ---------  ---------  --------------  --------------  -------  ----------------  -----------------
 2    +8.06E-10  +1.32E-03    -1.30E+02       +7.88E+03        0        +2.06E+30          +5.01E+21    
========================================================================================================

Cumulative Statistics:
===========================================================================
Computation  Optimizer  Optimization   Objective   Fixed Point  Contraction
   Time      Converged   Iterations   Evaluations  Iterations   Evaluations
-----------  ---------  ------------  -----------  -----------  -----------
 00:00:02       Yes          47           49          5653         5653    
===========================================================================

Nonlinear Coefficient Estimates (Robust SEs in Parentheses):
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +3.89E+00              +6.96E-01              -2.02E+00              +1.15E-01      
                   |            (+6.25E-02)            (+4.30E-02)            (+2.39E-02)            (+4.34E-02)     
=====================================================================================================================

Beta Estimates (Robust SEs in Parentheses):
===============================================================================================
     1         prices     hpi_quantile1  hpi_quantile2  hpi_quantile3       X            Y     
-----------  -----------  -------------  -------------  -------------  -----------  -----------
 +2.79E+00    -3.34E-12     -4.78E+00      -2.12E+00      +4.33E+00     -5.71E+00    -1.66E+00 
(+1.40E-01)     (NAN)      (+9.78E-02)    (+1.60E-01)    (+1.45E-01)   (+2.80E-02)  (+7.23E-02)
===============================================================================================
Computing delta ...
Finished after 00:00:00.

Mean delta: 1.0935750809609779
pi labels: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
ii=0, vv=logdistXhpi_quantile1
logdistXhpi_quantile1 is a distance term, omitting from ABD and adding to coefficients instead
ii=1, vv=logdistXhpi_quantile2
logdistXhpi_quantile2 is a distance term, omitting from ABD and adding to coefficients instead
ii=2, vv=logdistXhpi_quantile3
logdistXhpi_quantile3 is a distance term, omitting from ABD and adding to coefficients instead
ii=3, vv=logdistXhpi_quantile4
logdistXhpi_quantile4 is a distance term, omitting from ABD and adding to coefficients instead

Distance coefficients: [3.89472, 0.6956, -2.01894, 0.11516]

Computed abepsilon in: 0.011 seconds.
Assigning individuals...
time3 - time2: 0.321
time4 - time3: 2.198
Number of full locations: 15  out of  18
Offers:
% Rank 0 offers: 46.98694
% Rank 1 offers: 8.63752
% Rank 2 offers: 4.28266
% Rank 3 offers: 2.83507
% Rank 4 offers: 37.25782
% Offered any: 100.0
Mean offer distance: 1.58277
Quantiles of offered distances:
0.0 quantile: -2.65569
0.1 quantile: 0.33263
0.2 quantile: 0.74196
0.3 quantile: 1.05948
0.4 quantile: 1.34995
0.5 quantile: 1.71402
0.6 quantile: 2.11138
0.7 quantile: 2.23185
0.8 quantile: 2.37213
0.9 quantile: 2.60348
1.0 quantile: 3.19221
Assignments:
% Rank 0 assignments: 29.89042
% Rank 1 assignments: 7.31226
% Rank 2 assignments: 3.83452
% Rank 3 assignments: 2.62006
% Rank 4 assignments: 32.54434
% Assigned: 76.20160
Mean assignment distance: 1.75480
Quantiles of assignment distances:
0.0 quantile: -2.05992
0.1 quantile: 0.66617
0.2 quantile: 1.01085
0.3 quantile: 1.27719
0.4 quantile: 1.60071
0.5 quantile: 2.03587
0.6 quantile: 2.16306
0.7 quantile: 2.26218
0.8 quantile: 2.39368
0.9 quantile: 2.60348
1.0 quantile: 3.19221
Violations:
Max violation: 32199
Number of locations with violations: 15
Number of individuals with violations: 138325
Mean violation (conditional on violation): 9221.666666666666
Median violation (conditional on violation): 6922.0
Number of markets with wasserstein distance > 0.001: 2
Mean wasserstein distance for markets with wasserstein distance > 0.001: 0.0030580564531028356
Mean wasserstein distance: 0.0009661834349497401
Max wasserstein distance: 0.004920680623346198
Index of max wasserstein distance: 9
Iteration 12 complete.


Number of agents: 11538

Iteration 13:

agent_loc_data:
     blkid  locid   logdist       dist  market_ids  hpi_quantile  hpi_quantile1  hpi_quantile2  hpi_quantile3  hpi_quantile4  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4  nodes  population   weights
0   132759      0  0.737546   2.090799     90059.0             1              1              0              0              0               0.737546                    0.0                    0.0                    0.0      0       40488  0.000198
4   132759     16  2.388723  10.899569     90059.0             1              1              0              0              0               2.388723                    0.0                    0.0                    0.0      0       40488  0.000198
5   132760      0  0.817771   2.265445     90059.0             1              1              0              0              0               0.817771                    0.0                    0.0                    0.0      0       40488  0.000988
6   132760      4  1.368392   3.929026     90059.0             1              1              0              0              0               1.368392                    0.0                    0.0                    0.0      0       40488  0.000247
7   132760      7  1.909226   6.747865     90059.0             1              1              0              0              0               1.909226                    0.0                    0.0                    0.0      0       40488  0.000049
8   132760      1  2.210262   9.118109     90059.0             1              1              0              0              0               2.210262                    0.0                    0.0                    0.0      0       40488  0.000025
9   132760     16  2.407625  11.107545     90059.0             1              1              0              0              0               2.407625                    0.0                    0.0                    0.0      0       40488  0.000790
10  132761      0  0.835924   2.306944     90059.0             1              1              0              0              0               0.835924                    0.0                    0.0                    0.0      0       40488  0.000074
14  132761      9  2.405422  11.083104     90059.0             1              1              0              0              0               2.405422                    0.0                    0.0                    0.0      0       40488  0.000123
15  132763      0  0.685177   1.984123     90059.0             1              1              0              0              0               0.685177                    0.0                    0.0                    0.0      0       40488  0.000123
16  132763      4  1.317212   3.733000     90059.0             1              1              0              0              0               1.317212                    0.0                    0.0                    0.0      0       40488  0.000049
19  132763     16  2.382397  10.830829     90059.0             1              1              0              0              0               2.382397                    0.0                    0.0                    0.0      0       40488  0.000123
20  132772      0  0.959576   2.610589     90059.0             1              1              0              0              0               0.959576                    0.0                    0.0                    0.0      0       40488  0.001778
21  132772      4  1.464425   4.325055     90059.0             1              1              0              0              0               1.464425                    0.0                    0.0                    0.0      0       40488  0.000272
22  132772      7  1.847489   6.343871     90059.0             1              1              0              0              0               1.847489                    0.0                    0.0                    0.0      0       40488  0.000025
23  132772      1  2.250480   9.492289     90059.0             1              1              0              0              0               2.250480                    0.0                    0.0                    0.0      0       40488  0.000049
24  132772      9  2.387146  10.882389     90059.0             1              1              0              0              0               2.387146                    0.0                    0.0                    0.0      0       40488  0.001210
25  132774      0  1.021268   2.776713     90059.0             1              1              0              0              0               1.021268                    0.0                    0.0                    0.0      0       40488  0.001161
26  132774      4  1.507882   4.517154     90059.0             1              1              0              0              0               1.507882                    0.0                    0.0                    0.0      0       40488  0.000247
27  132774      7  1.816779   6.152013     90059.0             1              1              0              0              0               1.816779                    0.0                    0.0                    0.0      0       40488  0.000049
29  132774      9  2.373282  10.732561     90059.0             1              1              0              0              0               2.373282                    0.0                    0.0                    0.0      0       40488  0.001037
30  132775      0  0.943832   2.569810     90059.0             1              1              0              0              0               0.943832                    0.0                    0.0                    0.0      0       40488  0.002346
31  132775      4  1.464439   4.325118     90059.0             1              1              0              0              0               1.464439                    0.0                    0.0                    0.0      0       40488  0.000370
32  132775      7  1.850678   6.364134     90059.0             1              1              0              0              0               1.850678                    0.0                    0.0                    0.0      0       40488  0.000123
33  132775      1  2.251602   9.502947     90059.0             1              1              0              0              0               2.251602                    0.0                    0.0                    0.0      0       40488  0.000049
34  132775      9  2.384357  10.852086     90059.0             1              1              0              0              0               2.384357                    0.0                    0.0                    0.0      0       40488  0.001581
35  132776      0  0.887535   2.429133     90059.0             1              1              0              0              0               0.887535                    0.0                    0.0                    0.0      0       40488  0.001260
36  132776      4  1.415862   4.120036     90059.0             1              1              0              0              0               1.415862                    0.0                    0.0                    0.0      0       40488  0.000395
37  132776      7  1.879925   6.553017     90059.0             1              1              0              0              0               1.879925                    0.0                    0.0                    0.0      0       40488  0.000074
38  132776      1  2.229868   9.298637     90059.0             1              1              0              0              0               2.229868                    0.0                    0.0                    0.0      0       40488  0.000049
39  132776      9  2.401359  11.038164     90059.0             1              1              0              0              0               2.401359                    0.0                    0.0                    0.0      0       40488  0.000988
40  132792      0  0.788905   2.200984     90059.0             1              1              0              0              0               0.788905                    0.0                    0.0                    0.0      0       40488  0.003804
41  132792      4  1.462907   4.318494     90059.0             1              1              0              0              0               1.462907                    0.0                    0.0                    0.0      0       40488  0.000617
42  132792      7  1.889494   6.616020     90059.0             1              1              0              0              0               1.889494                    0.0                    0.0                    0.0      0       40488  0.000173
43  132792      1  2.258765   9.571262     90059.0             1              1              0              0              0               2.258765                    0.0                    0.0                    0.0      0       40488  0.000074
44  132792      9  2.363775  10.631010     90059.0             1              1              0              0              0               2.363775                    0.0                    0.0                    0.0      0       40488  0.003063
45  132793      0  0.782841   2.187679     90059.0             1              1              0              0              0               0.782841                    0.0                    0.0                    0.0      0       40488  0.003186
46  132793      4  1.473780   4.365707     90059.0             1              1              0              0              0               1.473780                    0.0                    0.0                    0.0      0       40488  0.000593
47  132793      7  1.890205   6.620723     90059.0             1              1              0              0              0               1.890205                    0.0                    0.0                    0.0      0       40488  0.000049
48  132793      1  2.264449   9.625818     90059.0             1              1              0              0              0               2.264449                    0.0                    0.0                    0.0      0       40488  0.000049
49  132793      9  2.357149  10.560804     90059.0             1              1              0              0              0               2.357149                    0.0                    0.0                    0.0      0       40488  0.002544
50  132794      0  0.887200   2.428321     90059.0             1              1              0              0              0               0.887200                    0.0                    0.0                    0.0      0       40488  0.001260
51  132794      4  1.526687   4.602902     90059.0             1              1              0              0              0               1.526687                    0.0                    0.0                    0.0      0       40488  0.000247
52  132794      7  1.852737   6.377253     90059.0             1              1              0              0              0               1.852737                    0.0                    0.0                    0.0      0       40488  0.000049
53  132794      1  2.287930   9.854524     90059.0             1              1              0              0              0               2.287930                    0.0                    0.0                    0.0      0       40488  0.000025
54  132794      9  2.338092  10.361449     90059.0             1              1              0              0              0               2.338092                    0.0                    0.0                    0.0      0       40488  0.000741
55  132795      0  0.939920   2.559777     90059.0             1              1              0              0              0               0.939920                    0.0                    0.0                    0.0      0       40488  0.000420
56  132795      4  1.556965   4.744402     90059.0             1              1              0              0              0               1.556965                    0.0                    0.0                    0.0      0       40488  0.000025
59  132795      9  2.325947  10.236375     90059.0             1              1              0              0              0               2.325947                    0.0                    0.0                    0.0      0       40488  0.000173
60  132796      0  0.770565   2.160988     90059.0             1              1              0              0              0               0.770565                    0.0                    0.0                    0.0      0       40488  0.004051
pi_init:
[[ 3.89472274  0.69560121 -2.01893654  0.11516225]]
Weight distribution by market:
count    10.0
mean      1.0
std       0.0
min       1.0
25%       1.0
50%       1.0
75%       1.0
max       1.0
Name: weights, dtype: float64
Estimating demand...
agent_vars: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
iv_df:
             demand_instruments0  demand_instruments1  demand_instruments2  demand_instruments3
market_ids                                                                                    
90059.0                1.209555             0.000000                  0.0             0.000000
90201.0                1.303367             0.000000                  0.0             0.000000
90277.0                0.000000             0.000000                  0.0             1.928605
90290.0                0.000000             0.000000                  0.0             2.839756
90302.0                0.000000             1.620097                  0.0             0.000000
Initializing the problem ...
Initialized the problem after 00:00:00.

Dimensions:
===========================================
 T    N    F     I     K1    K2    D    MD 
---  ---  ---  -----  ----  ----  ---  ----
10   10    1   11538   7     1     4    10 
===========================================

Formulations:
==================================================================================================================================================
       Column Indices:                   0                      1                      2                      3                  4         5    6 
-----------------------------  ---------------------  ---------------------  ---------------------  ---------------------  -------------  ---  ---
 X1: Linear Characteristics              1                   prices              hpi_quantile1          hpi_quantile2      hpi_quantile3   X    Y 
X2: Nonlinear Characteristics            1                                                                                                        
       d: Demographics         logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4                         
==================================================================================================================================================
pi_init: [[ 3.89472274  0.69560121 -2.01893654  0.11516225]]
pi_lb: [[-inf -inf -inf -inf]]
pi_ub: [[inf inf inf inf]]
Solving with one core...
Solving the problem ...

Nonlinear Coefficient Initial Values:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +3.89E+00              +6.96E-01              -2.02E+00              +1.15E-01      
=====================================================================================================================

Nonlinear Coefficient Lower Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           -INF                   -INF                   -INF                   -INF         
=====================================================================================================================

Nonlinear Coefficient Upper Bounds:
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1           +INF                   +INF                   +INF                   +INF         
=====================================================================================================================

The model may be under-identified. The total number of unfixed parameters is 11, which is more than the total number of moments, 10. Consider checking whether instruments were properly specified when initializing the problem, and whether parameters were properly configured when solving the problem.
Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 1     00:00:00         0             1           142          142         0     +4.53E-03               +8.40E-02  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 1     00:00:00         1             2           138          138         0     +1.64E-03   +2.89E-03   +2.71E-02  +3.89E+00, +7.04E-01, -2.06E+00, +3.11E-02
 1     00:00:00         2             3           138          138         0     +1.31E-03   +3.25E-04   +3.13E-03  +3.89E+00, +7.00E-01, -2.05E+00, +5.15E-02
 1     00:00:00         3             4           138          138         0     +1.30E-03   +1.55E-05   +3.27E-03  +3.89E+00, +6.99E-01, -2.05E+00, +5.42E-02
 1     00:00:00         4             5           138          138         0     +1.27E-03   +2.75E-05   +2.01E-03  +3.89E+00, +6.95E-01, -2.07E+00, +6.00E-02
 1     00:00:00         5             6           138          138         0     +1.26E-03   +5.88E-06   +1.07E-03  +3.89E+00, +6.96E-01, -2.07E+00, +6.09E-02
 1     00:00:00         6             7           138          138         0     +1.26E-03   +3.43E-06   +9.48E-04  +3.89E+00, +6.97E-01, -2.08E+00, +6.15E-02
 1     00:00:00         7             8           138          138         0     +1.26E-03   +1.03E-06   +7.20E-04  +3.89E+00, +6.99E-01, -2.08E+00, +6.14E-02
 1     00:00:00         8             9           138          138         0     +1.26E-03   +2.04E-06   +8.69E-04  +3.89E+00, +7.03E-01, -2.08E+00, +6.20E-02
 1     00:00:00         9            10           137          137         0     +1.26E-03   +7.48E-07   +5.17E-04  +3.89E+00, +7.04E-01, -2.08E+00, +6.32E-02
 1     00:00:00         10           11           138          138         0     +1.26E-03   +1.13E-07   +1.23E-04  +3.89E+00, +7.04E-01, -2.08E+00, +6.35E-02
 1     00:00:00         11           12           137          137         0     +1.26E-03   +5.72E-08   +3.49E-05  +3.89E+00, +7.05E-01, -2.08E+00, +6.39E-02
 1     00:00:00         12           13           137          137         0     +1.26E-03   +4.21E-09   +7.88E-06  +3.89E+00, +7.05E-01, -2.08E+00, +6.39E-02
 1     00:00:00         13           14           138          138         0     +1.26E-03   +4.44E-10   +5.15E-06  +3.89E+00, +7.05E-01, -2.08E+00, +6.40E-02
 1     00:00:00         14           15           137          137         0     +1.26E-03   +2.09E-11   +5.15E-06  +3.89E+00, +7.05E-01, -2.08E+00, +6.40E-02
 1     00:00:00         15           16           138          138         0     +1.26E-03   +1.22E-08   +4.44E-05  +3.89E+00, +7.05E-01, -2.08E+00, +6.39E-02
 1     00:00:00         16           17           138          138         0     +1.26E-03   +7.59E-10   +1.69E-05  +3.89E+00, +7.05E-01, -2.08E+00, +6.39E-02
 1     00:00:00         17           18           137          137         0     +1.26E-03   +1.25E-10   +1.35E-06  +3.89E+00, +7.05E-01, -2.08E+00, +6.40E-02
 1     00:00:00         18           19           138          138         0     +1.26E-03   +9.29E-10   +1.60E-07  +3.89E+00, +7.05E-01, -2.08E+00, +6.40E-02
 1     00:00:00         19           20           137          137         0     +1.26E-03   +1.96E-12   +2.73E-10  +3.89E+00, +7.05E-01, -2.08E+00, +6.40E-02
 1     00:00:00         20           21           140          140         0     +1.26E-03   +3.61E-16   +2.07E-11  +3.89E+00, +7.05E-01, -2.08E+00, +6.40E-02

Optimization completed after 00:00:01.
Computing the Hessian and and updating the weighting matrix ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +4.22E+18. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
=====================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number
----  ---------  ---------  --------------  --------------  -------  ----------------
 1    +1.26E-03  +2.07E-11    +9.44E-04       +1.28E+00        0        +1.41E+05    
=====================================================================================

Starting optimization ...

GMM   Computation  Optimization   Objective   Fixed Point  Contraction  Clipped  Objective   Objective   Gradient                                             
Step     Time       Iterations   Evaluations  Iterations   Evaluations  Shares     Value    Improvement    Norm                       Theta                   
----  -----------  ------------  -----------  -----------  -----------  -------  ---------  -----------  ---------  ------------------------------------------
 2     00:00:00         0             1           45           45          0     +6.62E+00               +1.39E+02  +3.89E+00, +7.05E-01, -2.08E+00, +6.40E-02
 2     00:00:00         1             2           129          129         0     +2.57E+03               +4.14E+03  +3.89E+00, +6.08E-02, -1.71E+00, +7.32E-01
 2     00:00:00         2             3           98           98          0     +1.68E+00   +4.93E+00   +5.79E+01  +3.89E+00, +6.82E-01, -2.05E+00, +9.11E-02
 2     00:00:00         3             4           98           98          0     +7.20E-01   +9.62E-01   +3.71E+01  +3.89E+00, +6.89E-01, -2.04E+00, +9.80E-02
 2     00:00:00         4             5           94           94          0     +2.97E-04   +7.20E-01   +1.57E+00  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         5             6           94           94          0     +2.23E-07   +2.96E-04   +4.85E-02  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         6             7           94           94          0     +8.47E-09   +2.14E-07   +4.77E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         7             8           94           94          0     +6.54E-09   +1.93E-09   +3.49E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         8             9           94           94          0     +8.83E-09               +1.22E-02  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         9            10           94           94          0     +3.22E-08               +2.43E-02  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         10           11           94           94          0     +1.36E-07               +4.57E-02  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         11           12           98           98          0     +5.18E-07               +8.08E-02  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         12           13           96           96          0     +8.66E-08               +1.86E-02  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         13           14           94           94          0     +3.92E-08               +1.75E-02  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         14           15           94           94          0     +5.36E-08               +2.27E-02  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         15           16           94           94          0     +3.69E-08               +1.73E-02  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         16           17           94           94          0     +1.41E-08               +7.38E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         17           18           94           94          0     +8.45E-09               +5.14E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         18           19           94           94          0     +7.02E-09               +4.32E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         19           20           94           94          0     +6.66E-09               +3.91E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         20           21           94           94          0     +6.57E-09               +3.70E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         21           22           94           94          0     +6.55E-09               +3.60E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         22           23           94           94          0     +6.55E-09               +3.55E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         23           24           94           94          0     +6.54E-09               +3.52E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         24           25           94           94          0     +6.54E-09               +3.51E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01
 2     00:00:00         25           26           94           94          0     +6.54E-09               +3.50E-03  +3.89E+00, +6.96E-01, -2.02E+00, +1.15E-01

Optimization completed after 00:00:01.
Computing the Hessian and estimating standard errors ...
Detected that the estimated covariance matrix of aggregate GMM moments is nearly singular with condition number +3.27E+20. To disable singularity checks, set options.singular_tol = numpy.inf.
Computed results after 00:00:00.

Problem Results Summary:
========================================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix  Covariance Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number  Condition Number 
----  ---------  ---------  --------------  --------------  -------  ----------------  -----------------
 2    +6.54E-09  +3.49E-03    -1.38E+02       +7.80E+03        0        +4.92E+29          +4.66E+20    
========================================================================================================

Cumulative Statistics:
===========================================================================
Computation  Optimizer  Optimization   Objective   Fixed Point  Contraction
   Time      Converged   Iterations   Evaluations  Iterations   Evaluations
-----------  ---------  ------------  -----------  -----------  -----------
 00:00:02       Yes          47           49          5576         5576    
===========================================================================

Nonlinear Coefficient Estimates (Robust SEs in Parentheses):
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +3.89E+00              +6.96E-01              -2.02E+00              +1.15E-01      
                   |            (+6.33E-02)            (+4.37E-02)            (+2.42E-02)            (+4.39E-02)     
=====================================================================================================================

Beta Estimates (Robust SEs in Parentheses):
===============================================================================================
     1         prices     hpi_quantile1  hpi_quantile2  hpi_quantile3       X            Y     
-----------  -----------  -------------  -------------  -------------  -----------  -----------
 +2.79E+00    -7.47E-12     -4.78E+00      -2.11E+00      +4.33E+00     -5.73E+00    -1.65E+00 
(+1.42E-01)  (+1.10E-15)   (+9.90E-02)    (+1.62E-01)    (+1.46E-01)   (+2.84E-02)  (+7.35E-02)
===============================================================================================
Computing delta ...
Finished after 00:00:00.

Mean delta: 1.0922023863953503
pi labels: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4']
ii=0, vv=logdistXhpi_quantile1
logdistXhpi_quantile1 is a distance term, omitting from ABD and adding to coefficients instead
ii=1, vv=logdistXhpi_quantile2
logdistXhpi_quantile2 is a distance term, omitting from ABD and adding to coefficients instead
ii=2, vv=logdistXhpi_quantile3
logdistXhpi_quantile3 is a distance term, omitting from ABD and adding to coefficients instead
ii=3, vv=logdistXhpi_quantile4
logdistXhpi_quantile4 is a distance term, omitting from ABD and adding to coefficients instead

Distance coefficients: [3.88911, 0.69574, -2.01686, 0.11511]

Computed abepsilon in: 0.011 seconds.
Assigning individuals...
time3 - time2: 0.317
time4 - time3: 2.17
Number of full locations: 15  out of  18
Offers:
% Rank 0 offers: 46.99534
% Rank 1 offers: 8.63936
% Rank 2 offers: 4.28266
% Rank 3 offers: 2.83691
% Rank 4 offers: 37.24574
% Offered any: 100.0
Mean offer distance: 1.58261
Quantiles of offered distances:
0.0 quantile: -2.65569
0.1 quantile: 0.33247
0.2 quantile: 0.74121
0.3 quantile: 1.05948
0.4 quantile: 1.34995
0.5 quantile: 1.71364
0.6 quantile: 2.11120
0.7 quantile: 2.23185
0.8 quantile: 2.37213
0.9 quantile: 2.60348
1.0 quantile: 3.19221
Assignments:
% Rank 0 assignments: 29.88989
% Rank 1 assignments: 7.31279
% Rank 2 assignments: 3.83400
% Rank 3 assignments: 2.62189
% Rank 4 assignments: 32.53043
% Assigned: 76.18900
Mean assignment distance: 1.75474
Quantiles of assignment distances:
0.0 quantile: -2.05992
0.1 quantile: 0.66645
0.2 quantile: 1.01085
0.3 quantile: 1.27719
0.4 quantile: 1.60071
0.5 quantile: 2.03502
0.6 quantile: 2.16285
0.7 quantile: 2.26218
0.8 quantile: 2.39368
0.9 quantile: 2.60348
1.0 quantile: 3.19221
Violations:
Max violation: 32183
Number of locations with violations: 15
Number of individuals with violations: 138283
Mean violation (conditional on violation): 9218.866666666667
Median violation (conditional on violation): 6923.0
Number of markets with wasserstein distance > 0.001: 0
Mean wasserstein distance: 0.00019347226470490343
Max wasserstein distance: 0.0005904369523601869
Index of max wasserstein distance: 9
Iteration 13 complete.


Problem Results Summary:
========================================================================================================
GMM   Objective  Gradient       Hessian         Hessian     Clipped  Weighting Matrix  Covariance Matrix
Step    Value      Norm     Min Eigenvalue  Max Eigenvalue  Shares   Condition Number  Condition Number 
----  ---------  ---------  --------------  --------------  -------  ----------------  -----------------
 2    +6.54E-09  +3.49E-03    -1.38E+02       +7.80E+03        0        +4.92E+29          +4.66E+20    
========================================================================================================

Cumulative Statistics:
===========================================================================
Computation  Optimizer  Optimization   Objective   Fixed Point  Contraction
   Time      Converged   Iterations   Evaluations  Iterations   Evaluations
-----------  ---------  ------------  -----------  -----------  -----------
 00:00:02       Yes          47           49          5576         5576    
===========================================================================

Nonlinear Coefficient Estimates (Robust SEs in Parentheses):
=====================================================================================================================
Sigma:      1      |  Pi:  logdistXhpi_quantile1  logdistXhpi_quantile2  logdistXhpi_quantile3  logdistXhpi_quantile4
------  ---------  |  ---  ---------------------  ---------------------  ---------------------  ---------------------
  1     +0.00E+00  |   1         +3.89E+00              +6.96E-01              -2.02E+00              +1.15E-01      
                   |            (+6.33E-02)            (+4.37E-02)            (+2.42E-02)            (+4.39E-02)     
=====================================================================================================================

Beta Estimates (Robust SEs in Parentheses):
===============================================================================================
     1         prices     hpi_quantile1  hpi_quantile2  hpi_quantile3       X            Y     
-----------  -----------  -------------  -------------  -------------  -----------  -----------
 +2.79E+00    -7.47E-12     -4.78E+00      -2.11E+00      +4.33E+00     -5.73E+00    -1.65E+00 
(+1.42E-01)  (+1.10E-15)   (+9.90E-02)    (+1.62E-01)    (+1.46E-01)   (+2.84E-02)  (+7.35E-02)
===============================================================================================
Table variables: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4', '1', 'hpi_quantile1', 'hpi_quantile2', 'hpi_quantile3', 'X', 'Y']
Saved table at: /mnt/phd/jihu/Demo/Result/Demand/coeftables/coeftable_10000_5_4q_mnl.tex
Saved (agent_)results to /mnt/phd/jihu/Demo/Result/Demand/(agent_)results_10000_5_4q_mnl.pkl
Done with fixed point loop at time: 80.67 seconds
Saved agent_results to /mnt/phd/jihu/Demo/Result/Demand/agent_results_10000_5_4q_mnl.csv
Saved results to /mnt/phd/jihu/Demo/Result/Demand/results_10000_5_4q_mnl.pkl
Table variables: ['logdistXhpi_quantile1', 'logdistXhpi_quantile2', 'logdistXhpi_quantile3', 'logdistXhpi_quantile4', '1', 'hpi_quantile1', 'hpi_quantile2', 'hpi_quantile3', 'X', 'Y']
Saved table at: /mnt/phd/jihu/Demo/Result/Demand/coeftables/coeftable_10000_5_4q_mnl.tex
Done!
Total time in minutes: 1.3560094197591146
